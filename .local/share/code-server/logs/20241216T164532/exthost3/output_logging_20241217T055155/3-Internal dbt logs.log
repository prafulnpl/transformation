12:22:25.445078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73868716dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73868716dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738686d7cf90>]}


============================== 12:22:25.449281 | 08769b43-8619-46b5-9097-290e7763ddb1 ==============================
12:22:25.449281 [info ] [MainThread]: Running with dbt=1.9.1
12:22:25.450197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/jovyan/Internal', 'log_path': '/home/jovyan/Internal/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
12:22:25.460003 [info ] [MainThread]: dbt version: 1.9.1
12:22:25.460627 [info ] [MainThread]: python version: 3.11.6
12:22:25.461152 [info ] [MainThread]: python path: /opt/conda/bin/python3.11
12:22:25.461664 [info ] [MainThread]: os info: Linux-6.8.0-1017-azure-x86_64-with-glibc2.35
12:22:25.526110 [info ] [MainThread]: Using profiles dir at /home/jovyan/Internal
12:22:25.526865 [info ] [MainThread]: Using profiles.yml file at /home/jovyan/Internal/profiles.yml
12:22:25.527390 [info ] [MainThread]: Using dbt_project.yml file at /home/jovyan/Internal/dbt_project.yml
12:22:25.645052 [info ] [MainThread]: Configuration:
12:22:25.645831 [info ] [MainThread]:   profiles.yml file [ERROR invalid]
12:22:25.646343 [info ] [MainThread]:   dbt_project.yml file [OK found and valid]
12:22:25.646849 [info ] [MainThread]: Required dependencies:
12:22:25.647318 [debug] [MainThread]: Executing "git --help"
12:22:25.650322 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
12:22:25.650976 [debug] [MainThread]: STDERR: "b''"
12:22:25.651389 [info ] [MainThread]:  - git [OK found]

12:22:25.651949 [info ] [MainThread]: Connection test skipped since no profile was found
12:22:25.652453 [info ] [MainThread]: 1 check failed:
12:22:25.653040 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "Internal", target "dev" invalid: ['database name'] is not of type 'string'


12:22:25.654412 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.27274922, "process_in_blocks": "0", "process_kernel_time": 0.255182, "process_mem_max_rss": "94064", "process_out_blocks": "24", "process_user_time": 1.685599}
12:22:25.655283 [debug] [MainThread]: Command `dbt debug` failed at 12:22:25.655133 after 0.27 seconds
12:22:25.655967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738686e81110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738686da3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73868aba97d0>]}
12:22:25.656583 [debug] [MainThread]: Flushing usage events
12:22:25.808731 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:22:50.326077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7add4baebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7add4b92f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7add4bdfc0d0>]}


============================== 12:22:50.330134 | 95f71a77-07ad-4d35-a751-5d93298dca67 ==============================
12:22:50.330134 [info ] [MainThread]: Running with dbt=1.9.1
12:22:50.331040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/jovyan/Internal/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
12:22:50.340674 [info ] [MainThread]: dbt version: 1.9.1
12:22:50.341335 [info ] [MainThread]: python version: 3.11.6
12:22:50.341824 [info ] [MainThread]: python path: /opt/conda/bin/python3.11
12:22:50.342240 [info ] [MainThread]: os info: Linux-6.8.0-1017-azure-x86_64-with-glibc2.35
12:22:50.346116 [info ] [MainThread]: Using profiles dir at /home/jovyan/Internal
12:22:50.346645 [info ] [MainThread]: Using profiles.yml file at /home/jovyan/Internal/profiles.yml
12:22:50.347078 [info ] [MainThread]: Using dbt_project.yml file at /home/jovyan/Internal/dbt_project.yml
12:22:50.467607 [info ] [MainThread]: Configuration:
12:22:50.468309 [info ] [MainThread]:   profiles.yml file [ERROR invalid]
12:22:50.468774 [info ] [MainThread]:   dbt_project.yml file [OK found and valid]
12:22:50.469172 [info ] [MainThread]: Required dependencies:
12:22:50.469606 [debug] [MainThread]: Executing "git --help"
12:22:50.472466 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
12:22:50.473017 [debug] [MainThread]: STDERR: "b''"
12:22:50.473412 [info ] [MainThread]:  - git [OK found]

12:22:50.473861 [info ] [MainThread]: Connection test skipped since no profile was found
12:22:50.474395 [info ] [MainThread]: 1 check failed:
12:22:50.474860 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'Internal'


12:22:50.476103 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.21022832, "process_in_blocks": "0", "process_kernel_time": 0.228252, "process_mem_max_rss": "92128", "process_out_blocks": "8", "process_user_time": 1.636637}
12:22:50.476892 [debug] [MainThread]: Command `dbt debug` failed at 12:22:50.476708 after 0.21 seconds
12:22:50.477441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7add4f91e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7add4f91d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7add4f91e350>]}
12:22:50.478029 [debug] [MainThread]: Flushing usage events
12:22:50.514420 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:23:17.645912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b466eeecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b467b4dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b466eeeb10>]}


============================== 12:23:17.649892 | ed702a95-6568-4d5f-8908-c0d8d3a4ea1d ==============================
12:23:17.649892 [info ] [MainThread]: Running with dbt=1.9.1
12:23:17.650665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/jovyan/Internal/logs', 'profiles_dir': '/home/jovyan/Internal', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
12:23:17.659781 [info ] [MainThread]: dbt version: 1.9.1
12:23:17.660359 [info ] [MainThread]: python version: 3.11.6
12:23:17.660839 [info ] [MainThread]: python path: /opt/conda/bin/python3.11
12:23:17.661247 [info ] [MainThread]: os info: Linux-6.8.0-1017-azure-x86_64-with-glibc2.35
12:23:17.727938 [info ] [MainThread]: Using profiles dir at /home/jovyan/Internal
12:23:17.728641 [info ] [MainThread]: Using profiles.yml file at /home/jovyan/Internal/profiles.yml
12:23:17.729098 [info ] [MainThread]: Using dbt_project.yml file at /home/jovyan/Internal/dbt_project.yml
12:23:17.729495 [info ] [MainThread]: adapter type: trino
12:23:17.729905 [info ] [MainThread]: adapter version: 1.8.5
12:23:17.837723 [info ] [MainThread]: Configuration:
12:23:17.838408 [info ] [MainThread]:   profiles.yml file [OK found and valid]
12:23:17.838918 [info ] [MainThread]:   dbt_project.yml file [OK found and valid]
12:23:17.839314 [info ] [MainThread]: Required dependencies:
12:23:17.839777 [debug] [MainThread]: Executing "git --help"
12:23:17.842410 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
12:23:17.843015 [debug] [MainThread]: STDERR: "b''"
12:23:17.843489 [info ] [MainThread]:  - git [OK found]

12:23:17.843967 [info ] [MainThread]: Connection:
12:23:17.844389 [info ] [MainThread]:   host: 10.2.0.4
12:23:17.844797 [info ] [MainThread]:   port: 32750
12:23:17.845170 [info ] [MainThread]:   user: admin
12:23:17.845537 [info ] [MainThread]:   database: ICEBERG
12:23:17.845945 [info ] [MainThread]:   schema: default_silver
12:23:17.846318 [info ] [MainThread]:   cert: None
12:23:17.846714 [info ] [MainThread]:   prepared_statements_enabled: True
12:23:17.847285 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:23:17.921481 [debug] [MainThread]: Acquiring new trino connection 'debug'
12:23:17.960032 [debug] [MainThread]: Using trino connection "debug"
12:23:17.960688 [debug] [MainThread]: On debug: select 1 as id
12:23:17.961153 [debug] [MainThread]: Opening a new connection, currently in state init
12:23:17.961677 [warn ] [MainThread]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:23:17.962473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'ed702a95-6568-4d5f-8908-c0d8d3a4ea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b466bac790>]}
12:23:17.998137 [debug] [MainThread]: SQL status: SUCCESS in 0.037 seconds
12:23:18.000122 [debug] [MainThread]: On debug: Close
12:23:18.001101 [info ] [MainThread]:   Connection test: [OK connection ok]

12:23:18.001858 [info ] [MainThread]: All checks passed!
12:23:18.003563 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41621798, "process_in_blocks": "0", "process_kernel_time": 0.247636, "process_mem_max_rss": "99444", "process_out_blocks": "24", "process_user_time": 1.741441}
12:23:18.004586 [debug] [MainThread]: Command `dbt debug` succeeded at 12:23:18.004409 after 0.42 seconds
12:23:18.005299 [debug] [MainThread]: Connection 'debug' was properly closed.
12:23:18.006048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b466c9b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b46ace2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b467b38f90>]}
12:23:18.006876 [debug] [MainThread]: Flushing usage events
12:23:18.162347 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:23:47.516173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f446b7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f444ed1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f444ee250>]}


============================== 12:23:47.520107 | 58b25cc5-4617-49ae-be7e-9f659af19560 ==============================
12:23:47.520107 [info ] [MainThread]: Running with dbt=1.9.1
12:23:47.520919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/jovyan/Internal/logs', 'fail_fast': 'False', 'profiles_dir': '/home/jovyan/Internal', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s college_leads', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
12:23:47.710889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58b25cc5-4617-49ae-be7e-9f659af19560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f44312f10>]}
12:23:47.778606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58b25cc5-4617-49ae-be7e-9f659af19560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f46b71110>]}
12:23:47.779694 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:23:47.861357 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:23:47.862336 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
12:23:47.862966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '58b25cc5-4617-49ae-be7e-9f659af19560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f444eee90>]}
12:23:49.165831 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Internal.college_leads' (models/example/college_leads.sql) depends on a source named 'default.airbyte_raw_shift' which was not found
12:23:49.167436 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7100024, "process_in_blocks": "0", "process_kernel_time": 0.315238, "process_mem_max_rss": "103524", "process_out_blocks": "16", "process_user_time": 3.061604}
12:23:49.168342 [debug] [MainThread]: Command `dbt run` failed at 12:23:49.168195 after 1.71 seconds
12:23:49.169072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f4453ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f4450bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f484ed950>]}
12:23:49.169796 [debug] [MainThread]: Flushing usage events
12:23:49.258946 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:24:40.229189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a56473090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a56472ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a564a6cd0>]}


============================== 12:24:40.233291 | b5453dbe-d26d-40c9-bf9c-3229673ac67c ==============================
12:24:40.233291 [info ] [MainThread]: Running with dbt=1.9.1
12:24:40.234159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/jovyan/Internal', 'log_path': '/home/jovyan/Internal/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s college_leads', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
12:24:40.425523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5453dbe-d26d-40c9-bf9c-3229673ac67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a564a6d90>]}
12:24:40.494864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5453dbe-d26d-40c9-bf9c-3229673ac67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a5892ced0>]}
12:24:40.496031 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:24:40.577936 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:24:40.579035 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
12:24:40.579731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5453dbe-d26d-40c9-bf9c-3229673ac67c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a560474d0>]}
12:24:41.906947 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Internal.college_leads' (models/example/college_leads.sql) depends on a source named 'default.airbyte_raw_studentclass' which was not found
12:24:41.908475 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7386373, "process_in_blocks": "0", "process_kernel_time": 0.276683, "process_mem_max_rss": "103236", "process_out_blocks": "16", "process_user_time": 3.067493}
12:24:41.909299 [debug] [MainThread]: Command `dbt run` failed at 12:24:41.909161 after 1.74 seconds
12:24:41.909895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a562d5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a55dd2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4a562d4250>]}
12:24:41.910470 [debug] [MainThread]: Flushing usage events
12:24:41.998674 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:29:46.473514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780e73574d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780e7357250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780e7357150>]}


============================== 12:29:46.478029 | 310e626d-0a67-4aae-b549-354b1c30d57e ==============================
12:29:46.478029 [info ] [MainThread]: Running with dbt=1.9.1
12:29:46.479002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/jovyan/Internal/logs', 'debug': 'False', 'profiles_dir': '/home/jovyan/Internal', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s college_leads', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
12:29:46.713608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '310e626d-0a67-4aae-b549-354b1c30d57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780e71b5f50>]}
12:29:46.808703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '310e626d-0a67-4aae-b549-354b1c30d57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780e9810f50>]}
12:29:46.809842 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:29:46.895078 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:29:46.896053 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
12:29:46.896666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '310e626d-0a67-4aae-b549-354b1c30d57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780e704e290>]}
12:29:48.526285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '310e626d-0a67-4aae-b549-354b1c30d57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780e6be2b10>]}
12:29:48.627874 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:29:48.631945 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:29:48.643308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '310e626d-0a67-4aae-b549-354b1c30d57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780e891d490>]}
12:29:48.644158 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:29:48.644757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '310e626d-0a67-4aae-b549-354b1c30d57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780e6718450>]}
12:29:48.646780 [info ] [MainThread]: 
12:29:48.647306 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:29:48.647780 [info ] [MainThread]: 
12:29:48.648527 [debug] [MainThread]: Acquiring new trino connection 'master'
12:29:48.649903 [debug] [ThreadPool]: Acquiring new trino connection 'list_ICEBERG'
12:29:48.700534 [debug] [ThreadPool]: Using trino connection "list_ICEBERG"
12:29:48.701324 [debug] [ThreadPool]: On list_ICEBERG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_ICEBERG"} */

    select schema_name
    from "ICEBERG".INFORMATION_SCHEMA.schemata
12:29:48.701831 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:29:48.702240 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:29:48.703052 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '310e626d-0a67-4aae-b549-354b1c30d57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780e6e75110>]}
12:29:48.838574 [debug] [ThreadPool]: SQL status: SUCCESS in 0.137 seconds
12:29:48.840564 [debug] [ThreadPool]: On list_ICEBERG: Close
12:29:48.841930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ICEBERG, now create_ICEBERG_default_silver_default_silver)
12:29:48.842656 [debug] [ThreadPool]: Creating schema "database: "ICEBERG"
schema: "default_silver_default_silver"
"
12:29:48.848859 [debug] [ThreadPool]: Using trino connection "create_ICEBERG_default_silver_default_silver"
12:29:48.849364 [debug] [ThreadPool]: On create_ICEBERG_default_silver_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "create_ICEBERG_default_silver_default_silver"} */
create schema if not exists "ICEBERG"."default_silver_default_silver"
12:29:48.849835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:29:49.048885 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.199 seconds
12:29:49.051086 [debug] [ThreadPool]: On create_ICEBERG_default_silver_default_silver: COMMIT
12:29:49.051949 [debug] [ThreadPool]: On create_ICEBERG_default_silver_default_silver: Close
12:29:49.059143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ICEBERG_default_silver_default_silver, now list_ICEBERG_default_silver_default_silver)
12:29:49.076987 [debug] [ThreadPool]: Using trino connection "list_ICEBERG_default_silver_default_silver"
12:29:49.077675 [debug] [ThreadPool]: On list_ICEBERG_default_silver_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_ICEBERG_default_silver_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "ICEBERG".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver_default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver_default_silver'
12:29:49.078200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:29:49.350851 [debug] [ThreadPool]: SQL status: SUCCESS in 0.273 seconds
12:29:49.352865 [debug] [ThreadPool]: On list_ICEBERG_default_silver_default_silver: ROLLBACK
12:29:49.353420 [debug] [ThreadPool]: On list_ICEBERG_default_silver_default_silver: Close
12:29:49.354401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ICEBERG_default_silver_default_silver, now list_ICEBERG_default_silver)
12:29:49.359867 [debug] [ThreadPool]: Using trino connection "list_ICEBERG_default_silver"
12:29:49.360365 [debug] [ThreadPool]: On list_ICEBERG_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_ICEBERG_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "ICEBERG".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:29:49.360863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:29:49.482445 [debug] [ThreadPool]: SQL status: SUCCESS in 0.121 seconds
12:29:49.484331 [debug] [ThreadPool]: On list_ICEBERG_default_silver: ROLLBACK
12:29:49.484928 [debug] [ThreadPool]: On list_ICEBERG_default_silver: Close
12:29:49.486220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '310e626d-0a67-4aae-b549-354b1c30d57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780e947d950>]}
12:29:49.487027 [debug] [MainThread]: On master: COMMIT
12:29:49.489416 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:29:49.490279 [info ] [Thread-1 (]: 1 of 1 START sql table model default_silver_default_silver.college_leads ....... [RUN]
12:29:49.490956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ICEBERG_default_silver, now model.Internal.college_leads)
12:29:49.491442 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:29:49.495855 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:29:49.496752 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:29:49.547014 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:29:49.561643 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:29:49.562957 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  
    

    create table "ICEBERG"."default_silver_default_silver"."college_leads"
      
      
    as (
      -- Creates a physical table in the Silver schema


WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(ss.sectionname, 'N/A') AS sectionname,
        COALESCE(sh.SHIFTNAME, 'N/A') AS SHIFTNAME,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    LEFT JOIN 
        default.airbyte_raw_studentsection ss 
        ON s.sectionid = ss.sectionid 
    LEFT JOIN 
        default.airbyte_raw_shift sh 
        ON sh.shiftid = s.shiftid
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.classid = s.CLASSID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
)

SELECT 
    studentid, 
    fullname, 
    sectionname, 
    SHIFTNAME, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
    rn = 1
    )
12:29:49.564045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:29:49.606690 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_122949_00040_d8x8s
12:29:49.607736 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoQueryError(type=INTERNAL_ERROR, name=GENERIC_INTERNAL_ERROR, message="catalogName is not lowercase: ICEBERG", query_id=20241217_122949_00040_d8x8s)
12:29:49.608873 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:29:49.609556 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:29:49.614906 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoQueryError(type=INTERNAL_ERROR, name=GENERIC_INTERNAL_ERROR, message="catalogName is not lowercase: ICEBERG", query_id=20241217_122949_00040_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:29:49.617508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '310e626d-0a67-4aae-b549-354b1c30d57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780e5fb3510>]}
12:29:49.618518 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model default_silver_default_silver.college_leads  [ERROR in 0.12s]
12:29:49.619356 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:29:49.620206 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoQueryError(type=INTERNAL_ERROR, name=GENERIC_INTERNAL_ERROR, message="catalogName is not lowercase: ICEBERG", query_id=20241217_122949_00040_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:29:49.622857 [debug] [MainThread]: On master: COMMIT
12:29:49.623703 [debug] [MainThread]: Connection 'master' was properly closed.
12:29:49.624269 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:29:49.624831 [info ] [MainThread]: 
12:29:49.625363 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.98 seconds (0.98s).
12:29:49.626287 [debug] [MainThread]: Command end result
12:29:49.662691 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:29:49.667251 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:29:49.674221 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:29:49.674836 [info ] [MainThread]: 
12:29:49.675512 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:29:49.676085 [info ] [MainThread]: 
12:29:49.676689 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoQueryError(type=INTERNAL_ERROR, name=GENERIC_INTERNAL_ERROR, message="catalogName is not lowercase: ICEBERG", query_id=20241217_122949_00040_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:29:49.677177 [info ] [MainThread]: 
12:29:49.677742 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:29:49.679058 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.270958, "process_in_blocks": "0", "process_kernel_time": 0.329907, "process_mem_max_rss": "110180", "process_out_blocks": "3048", "process_user_time": 3.924902}
12:29:49.679835 [debug] [MainThread]: Command `dbt run` failed at 12:29:49.679695 after 3.27 seconds
12:29:49.680445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780e73575d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780e718f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7780eb18e450>]}
12:29:49.681088 [debug] [MainThread]: Flushing usage events
12:29:49.744135 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:30:56.984516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd13269e010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd13229f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd13229ef90>]}


============================== 12:30:56.988404 | 2506a07c-1d8c-4222-8cc7-90f7e0e8ac92 ==============================
12:30:56.988404 [info ] [MainThread]: Running with dbt=1.9.1
12:30:56.989245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/jovyan/Internal/logs', 'version_check': 'True', 'profiles_dir': '/home/jovyan/Internal', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s college_leads', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
12:30:57.185089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2506a07c-1d8c-4222-8cc7-90f7e0e8ac92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd132f7f250>]}
12:30:57.258754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2506a07c-1d8c-4222-8cc7-90f7e0e8ac92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd134755290>]}
12:30:57.259903 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:30:57.348942 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:30:57.467705 [info ] [MainThread]: Unable to do partial parsing because profile has changed
12:30:57.468522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2506a07c-1d8c-4222-8cc7-90f7e0e8ac92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd132996010>]}
12:30:58.933047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2506a07c-1d8c-4222-8cc7-90f7e0e8ac92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd1320a7510>]}
12:30:59.030396 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:30:59.034707 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:30:59.045975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2506a07c-1d8c-4222-8cc7-90f7e0e8ac92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd132f2ddd0>]}
12:30:59.046851 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:30:59.047413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2506a07c-1d8c-4222-8cc7-90f7e0e8ac92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd13207e650>]}
12:30:59.049522 [info ] [MainThread]: 
12:30:59.050083 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:30:59.050496 [info ] [MainThread]: 
12:30:59.051303 [debug] [MainThread]: Acquiring new trino connection 'master'
12:30:59.052751 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:30:59.104233 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:30:59.104977 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:30:59.105547 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:30:59.106032 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:30:59.106767 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '2506a07c-1d8c-4222-8cc7-90f7e0e8ac92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd131f403d0>]}
12:30:59.152838 [debug] [ThreadPool]: SQL status: SUCCESS in 0.047 seconds
12:30:59.154803 [debug] [ThreadPool]: On list_iceberg: Close
12:30:59.161549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
12:30:59.183243 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:30:59.184146 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:30:59.184851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:30:59.292032 [debug] [ThreadPool]: SQL status: SUCCESS in 0.107 seconds
12:30:59.294054 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:30:59.294658 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:30:59.295670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now list_iceberg_default_silver_default_silver)
12:30:59.301383 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver_default_silver"
12:30:59.302023 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver_default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver_default_silver'
12:30:59.302543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:30:59.409122 [debug] [ThreadPool]: SQL status: SUCCESS in 0.106 seconds
12:30:59.412056 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: ROLLBACK
12:30:59.412941 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: Close
12:30:59.414500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2506a07c-1d8c-4222-8cc7-90f7e0e8ac92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd131c7fe50>]}
12:30:59.415348 [debug] [MainThread]: On master: COMMIT
12:30:59.417799 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:30:59.418699 [info ] [Thread-1 (]: 1 of 1 START sql table model default_silver_default_silver.college_leads ....... [RUN]
12:30:59.419485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver_default_silver, now model.Internal.college_leads)
12:30:59.420173 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:30:59.425165 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:30:59.426276 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:30:59.485789 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:30:59.499243 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:30:59.500207 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  
    

    create table "iceberg"."default_silver_default_silver"."college_leads"
      
      
    as (
      -- Creates a physical table in the Silver schema


WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(ss.sectionname, 'N/A') AS sectionname,
        COALESCE(sh.SHIFTNAME, 'N/A') AS SHIFTNAME,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    LEFT JOIN 
        default.airbyte_raw_studentsection ss 
        ON s.sectionid = ss.sectionid 
    LEFT JOIN 
        default.airbyte_raw_shift sh 
        ON sh.shiftid = s.shiftid
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.classid = s.CLASSID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
)

SELECT 
    studentid, 
    fullname, 
    sectionname, 
    SHIFTNAME, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
    rn = 1
    )
12:30:59.501001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:30:59.742535 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_123059_00044_d8x8s
12:30:59.743407 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 46:9: Table 'iceberg.default.airbyte_raw_studentsection' does not exist", query_id=20241217_123059_00044_d8x8s)
12:30:59.744269 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:30:59.744812 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:30:59.750352 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 46:9: Table 'iceberg.default.airbyte_raw_studentsection' does not exist", query_id=20241217_123059_00044_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:30:59.752876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2506a07c-1d8c-4222-8cc7-90f7e0e8ac92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd131787b90>]}
12:30:59.753875 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model default_silver_default_silver.college_leads  [ERROR in 0.33s]
12:30:59.754721 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:30:59.755535 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 46:9: Table 'iceberg.default.airbyte_raw_studentsection' does not exist", query_id=20241217_123059_00044_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:30:59.758144 [debug] [MainThread]: On master: COMMIT
12:30:59.758901 [debug] [MainThread]: Connection 'master' was properly closed.
12:30:59.759353 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:30:59.759986 [info ] [MainThread]: 
12:30:59.760556 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.71 seconds (0.71s).
12:30:59.761555 [debug] [MainThread]: Command end result
12:30:59.790875 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:30:59.793331 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:30:59.800504 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:30:59.801061 [info ] [MainThread]: 
12:30:59.801762 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:30:59.802340 [info ] [MainThread]: 
12:30:59.802983 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 46:9: Table 'iceberg.default.airbyte_raw_studentsection' does not exist", query_id=20241217_123059_00044_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:30:59.803528 [info ] [MainThread]: 
12:30:59.804080 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:30:59.805343 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.879648, "process_in_blocks": "0", "process_kernel_time": 0.284576, "process_mem_max_rss": "111008", "process_out_blocks": "3048", "process_user_time": 3.803338}
12:30:59.806073 [debug] [MainThread]: Command `dbt run` failed at 12:30:59.805944 after 2.88 seconds
12:30:59.806657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd1360de610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd1360de710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd131d99590>]}
12:30:59.807261 [debug] [MainThread]: Flushing usage events
12:30:59.904910 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:32:17.603629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7854debb4c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7854ddcdb010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7854ddcdae10>]}


============================== 12:32:17.607571 | d38365b8-e792-4cd5-a0ee-4f62a6b6f949 ==============================
12:32:17.607571 [info ] [MainThread]: Running with dbt=1.9.1
12:32:17.608347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/jovyan/Internal/logs', 'profiles_dir': '/home/jovyan/Internal', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s college_leads', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
12:32:17.801408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd38365b8-e792-4cd5-a0ee-4f62a6b6f949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7854dd936cd0>]}
12:32:17.869738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd38365b8-e792-4cd5-a0ee-4f62a6b6f949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7854e0195110>]}
12:32:17.870903 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:32:17.956364 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:32:18.086720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:32:18.087775 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
12:32:18.396780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd38365b8-e792-4cd5-a0ee-4f62a6b6f949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7854dd996850>]}
12:32:18.501784 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:32:18.505903 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:32:18.516861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd38365b8-e792-4cd5-a0ee-4f62a6b6f949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7854df278350>]}
12:32:18.517948 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:32:18.518727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd38365b8-e792-4cd5-a0ee-4f62a6b6f949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7854ddaa2090>]}
12:32:18.521378 [info ] [MainThread]: 
12:32:18.521917 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:32:18.522408 [info ] [MainThread]: 
12:32:18.523248 [debug] [MainThread]: Acquiring new trino connection 'master'
12:32:18.524570 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:32:18.573944 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:32:18.574657 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:32:18.575131 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:32:18.575522 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:32:18.576177 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'd38365b8-e792-4cd5-a0ee-4f62a6b6f949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7854dd4d4110>]}
12:32:18.616849 [debug] [ThreadPool]: SQL status: SUCCESS in 0.042 seconds
12:32:18.618887 [debug] [ThreadPool]: On list_iceberg: Close
12:32:18.625746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
12:32:18.644107 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:32:18.645011 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:32:18.645488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:32:18.732804 [debug] [ThreadPool]: SQL status: SUCCESS in 0.087 seconds
12:32:18.734843 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:32:18.735366 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:32:18.736281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now list_iceberg_default_silver_default_silver)
12:32:18.742097 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver_default_silver"
12:32:18.742691 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver_default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver_default_silver'
12:32:18.743166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:32:18.847700 [debug] [ThreadPool]: SQL status: SUCCESS in 0.104 seconds
12:32:18.849558 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: ROLLBACK
12:32:18.850165 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: Close
12:32:18.851370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd38365b8-e792-4cd5-a0ee-4f62a6b6f949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7854dd7351d0>]}
12:32:18.852183 [debug] [MainThread]: On master: COMMIT
12:32:18.854714 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:32:18.855683 [info ] [Thread-1 (]: 1 of 1 START sql table model default_silver_default_silver.college_leads ....... [RUN]
12:32:18.856446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver_default_silver, now model.Internal.college_leads)
12:32:18.857052 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:32:18.863083 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:32:18.864305 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:32:18.924503 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:32:18.937129 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:32:18.938188 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  
    

    create table "iceberg"."default_silver_default_silver"."college_leads"
      
      
    as (
      -- Creates a physical table in the Silver schema


WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(ss.sectionname, 'N/A') AS sectionname,
        COALESCE(sh.SHIFTNAME, 'N/A') AS SHIFTNAME,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    LEFT JOIN 
        default.airbyte_raw_section ss 
        ON s.sectionid = ss.sectionid 
    LEFT JOIN 
        default.airbyte_raw_shift sh 
        ON sh.shiftid = s.shiftid
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.classid = s.CLASSID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
)

SELECT 
    studentid, 
    fullname, 
    sectionname, 
    SHIFTNAME, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
    rn = 1
    )
12:32:18.939188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:32:19.002153 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_123218_00048_d8x8s
12:32:19.003281 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 46:9: Table 'iceberg.default.airbyte_raw_section' does not exist", query_id=20241217_123218_00048_d8x8s)
12:32:19.004654 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:32:19.005196 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:32:19.010410 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 46:9: Table 'iceberg.default.airbyte_raw_section' does not exist", query_id=20241217_123218_00048_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:32:19.012841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd38365b8-e792-4cd5-a0ee-4f62a6b6f949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7854dc9a2550>]}
12:32:19.013823 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model default_silver_default_silver.college_leads  [ERROR in 0.15s]
12:32:19.014625 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:32:19.015664 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 46:9: Table 'iceberg.default.airbyte_raw_section' does not exist", query_id=20241217_123218_00048_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:32:19.018903 [debug] [MainThread]: On master: COMMIT
12:32:19.019833 [debug] [MainThread]: Connection 'master' was properly closed.
12:32:19.020498 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:32:19.021222 [info ] [MainThread]: 
12:32:19.022056 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.50 seconds (0.50s).
12:32:19.023338 [debug] [MainThread]: Command end result
12:32:19.065112 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:32:19.067611 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:32:19.074843 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:32:19.075385 [info ] [MainThread]: 
12:32:19.075980 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:32:19.076440 [info ] [MainThread]: 
12:32:19.077025 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 46:9: Table 'iceberg.default.airbyte_raw_section' does not exist", query_id=20241217_123218_00048_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:32:19.077458 [info ] [MainThread]: 
12:32:19.077942 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:32:19.079173 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5357383, "process_in_blocks": "0", "process_kernel_time": 0.349926, "process_mem_max_rss": "109508", "process_out_blocks": "3056", "process_user_time": 2.537212}
12:32:19.079919 [debug] [MainThread]: Command `dbt run` failed at 12:32:19.079787 after 1.54 seconds
12:32:19.080532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7854de0d5410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7854dc9bb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7854e1b11a90>]}
12:32:19.081248 [debug] [MainThread]: Flushing usage events
12:32:19.170183 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:33:29.486900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dabb3326ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dabb380f090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dabb3326a10>]}


============================== 12:33:29.490797 | ecbdcdaf-be22-403c-88fd-81abf5cbf119 ==============================
12:33:29.490797 [info ] [MainThread]: Running with dbt=1.9.1
12:33:29.491519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/jovyan/Internal', 'log_path': '/home/jovyan/Internal/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s college_leads', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
12:33:29.682727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecbdcdaf-be22-403c-88fd-81abf5cbf119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dabb3365250>]}
12:33:29.750354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecbdcdaf-be22-403c-88fd-81abf5cbf119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dabb5770e50>]}
12:33:29.751531 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:33:29.832222 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:33:29.962129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:33:29.963199 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
12:33:30.275455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecbdcdaf-be22-403c-88fd-81abf5cbf119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dabb2bf7210>]}
12:33:30.377509 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:33:30.381774 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:33:30.393590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecbdcdaf-be22-403c-88fd-81abf5cbf119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dabb2d70150>]}
12:33:30.394418 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:33:30.395017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecbdcdaf-be22-403c-88fd-81abf5cbf119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dabb2d5b690>]}
12:33:30.397127 [info ] [MainThread]: 
12:33:30.397685 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:33:30.398141 [info ] [MainThread]: 
12:33:30.399034 [debug] [MainThread]: Acquiring new trino connection 'master'
12:33:30.400803 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:33:30.454162 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:33:30.454967 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:33:30.455499 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:33:30.456056 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:33:30.456814 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'ecbdcdaf-be22-403c-88fd-81abf5cbf119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dabb2f33ed0>]}
12:33:30.501932 [debug] [ThreadPool]: SQL status: SUCCESS in 0.046 seconds
12:33:30.503890 [debug] [ThreadPool]: On list_iceberg: Close
12:33:30.510672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
12:33:30.530783 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:33:30.531676 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:33:30.532212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:33:30.616738 [debug] [ThreadPool]: SQL status: SUCCESS in 0.084 seconds
12:33:30.619631 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:33:30.620426 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:33:30.621755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now list_iceberg_default_silver_default_silver)
12:33:30.631005 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver_default_silver"
12:33:30.631965 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver_default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver_default_silver'
12:33:30.632774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:33:30.718781 [debug] [ThreadPool]: SQL status: SUCCESS in 0.086 seconds
12:33:30.720544 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: ROLLBACK
12:33:30.721096 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: Close
12:33:30.722322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecbdcdaf-be22-403c-88fd-81abf5cbf119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dabb2efa5d0>]}
12:33:30.723077 [debug] [MainThread]: On master: COMMIT
12:33:30.725216 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:33:30.726075 [info ] [Thread-1 (]: 1 of 1 START sql table model default_silver_default_silver.college_leads ....... [RUN]
12:33:30.726792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver_default_silver, now model.Internal.college_leads)
12:33:30.727358 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:33:30.732152 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:33:30.733028 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:33:30.788324 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:33:30.800125 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:33:30.801019 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  
    

    create table "iceberg"."default_silver_default_silver"."college_leads"
      
      
    as (
      -- Creates a physical table in the Silver schema


WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sh.SHIFTNAME, 'N/A') AS SHIFTNAME,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    
    LEFT JOIN 
        default.airbyte_raw_shift sh 
        ON sh.shiftid = s.shiftid
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.classid = s.CLASSID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
)

SELECT 
    studentid, 
    fullname, 
    SHIFTNAME, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
    rn = 1
    )
12:33:30.801913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:33:30.861065 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_123330_00052_d8x8s
12:33:30.861897 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 46:9: Table 'iceberg.default.airbyte_raw_shift' does not exist", query_id=20241217_123330_00052_d8x8s)
12:33:30.862830 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:33:30.863419 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:33:30.868912 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 46:9: Table 'iceberg.default.airbyte_raw_shift' does not exist", query_id=20241217_123330_00052_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:33:30.871634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecbdcdaf-be22-403c-88fd-81abf5cbf119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dabb2fd3890>]}
12:33:30.872681 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model default_silver_default_silver.college_leads  [ERROR in 0.14s]
12:33:30.873525 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:33:30.874437 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 46:9: Table 'iceberg.default.airbyte_raw_shift' does not exist", query_id=20241217_123330_00052_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:33:30.877101 [debug] [MainThread]: On master: COMMIT
12:33:30.877844 [debug] [MainThread]: Connection 'master' was properly closed.
12:33:30.878298 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:33:30.878850 [info ] [MainThread]: 
12:33:30.879338 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.48 seconds (0.48s).
12:33:30.880254 [debug] [MainThread]: Command end result
12:33:30.914056 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:33:30.917404 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:33:30.928553 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:33:30.929483 [info ] [MainThread]: 
12:33:30.930406 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:33:30.931138 [info ] [MainThread]: 
12:33:30.931974 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 46:9: Table 'iceberg.default.airbyte_raw_shift' does not exist", query_id=20241217_123330_00052_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:33:30.932710 [info ] [MainThread]: 
12:33:30.933434 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:33:30.935236 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5089707, "process_in_blocks": "0", "process_kernel_time": 0.31554, "process_mem_max_rss": "109344", "process_out_blocks": "3048", "process_user_time": 2.607202}
12:33:30.936294 [debug] [MainThread]: Command `dbt run` failed at 12:33:30.936102 after 1.51 seconds
12:33:30.937185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dabb33afe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dabb3379250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dabb402aed0>]}
12:33:30.938087 [debug] [MainThread]: Flushing usage events
12:33:31.034724 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:33:57.729335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746dcc06b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746dccff150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746dccff750>]}


============================== 12:33:57.733239 | 08b47a0a-eb70-4389-a1e8-323b80affdd0 ==============================
12:33:57.733239 [info ] [MainThread]: Running with dbt=1.9.1
12:33:57.733990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/jovyan/Internal/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s college_leads', 'send_anonymous_usage_stats': 'True'}
12:33:57.926431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08b47a0a-eb70-4389-a1e8-323b80affdd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746dc9887d0>]}
12:33:57.996654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08b47a0a-eb70-4389-a1e8-323b80affdd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746df0a8b50>]}
12:33:57.997820 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:33:58.080488 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:33:58.212734 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:33:58.213783 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
12:33:58.536772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08b47a0a-eb70-4389-a1e8-323b80affdd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746dc851d90>]}
12:33:58.630118 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:33:58.634167 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:33:58.645260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08b47a0a-eb70-4389-a1e8-323b80affdd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746dc181d90>]}
12:33:58.646085 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:33:58.646610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08b47a0a-eb70-4389-a1e8-323b80affdd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746dc7c6f90>]}
12:33:58.648576 [info ] [MainThread]: 
12:33:58.649102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:33:58.649509 [info ] [MainThread]: 
12:33:58.650220 [debug] [MainThread]: Acquiring new trino connection 'master'
12:33:58.651493 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:33:58.699535 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:33:58.700243 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:33:58.700736 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:33:58.701149 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:33:58.701776 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '08b47a0a-eb70-4389-a1e8-323b80affdd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746dbd18bd0>]}
12:33:58.730070 [debug] [ThreadPool]: SQL status: SUCCESS in 0.029 seconds
12:33:58.731926 [debug] [ThreadPool]: On list_iceberg: Close
12:33:58.738561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
12:33:58.758520 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:33:58.759462 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:33:58.760061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:33:58.836354 [debug] [ThreadPool]: SQL status: SUCCESS in 0.076 seconds
12:33:58.838244 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:33:58.838818 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:33:58.839752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now list_iceberg_default_silver_default_silver)
12:33:58.845417 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver_default_silver"
12:33:58.845936 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver_default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver_default_silver'
12:33:58.846386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:33:58.923917 [debug] [ThreadPool]: SQL status: SUCCESS in 0.077 seconds
12:33:58.926175 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: ROLLBACK
12:33:58.926746 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: Close
12:33:58.927950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08b47a0a-eb70-4389-a1e8-323b80affdd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746dca11fd0>]}
12:33:58.928731 [debug] [MainThread]: On master: COMMIT
12:33:58.930968 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:33:58.931758 [info ] [Thread-1 (]: 1 of 1 START sql table model default_silver_default_silver.college_leads ....... [RUN]
12:33:58.932400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver_default_silver, now model.Internal.college_leads)
12:33:58.933004 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:33:58.937413 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:33:58.938335 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:33:58.991089 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:33:59.003643 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:33:59.004573 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  
    

    create table "iceberg"."default_silver_default_silver"."college_leads"
      
      
    as (
      -- Creates a physical table in the Silver schema


WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.classid = s.CLASSID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
)

SELECT 
    studentid, 
    fullname, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
    rn = 1
    )
12:33:59.005328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:33:59.065760 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_123359_00056_d8x8s
12:33:59.066865 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 46:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123359_00056_d8x8s)
12:33:59.068164 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:33:59.069004 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:33:59.075743 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 46:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123359_00056_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:33:59.078149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08b47a0a-eb70-4389-a1e8-323b80affdd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746dc18ea10>]}
12:33:59.079134 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model default_silver_default_silver.college_leads  [ERROR in 0.14s]
12:33:59.079973 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:33:59.080851 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 46:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123359_00056_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:33:59.084006 [debug] [MainThread]: On master: COMMIT
12:33:59.084896 [debug] [MainThread]: Connection 'master' was properly closed.
12:33:59.085403 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:33:59.085910 [info ] [MainThread]: 
12:33:59.086393 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
12:33:59.087297 [debug] [MainThread]: Command end result
12:33:59.114990 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:33:59.117395 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:33:59.125066 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:33:59.125577 [info ] [MainThread]: 
12:33:59.126167 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:33:59.126646 [info ] [MainThread]: 
12:33:59.127168 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 46:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123359_00056_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:33:59.127593 [info ] [MainThread]: 
12:33:59.128071 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:33:59.129466 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4592285, "process_in_blocks": "0", "process_kernel_time": 0.344474, "process_mem_max_rss": "109892", "process_out_blocks": "3040", "process_user_time": 2.56309}
12:33:59.130277 [debug] [MainThread]: Command `dbt run` failed at 12:33:59.130137 after 1.46 seconds
12:33:59.131021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746dca66e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746dcff99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7746e0a31950>]}
12:33:59.131576 [debug] [MainThread]: Flushing usage events
12:33:59.170951 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:36:02.750179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d06bce950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d06bd1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d06bd3ed0>]}


============================== 12:36:02.754385 | 542a9885-7687-4428-9ed4-770824e36ab9 ==============================
12:36:02.754385 [info ] [MainThread]: Running with dbt=1.9.1
12:36:02.755192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/jovyan/Internal/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s college_leads', 'send_anonymous_usage_stats': 'True'}
12:36:02.949760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '542a9885-7687-4428-9ed4-770824e36ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d06fcd790>]}
12:36:03.026592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '542a9885-7687-4428-9ed4-770824e36ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d09090850>]}
12:36:03.027725 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:36:03.115931 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:36:03.256222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:36:03.257281 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
12:36:03.602901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '542a9885-7687-4428-9ed4-770824e36ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d066cda50>]}
12:36:03.707914 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:36:03.712263 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:36:03.724244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '542a9885-7687-4428-9ed4-770824e36ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d0661fa50>]}
12:36:03.725129 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:36:03.725705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '542a9885-7687-4428-9ed4-770824e36ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d0648f150>]}
12:36:03.727784 [info ] [MainThread]: 
12:36:03.728322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:36:03.728770 [info ] [MainThread]: 
12:36:03.729592 [debug] [MainThread]: Acquiring new trino connection 'master'
12:36:03.730979 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:36:03.786925 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:36:03.787640 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:36:03.788156 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:36:03.788552 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:36:03.789268 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '542a9885-7687-4428-9ed4-770824e36ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d06189890>]}
12:36:03.830121 [debug] [ThreadPool]: SQL status: SUCCESS in 0.042 seconds
12:36:03.832143 [debug] [ThreadPool]: On list_iceberg: Close
12:36:03.840248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver_default_silver)
12:36:03.860923 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver_default_silver"
12:36:03.862015 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver_default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver_default_silver'
12:36:03.862494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:36:03.943296 [debug] [ThreadPool]: SQL status: SUCCESS in 0.081 seconds
12:36:03.945733 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: ROLLBACK
12:36:03.946325 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: Close
12:36:03.947364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_default_silver_default_silver, now list_iceberg_default_silver)
12:36:03.953957 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:36:03.954744 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:36:03.955276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:36:04.045022 [debug] [ThreadPool]: SQL status: SUCCESS in 0.090 seconds
12:36:04.046843 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:36:04.047397 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:36:04.048900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '542a9885-7687-4428-9ed4-770824e36ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d06153110>]}
12:36:04.049769 [debug] [MainThread]: On master: COMMIT
12:36:04.052231 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:36:04.053166 [info ] [Thread-1 (]: 1 of 1 START sql table model default_silver_default_silver.college_leads ....... [RUN]
12:36:04.053849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
12:36:04.054386 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:36:04.059365 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:36:04.060300 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:36:04.117086 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:36:04.128675 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:36:04.129549 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  
    

    create table "iceberg"."default_silver_default_silver"."college_leads"
      
      
    as (
      -- Creates a physical table in the Silver schema


WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.CLASSID = s.CLASSID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
)

SELECT 
    studentid, 
    fullname, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
    rn = 1
    )
12:36:04.130278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:36:04.201716 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_123604_00060_d8x8s
12:36:04.202520 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 46:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123604_00060_d8x8s)
12:36:04.203411 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:36:04.203998 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:36:04.209957 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 46:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123604_00060_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:36:04.212642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '542a9885-7687-4428-9ed4-770824e36ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d051135d0>]}
12:36:04.213691 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model default_silver_default_silver.college_leads  [ERROR in 0.16s]
12:36:04.214524 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:36:04.215394 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 46:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123604_00060_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:36:04.218111 [debug] [MainThread]: On master: COMMIT
12:36:04.218795 [debug] [MainThread]: Connection 'master' was properly closed.
12:36:04.219218 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:36:04.219702 [info ] [MainThread]: 
12:36:04.220188 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
12:36:04.221099 [debug] [MainThread]: Command end result
12:36:04.248905 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:36:04.251295 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:36:04.258090 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:36:04.258594 [info ] [MainThread]: 
12:36:04.259183 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:36:04.259656 [info ] [MainThread]: 
12:36:04.260206 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 46:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123604_00060_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:36:04.260679 [info ] [MainThread]: 
12:36:04.261138 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:36:04.262341 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5730435, "process_in_blocks": "0", "process_kernel_time": 0.312338, "process_mem_max_rss": "109592", "process_out_blocks": "3048", "process_user_time": 2.693299}
12:36:04.263072 [debug] [MainThread]: Command `dbt run` failed at 12:36:04.262943 after 1.57 seconds
12:36:04.263657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d06a52790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d06a52610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d071569d0>]}
12:36:04.264193 [debug] [MainThread]: Flushing usage events
12:36:04.324369 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:36:19.530841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b998897410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b999576dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b998897350>]}


============================== 12:36:19.534766 | f28ffff6-1f4c-4d1a-9ef4-86375f5ee37a ==============================
12:36:19.534766 [info ] [MainThread]: Running with dbt=1.9.1
12:36:19.535509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jovyan/Internal/logs', 'version_check': 'True', 'profiles_dir': '/home/jovyan/Internal', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s college_leads', 'send_anonymous_usage_stats': 'True'}
12:36:19.737374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f28ffff6-1f4c-4d1a-9ef4-86375f5ee37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b998624390>]}
12:36:19.805919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f28ffff6-1f4c-4d1a-9ef4-86375f5ee37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b99ad2cf10>]}
12:36:19.807036 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:36:19.900548 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:36:20.028772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:36:20.029461 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:36:20.081806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f28ffff6-1f4c-4d1a-9ef4-86375f5ee37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9981f7050>]}
12:36:20.195128 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:36:20.199098 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:36:20.210440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f28ffff6-1f4c-4d1a-9ef4-86375f5ee37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9981eb210>]}
12:36:20.211308 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:36:20.211899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f28ffff6-1f4c-4d1a-9ef4-86375f5ee37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9999d76d0>]}
12:36:20.214049 [info ] [MainThread]: 
12:36:20.214832 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:36:20.215344 [info ] [MainThread]: 
12:36:20.216169 [debug] [MainThread]: Acquiring new trino connection 'master'
12:36:20.217647 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:36:20.267950 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:36:20.268662 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:36:20.269124 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:36:20.269512 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:36:20.270206 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'f28ffff6-1f4c-4d1a-9ef4-86375f5ee37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b99869fc50>]}
12:36:20.303604 [debug] [ThreadPool]: SQL status: SUCCESS in 0.034 seconds
12:36:20.305695 [debug] [ThreadPool]: On list_iceberg: Close
12:36:20.313041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
12:36:20.330814 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:36:20.331524 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:36:20.332066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:36:20.409318 [debug] [ThreadPool]: SQL status: SUCCESS in 0.077 seconds
12:36:20.411307 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:36:20.411855 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:36:20.412783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now list_iceberg_default_silver_default_silver)
12:36:20.418468 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver_default_silver"
12:36:20.418995 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver_default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver_default_silver'
12:36:20.419429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:36:20.512710 [debug] [ThreadPool]: SQL status: SUCCESS in 0.093 seconds
12:36:20.514686 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: ROLLBACK
12:36:20.515262 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: Close
12:36:20.516483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f28ffff6-1f4c-4d1a-9ef4-86375f5ee37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9984e6590>]}
12:36:20.517678 [debug] [MainThread]: On master: COMMIT
12:36:20.520654 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:36:20.521574 [info ] [Thread-1 (]: 1 of 1 START sql table model default_silver_default_silver.college_leads ....... [RUN]
12:36:20.522490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver_default_silver, now model.Internal.college_leads)
12:36:20.523085 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:36:20.528078 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:36:20.529075 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:36:20.586239 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:36:20.597899 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:36:20.598954 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  
    

    create table "iceberg"."default_silver_default_silver"."college_leads"
      
      
    as (
      -- Creates a physical table in the Silver schema


WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.CLASSID = s.CLASSID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
)

SELECT 
    studentid, 
    fullname, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
    rn = 1
    )
12:36:20.599797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:36:20.656700 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_123620_00064_d8x8s
12:36:20.657771 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 46:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123620_00064_d8x8s)
12:36:20.658976 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:36:20.659759 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:36:20.666302 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 46:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123620_00064_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:36:20.668898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f28ffff6-1f4c-4d1a-9ef4-86375f5ee37a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b99754ce10>]}
12:36:20.669979 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model default_silver_default_silver.college_leads  [ERROR in 0.14s]
12:36:20.670807 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:36:20.671815 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 46:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123620_00064_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:36:20.674727 [debug] [MainThread]: On master: COMMIT
12:36:20.675415 [debug] [MainThread]: Connection 'master' was properly closed.
12:36:20.675984 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:36:20.676448 [info ] [MainThread]: 
12:36:20.677033 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.46 seconds (0.46s).
12:36:20.678132 [debug] [MainThread]: Command end result
12:36:20.704450 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:36:20.706789 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:36:20.713722 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:36:20.714253 [info ] [MainThread]: 
12:36:20.714905 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:36:20.715459 [info ] [MainThread]: 
12:36:20.716075 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 46:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123620_00064_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:36:20.716593 [info ] [MainThread]: 
12:36:20.717144 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:36:20.718384 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2466854, "process_in_blocks": "0", "process_kernel_time": 0.306961, "process_mem_max_rss": "106032", "process_out_blocks": "2088", "process_user_time": 2.375703}
12:36:20.719089 [debug] [MainThread]: Command `dbt run` failed at 12:36:20.718960 after 1.25 seconds
12:36:20.719666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b9988ca950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b99c6ba650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b99c6ba5d0>]}
12:36:20.720188 [debug] [MainThread]: Flushing usage events
12:36:20.769723 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:37:29.870427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f9f486b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f9f486810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f9f486590>]}


============================== 12:37:29.874449 | 8c2b3fe0-2f4c-4527-afab-751da4514275 ==============================
12:37:29.874449 [info ] [MainThread]: Running with dbt=1.9.1
12:37:29.875295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/jovyan/Internal/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
12:37:30.000711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c2b3fe0-2f4c-4527-afab-751da4514275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f9f36b710>]}
12:37:30.013383 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2038511, "process_in_blocks": "0", "process_kernel_time": 0.212408, "process_mem_max_rss": "92224", "process_out_blocks": "16", "process_user_time": 1.600546}
12:37:30.014169 [debug] [MainThread]: Command `dbt clean` succeeded at 12:37:30.014033 after 0.20 seconds
12:37:30.014721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f9f484cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8fa338d7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8fa29eaf10>]}
12:37:30.015287 [debug] [MainThread]: Flushing usage events
12:37:30.103372 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:37:34.570448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d2af726e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d2af726a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d2af726b90>]}


============================== 12:37:34.574546 | aaa35bcd-e489-4adc-8fde-40d34d16c115 ==============================
12:37:34.574546 [info ] [MainThread]: Running with dbt=1.9.1
12:37:34.575408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/jovyan/Internal/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s college_leads', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
12:37:34.770184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaa35bcd-e489-4adc-8fde-40d34d16c115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d2af5a2210>]}
12:37:34.840312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aaa35bcd-e489-4adc-8fde-40d34d16c115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d2b1becf10>]}
12:37:34.841649 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:37:34.926989 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:37:34.927941 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
12:37:34.928522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aaa35bcd-e489-4adc-8fde-40d34d16c115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d2af4ec450>]}
12:37:36.461659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aaa35bcd-e489-4adc-8fde-40d34d16c115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d2aefa7dd0>]}
12:37:36.564163 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:37:36.568239 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:37:36.579392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aaa35bcd-e489-4adc-8fde-40d34d16c115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d2aefe4390>]}
12:37:36.580288 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:37:36.580896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaa35bcd-e489-4adc-8fde-40d34d16c115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d2aef2c590>]}
12:37:36.583079 [info ] [MainThread]: 
12:37:36.583635 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:37:36.584099 [info ] [MainThread]: 
12:37:36.584838 [debug] [MainThread]: Acquiring new trino connection 'master'
12:37:36.586341 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:37:36.640006 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:37:36.640702 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:37:36.641198 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:37:36.641586 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:37:36.642252 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'aaa35bcd-e489-4adc-8fde-40d34d16c115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d2af3eb610>]}
12:37:36.680108 [debug] [ThreadPool]: SQL status: SUCCESS in 0.039 seconds
12:37:36.682016 [debug] [ThreadPool]: On list_iceberg: Close
12:37:36.688528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver_default_silver)
12:37:36.706313 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver_default_silver"
12:37:36.707004 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver_default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver_default_silver'
12:37:36.707477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:37:36.844988 [debug] [ThreadPool]: SQL status: SUCCESS in 0.137 seconds
12:37:36.846896 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: ROLLBACK
12:37:36.847438 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: Close
12:37:36.848544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_default_silver_default_silver, now list_iceberg_default_silver)
12:37:36.854087 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:37:36.854600 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:37:36.855133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:37:36.930148 [debug] [ThreadPool]: SQL status: SUCCESS in 0.075 seconds
12:37:36.932860 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:37:36.933667 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:37:36.935109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaa35bcd-e489-4adc-8fde-40d34d16c115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d2ae3cb4d0>]}
12:37:36.935838 [debug] [MainThread]: On master: COMMIT
12:37:36.938170 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:37:36.939066 [info ] [Thread-1 (]: 1 of 1 START sql table model default_silver_default_silver.college_leads ....... [RUN]
12:37:36.939780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
12:37:36.940334 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:37:36.944593 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:37:36.945603 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:37:36.998720 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:37:37.010884 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:37:37.011862 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  
    

    create table "iceberg"."default_silver_default_silver"."college_leads"
      
      
    as (
      -- Creates a physical table in the Silver schema


WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.CLASSID = s.CLASSID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
)

SELECT 
    studentid, 
    fullname, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
    rn = 1
    )
12:37:37.012699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:37:37.079936 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_123737_00068_d8x8s
12:37:37.080771 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 46:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123737_00068_d8x8s)
12:37:37.081659 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:37:37.082221 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:37:37.088313 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 46:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123737_00068_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:37:37.090974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaa35bcd-e489-4adc-8fde-40d34d16c115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d2ae3db190>]}
12:37:37.091988 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model default_silver_default_silver.college_leads  [ERROR in 0.15s]
12:37:37.092848 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:37:37.093718 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 46:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123737_00068_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:37:37.096250 [debug] [MainThread]: On master: COMMIT
12:37:37.097019 [debug] [MainThread]: Connection 'master' was properly closed.
12:37:37.097431 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:37:37.098015 [info ] [MainThread]: 
12:37:37.098567 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.51 seconds (0.51s).
12:37:37.099575 [debug] [MainThread]: Command end result
12:37:37.132040 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:37:37.136754 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:37:37.144138 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:37:37.144794 [info ] [MainThread]: 
12:37:37.145352 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:37:37.145855 [info ] [MainThread]: 
12:37:37.146368 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 46:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123737_00068_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:37:37.146820 [info ] [MainThread]: 
12:37:37.147289 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:37:37.148564 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6391566, "process_in_blocks": "0", "process_kernel_time": 0.329676, "process_mem_max_rss": "110736", "process_out_blocks": "3032", "process_user_time": 3.682382}
12:37:37.149283 [debug] [MainThread]: Command `dbt run` failed at 12:37:37.149157 after 2.64 seconds
12:37:37.149850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d2af5b2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d2af5b2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d2b356a5d0>]}
12:37:37.150438 [debug] [MainThread]: Flushing usage events
12:37:37.185570 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:39:24.257154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd5f3e16990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd5f3e58910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd5f3e67d90>]}


============================== 12:39:24.261403 | 9d2c7ba6-045d-4948-ab35-7499109b4846 ==============================
12:39:24.261403 [info ] [MainThread]: Running with dbt=1.9.1
12:39:24.262247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/jovyan/Internal/logs', 'profiles_dir': '/home/jovyan/Internal', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s college_leads', 'send_anonymous_usage_stats': 'True'}
12:39:24.459897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d2c7ba6-045d-4948-ab35-7499109b4846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd5f3ba4890>]}
12:39:24.529160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d2c7ba6-045d-4948-ab35-7499109b4846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd5f62f50d0>]}
12:39:24.530238 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:39:24.614072 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:39:24.743547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:39:24.744558 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
12:39:25.064998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d2c7ba6-045d-4948-ab35-7499109b4846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd5f36a7990>]}
12:39:25.163223 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:39:25.167272 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:39:25.178282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d2c7ba6-045d-4948-ab35-7499109b4846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd5f38b0ed0>]}
12:39:25.179120 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:39:25.179719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d2c7ba6-045d-4948-ab35-7499109b4846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd5f36a4e50>]}
12:39:25.181772 [info ] [MainThread]: 
12:39:25.182284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:39:25.182717 [info ] [MainThread]: 
12:39:25.183405 [debug] [MainThread]: Acquiring new trino connection 'master'
12:39:25.184816 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:39:25.235969 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:39:25.236683 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:39:25.237143 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:39:25.237527 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:39:25.238166 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '9d2c7ba6-045d-4948-ab35-7499109b4846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd5f3e1aed0>]}
12:39:25.276461 [debug] [ThreadPool]: SQL status: SUCCESS in 0.039 seconds
12:39:25.278758 [debug] [ThreadPool]: On list_iceberg: Close
12:39:25.285455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver_default_silver)
12:39:25.303888 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver_default_silver"
12:39:25.304743 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver_default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver_default_silver'
12:39:25.305248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:39:25.379160 [debug] [ThreadPool]: SQL status: SUCCESS in 0.074 seconds
12:39:25.381154 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: ROLLBACK
12:39:25.381793 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: Close
12:39:25.382931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_default_silver_default_silver, now list_iceberg_default_silver)
12:39:25.389050 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:39:25.389665 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:39:25.390152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:39:25.474524 [debug] [ThreadPool]: SQL status: SUCCESS in 0.084 seconds
12:39:25.476724 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:39:25.477236 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:39:25.478365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d2c7ba6-045d-4948-ab35-7499109b4846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd5f3719090>]}
12:39:25.479230 [debug] [MainThread]: On master: COMMIT
12:39:25.481718 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:39:25.482570 [info ] [Thread-1 (]: 1 of 1 START sql table model default_silver_default_silver.college_leads ....... [RUN]
12:39:25.483313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
12:39:25.483910 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:39:25.488994 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:39:25.489975 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:39:25.545357 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:39:25.556815 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:39:25.557846 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  
    

    create table "iceberg"."default_silver_default_silver"."college_leads"
      
      
    as (
      -- Creates a physical table in the Silver schema


WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.CLASSID = s.CLASSID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
)

SELECT 
    studentid, 
    fullname, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
    rn = 1
    )
12:39:25.558712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:39:25.616821 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_123925_00072_d8x8s
12:39:25.617687 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 45:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123925_00072_d8x8s)
12:39:25.618633 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:39:25.619218 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:39:25.624697 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 45:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123925_00072_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:39:25.627315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d2c7ba6-045d-4948-ab35-7499109b4846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd5f3ab00d0>]}
12:39:25.628350 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model default_silver_default_silver.college_leads  [ERROR in 0.14s]
12:39:25.629184 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:39:25.630015 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 45:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123925_00072_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:39:25.632507 [debug] [MainThread]: On master: COMMIT
12:39:25.633234 [debug] [MainThread]: Connection 'master' was properly closed.
12:39:25.633675 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:39:25.634148 [info ] [MainThread]: 
12:39:25.634660 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
12:39:25.635713 [debug] [MainThread]: Command end result
12:39:25.665401 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:39:25.667899 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:39:25.675229 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:39:25.675813 [info ] [MainThread]: 
12:39:25.676529 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:39:25.677061 [info ] [MainThread]: 
12:39:25.677644 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 45:12: Column 'sc.classid' cannot be resolved", query_id=20241217_123925_00072_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:39:25.678094 [info ] [MainThread]: 
12:39:25.678577 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:39:25.679877 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4862335, "process_in_blocks": "0", "process_kernel_time": 0.310445, "process_mem_max_rss": "109452", "process_out_blocks": "3048", "process_user_time": 2.597358}
12:39:25.680590 [debug] [MainThread]: Command `dbt run` failed at 12:39:25.680460 after 1.49 seconds
12:39:25.681237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd5f3e65150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd5f7de1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd5f62e85d0>]}
12:39:25.681795 [debug] [MainThread]: Flushing usage events
12:39:25.766185 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:41:46.646864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2b05ff450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2b05ffe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2b05ff150>]}


============================== 12:41:46.651210 | 4dcfd154-a7fd-4492-a8b2-898b37daf7d7 ==============================
12:41:46.651210 [info ] [MainThread]: Running with dbt=1.9.1
12:41:46.652125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/jovyan/Internal/logs', 'profiles_dir': '/home/jovyan/Internal', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s college_leads', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
12:41:46.859504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dcfd154-a7fd-4492-a8b2-898b37daf7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2b03c6190>]}
12:41:46.932653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dcfd154-a7fd-4492-a8b2-898b37daf7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2b2a49050>]}
12:41:46.933790 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:41:47.020668 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:41:47.161050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:41:47.162150 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
12:41:47.509606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dcfd154-a7fd-4492-a8b2-898b37daf7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2b0441ed0>]}
12:41:47.611262 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:41:47.615736 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:41:47.627599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dcfd154-a7fd-4492-a8b2-898b37daf7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2b0244490>]}
12:41:47.628495 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:41:47.629137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dcfd154-a7fd-4492-a8b2-898b37daf7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2afeff7d0>]}
12:41:47.631307 [info ] [MainThread]: 
12:41:47.631953 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:41:47.632393 [info ] [MainThread]: 
12:41:47.633287 [debug] [MainThread]: Acquiring new trino connection 'master'
12:41:47.634681 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:41:47.682792 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:41:47.683435 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:41:47.683912 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:41:47.684292 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:41:47.684925 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '4dcfd154-a7fd-4492-a8b2-898b37daf7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2afb39e10>]}
12:41:47.727924 [debug] [ThreadPool]: SQL status: SUCCESS in 0.044 seconds
12:41:47.729880 [debug] [ThreadPool]: On list_iceberg: Close
12:41:47.736807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver_default_silver)
12:41:47.756284 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver_default_silver"
12:41:47.757205 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver_default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver_default_silver'
12:41:47.757795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:41:47.840416 [debug] [ThreadPool]: SQL status: SUCCESS in 0.083 seconds
12:41:47.842428 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: ROLLBACK
12:41:47.843035 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: Close
12:41:47.844032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_default_silver_default_silver, now list_iceberg_default_silver)
12:41:47.850032 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:41:47.850656 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:41:47.851196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:41:47.931446 [debug] [ThreadPool]: SQL status: SUCCESS in 0.080 seconds
12:41:47.933344 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:41:47.933906 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:41:47.935038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dcfd154-a7fd-4492-a8b2-898b37daf7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2b0099290>]}
12:41:47.935923 [debug] [MainThread]: On master: COMMIT
12:41:47.938313 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:41:47.939126 [info ] [Thread-1 (]: 1 of 1 START sql table model default_silver_default_silver.college_leads ....... [RUN]
12:41:47.939810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
12:41:47.940341 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:41:47.944939 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:41:47.945774 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:41:47.996904 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:41:48.008201 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:41:48.009088 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  
    

    create table "iceberg"."default_silver_default_silver"."college_leads"
      
      
    as (
      -- Creates a physical table in the Silver schema


WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        -- COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    -- LEFT JOIN 
    --     default.airbyte_raw_studentclass sc 
    --     ON sc.CLASSID = s.CLASSID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
)

SELECT 
    studentid, 
    fullname, 
    -- CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
    rn = 1
    )
12:41:48.009771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:41:48.085916 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_124148_00078_d8x8s
12:41:48.087180 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 48:12: Column 's.facultyid' cannot be resolved", query_id=20241217_124148_00078_d8x8s)
12:41:48.088581 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:41:48.089402 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:41:48.098223 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 48:12: Column 's.facultyid' cannot be resolved", query_id=20241217_124148_00078_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:41:48.101824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dcfd154-a7fd-4492-a8b2-898b37daf7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2b02abc10>]}
12:41:48.102916 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model default_silver_default_silver.college_leads  [ERROR in 0.16s]
12:41:48.103843 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:41:48.104692 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 48:12: Column 's.facultyid' cannot be resolved", query_id=20241217_124148_00078_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:41:48.107139 [debug] [MainThread]: On master: COMMIT
12:41:48.107783 [debug] [MainThread]: Connection 'master' was properly closed.
12:41:48.108209 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:41:48.108652 [info ] [MainThread]: 
12:41:48.109155 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.48 seconds (0.48s).
12:41:48.110059 [debug] [MainThread]: Command end result
12:41:48.141336 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:41:48.143834 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:41:48.151411 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:41:48.152044 [info ] [MainThread]: 
12:41:48.152696 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:41:48.153253 [info ] [MainThread]: 
12:41:48.153868 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 48:12: Column 's.facultyid' cannot be resolved", query_id=20241217_124148_00078_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:41:48.154354 [info ] [MainThread]: 
12:41:48.154972 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:41:48.156253 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5728961, "process_in_blocks": "0", "process_kernel_time": 0.324571, "process_mem_max_rss": "110104", "process_out_blocks": "3048", "process_user_time": 2.688447}
12:41:48.157044 [debug] [MainThread]: Command `dbt run` failed at 12:41:48.156905 after 1.57 seconds
12:41:48.157639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2b0632ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2b43ca450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2b43ca550>]}
12:41:48.158252 [debug] [MainThread]: Flushing usage events
12:41:48.232112 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:42:38.677830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f2bf68b210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f2bf68acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f2bf68ab50>]}


============================== 12:42:38.681874 | 877c9af7-ff0c-433e-9777-14dfafb054f7 ==============================
12:42:38.681874 [info ] [MainThread]: Running with dbt=1.9.1
12:42:38.682691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/jovyan/Internal/logs', 'profiles_dir': '/home/jovyan/Internal', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s college_leads', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
12:42:38.874913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '877c9af7-ff0c-433e-9777-14dfafb054f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f2bf41a8d0>]}
12:42:38.944428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '877c9af7-ff0c-433e-9777-14dfafb054f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f2c1b44e90>]}
12:42:38.945537 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:42:39.027445 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:42:39.158420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:42:39.159520 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
12:42:39.478852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '877c9af7-ff0c-433e-9777-14dfafb054f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f2bf36f210>]}
12:42:39.575678 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:42:39.580697 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:42:39.593251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '877c9af7-ff0c-433e-9777-14dfafb054f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f2bf321a10>]}
12:42:39.594232 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:42:39.594846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '877c9af7-ff0c-433e-9777-14dfafb054f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f2bf0bf390>]}
12:42:39.596972 [info ] [MainThread]: 
12:42:39.597526 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:42:39.598018 [info ] [MainThread]: 
12:42:39.598752 [debug] [MainThread]: Acquiring new trino connection 'master'
12:42:39.600215 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:42:39.650973 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:42:39.651707 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:42:39.652190 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:42:39.652602 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:42:39.653297 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '877c9af7-ff0c-433e-9777-14dfafb054f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f2bf333710>]}
12:42:39.689876 [debug] [ThreadPool]: SQL status: SUCCESS in 0.038 seconds
12:42:39.691777 [debug] [ThreadPool]: On list_iceberg: Close
12:42:39.698436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
12:42:39.717800 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:42:39.718751 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:42:39.719268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:42:39.794740 [debug] [ThreadPool]: SQL status: SUCCESS in 0.075 seconds
12:42:39.796700 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:42:39.797278 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:42:39.798327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now list_iceberg_default_silver_default_silver)
12:42:39.804201 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver_default_silver"
12:42:39.804794 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver_default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver_default_silver'
12:42:39.805293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:42:39.889417 [debug] [ThreadPool]: SQL status: SUCCESS in 0.084 seconds
12:42:39.891404 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: ROLLBACK
12:42:39.892074 [debug] [ThreadPool]: On list_iceberg_default_silver_default_silver: Close
12:42:39.893329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '877c9af7-ff0c-433e-9777-14dfafb054f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f2bebca950>]}
12:42:39.894140 [debug] [MainThread]: On master: COMMIT
12:42:39.896818 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:42:39.898024 [info ] [Thread-1 (]: 1 of 1 START sql table model default_silver_default_silver.college_leads ....... [RUN]
12:42:39.899115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver_default_silver, now model.Internal.college_leads)
12:42:39.899949 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:42:39.907019 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:42:39.908060 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:42:39.962882 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:42:39.974437 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:42:39.975406 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  
    

    create table "iceberg"."default_silver_default_silver"."college_leads"
      
      
    as (
      -- Creates a physical table in the Silver schema


WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        -- COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
         ON sc.CLASSID = s.CLASSID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
)

SELECT 
    studentid, 
    fullname, 
    -- CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
    rn = 1
    )
12:42:39.976105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:42:40.031964 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_124239_00082_d8x8s
12:42:40.032762 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 45:13: Column 'sc.classid' cannot be resolved", query_id=20241217_124239_00082_d8x8s)
12:42:40.033571 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:42:40.034094 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:42:40.039549 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 45:13: Column 'sc.classid' cannot be resolved", query_id=20241217_124239_00082_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:42:40.042188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '877c9af7-ff0c-433e-9777-14dfafb054f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f2be744690>]}
12:42:40.043211 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model default_silver_default_silver.college_leads  [ERROR in 0.14s]
12:42:40.044032 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:42:40.044848 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 45:13: Column 'sc.classid' cannot be resolved", query_id=20241217_124239_00082_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:42:40.047385 [debug] [MainThread]: On master: COMMIT
12:42:40.048067 [debug] [MainThread]: Connection 'master' was properly closed.
12:42:40.048503 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:42:40.049000 [info ] [MainThread]: 
12:42:40.049480 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
12:42:40.050401 [debug] [MainThread]: Command end result
12:42:40.079076 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:42:40.081652 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:42:40.089463 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:42:40.090080 [info ] [MainThread]: 
12:42:40.090754 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:42:40.091294 [info ] [MainThread]: 
12:42:40.091952 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 45:13: Column 'sc.classid' cannot be resolved", query_id=20241217_124239_00082_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:42:40.092411 [info ] [MainThread]: 
12:42:40.092922 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:42:40.094275 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4765183, "process_in_blocks": "0", "process_kernel_time": 0.288395, "process_mem_max_rss": "110348", "process_out_blocks": "3048", "process_user_time": 2.643455}
12:42:40.095030 [debug] [MainThread]: Command `dbt run` failed at 12:42:40.094895 after 1.48 seconds
12:42:40.095634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f2c3629910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f2bf6bdf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f2bf6bc0d0>]}
12:42:40.096232 [debug] [MainThread]: Flushing usage events
12:42:40.157323 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:45:46.363567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b555a6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b56286d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b555a6450>]}


============================== 12:45:46.367646 | 3952fb2f-0b89-44e2-bea6-37ae9b9c0855 ==============================
12:45:46.367646 [info ] [MainThread]: Running with dbt=1.9.1
12:45:46.368429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/jovyan/Internal/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
12:45:46.491657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3952fb2f-0b89-44e2-bea6-37ae9b9c0855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b555a68d0>]}
12:45:46.504192 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20105304, "process_in_blocks": "0", "process_kernel_time": 0.220449, "process_mem_max_rss": "91184", "process_out_blocks": "8", "process_user_time": 1.5611}
12:45:46.504910 [debug] [MainThread]: Command `dbt clean` succeeded at 12:45:46.504781 after 0.20 seconds
12:45:46.505419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b555a6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b554cb910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b5922ff10>]}
12:45:46.505972 [debug] [MainThread]: Flushing usage events
12:45:46.601355 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:45:50.519863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7670b26dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7670b269d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7670b267d0>]}


============================== 12:45:50.524070 | 024cf2e8-05f4-4cb6-bf39-44a492446732 ==============================
12:45:50.524070 [info ] [MainThread]: Running with dbt=1.9.1
12:45:50.524874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jovyan/Internal/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s college_leads', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
12:45:50.723343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '024cf2e8-05f4-4cb6-bf39-44a492446732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a767098e0d0>]}
12:45:50.792397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '024cf2e8-05f4-4cb6-bf39-44a492446732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7672f50fd0>]}
12:45:50.793507 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:45:50.879317 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:45:50.880269 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
12:45:50.880908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '024cf2e8-05f4-4cb6-bf39-44a492446732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a767098f350>]}
12:45:52.402828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '024cf2e8-05f4-4cb6-bf39-44a492446732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7670388dd0>]}
12:45:52.504413 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:45:52.508410 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:45:52.519537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '024cf2e8-05f4-4cb6-bf39-44a492446732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a76704d67d0>]}
12:45:52.520428 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:45:52.521114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '024cf2e8-05f4-4cb6-bf39-44a492446732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7670303c50>]}
12:45:52.523341 [info ] [MainThread]: 
12:45:52.523864 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:45:52.524267 [info ] [MainThread]: 
12:45:52.524945 [debug] [MainThread]: Acquiring new trino connection 'master'
12:45:52.526216 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:45:52.578643 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:45:52.579579 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:45:52.580288 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:45:52.580737 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:45:52.581427 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '024cf2e8-05f4-4cb6-bf39-44a492446732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a767078b0d0>]}
12:45:52.621426 [debug] [ThreadPool]: SQL status: SUCCESS in 0.041 seconds
12:45:52.623346 [debug] [ThreadPool]: On list_iceberg: Close
12:45:52.630097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
12:45:52.648117 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:45:52.648795 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:45:52.649296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:45:52.724439 [debug] [ThreadPool]: SQL status: SUCCESS in 0.075 seconds
12:45:52.726437 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:45:52.727069 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:45:52.728217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '024cf2e8-05f4-4cb6-bf39-44a492446732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7670569310>]}
12:45:52.729006 [debug] [MainThread]: On master: COMMIT
12:45:52.731224 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:45:52.732097 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
12:45:52.732843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
12:45:52.733380 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:45:52.736692 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:45:52.737656 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:45:52.765987 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:45:52.777843 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:45:52.778794 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.classid = s.CLASSID  -- Update column name here
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
)

SELECT 
    studentid, 
    fullname, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
    rn = 1
12:45:52.779494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:45:52.862850 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_124552_00087_d8x8s
12:45:52.863643 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sc.classid' cannot be resolved", query_id=20241217_124552_00087_d8x8s)
12:45:52.864459 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:45:52.864975 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:45:52.870357 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sc.classid' cannot be resolved", query_id=20241217_124552_00087_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:45:52.872946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '024cf2e8-05f4-4cb6-bf39-44a492446732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a766ed167d0>]}
12:45:52.873930 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.14s]
12:45:52.874819 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:45:52.875721 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sc.classid' cannot be resolved", query_id=20241217_124552_00087_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:45:52.878522 [debug] [MainThread]: On master: COMMIT
12:45:52.879229 [debug] [MainThread]: Connection 'master' was properly closed.
12:45:52.879680 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:45:52.880132 [info ] [MainThread]: 
12:45:52.880650 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
12:45:52.881562 [debug] [MainThread]: Command end result
12:45:52.911308 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:45:52.918361 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:45:52.925011 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:45:52.925482 [info ] [MainThread]: 
12:45:52.926039 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:45:52.926505 [info ] [MainThread]: 
12:45:52.927045 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sc.classid' cannot be resolved", query_id=20241217_124552_00087_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:45:52.927587 [info ] [MainThread]: 
12:45:52.928337 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:45:52.930082 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4700859, "process_in_blocks": "0", "process_kernel_time": 0.304528, "process_mem_max_rss": "110196", "process_out_blocks": "3024", "process_user_time": 3.625383}
12:45:52.931170 [debug] [MainThread]: Command `dbt run` failed at 12:45:52.930975 after 2.47 seconds
12:45:52.932051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7670b5a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7674a31910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a76748d2610>]}
12:45:52.932901 [debug] [MainThread]: Flushing usage events
12:45:52.967403 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:47:05.997096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736696a7f5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736696a82d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736696a81c90>]}


============================== 12:47:06.001186 | fc5866d2-9bc9-4f62-9c6a-26a2789f95df ==============================
12:47:06.001186 [info ] [MainThread]: Running with dbt=1.9.1
12:47:06.001979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jovyan/Internal/logs', 'version_check': 'True', 'profiles_dir': '/home/jovyan/Internal', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s college_leads', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
12:47:06.196642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc5866d2-9bc9-4f62-9c6a-26a2789f95df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736696884510>]}
12:47:06.265226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc5866d2-9bc9-4f62-9c6a-26a2789f95df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736698f34e50>]}
12:47:06.266353 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:47:06.347021 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:47:06.477714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:47:06.478783 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
12:47:06.809804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc5866d2-9bc9-4f62-9c6a-26a2789f95df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736696360bd0>]}
12:47:06.923956 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:47:06.928196 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:47:06.939362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc5866d2-9bc9-4f62-9c6a-26a2789f95df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366963066d0>]}
12:47:06.940191 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:47:06.940805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc5866d2-9bc9-4f62-9c6a-26a2789f95df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366963a6910>]}
12:47:06.942899 [info ] [MainThread]: 
12:47:06.943422 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:47:06.943876 [info ] [MainThread]: 
12:47:06.944580 [debug] [MainThread]: Acquiring new trino connection 'master'
12:47:06.945923 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:47:06.994659 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:47:06.995348 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:47:06.995913 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:47:06.996389 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:47:06.997227 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'fc5866d2-9bc9-4f62-9c6a-26a2789f95df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736695fc3cd0>]}
12:47:07.038737 [debug] [ThreadPool]: SQL status: SUCCESS in 0.043 seconds
12:47:07.040734 [debug] [ThreadPool]: On list_iceberg: Close
12:47:07.049769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
12:47:07.070020 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:47:07.070799 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:47:07.071355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:47:07.143730 [debug] [ThreadPool]: SQL status: SUCCESS in 0.072 seconds
12:47:07.145612 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:47:07.146198 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:47:07.147425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc5866d2-9bc9-4f62-9c6a-26a2789f95df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366962f8d10>]}
12:47:07.148505 [debug] [MainThread]: On master: COMMIT
12:47:07.151324 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:47:07.152141 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
12:47:07.152821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
12:47:07.153319 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:47:07.156437 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:47:07.157299 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:47:07.181285 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:47:07.192695 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:47:07.193595 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.CLASSID = s.CLASSID  -- Update column name here
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
)

SELECT 
    studentid, 
    fullname, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
    rn = 1
12:47:07.194280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:47:07.255689 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_124707_00090_d8x8s
12:47:07.256492 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sc.classid' cannot be resolved", query_id=20241217_124707_00090_d8x8s)
12:47:07.257303 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:47:07.257832 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:47:07.263248 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sc.classid' cannot be resolved", query_id=20241217_124707_00090_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:47:07.265894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc5866d2-9bc9-4f62-9c6a-26a2789f95df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736695012010>]}
12:47:07.266901 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.11s]
12:47:07.267713 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:47:07.268732 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sc.classid' cannot be resolved", query_id=20241217_124707_00090_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:47:07.271385 [debug] [MainThread]: On master: COMMIT
12:47:07.272126 [debug] [MainThread]: Connection 'master' was properly closed.
12:47:07.272669 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:47:07.273260 [info ] [MainThread]: 
12:47:07.274016 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
12:47:07.274997 [debug] [MainThread]: Command end result
12:47:07.304348 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:47:07.306875 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:47:07.314030 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:47:07.314582 [info ] [MainThread]: 
12:47:07.315205 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:47:07.315693 [info ] [MainThread]: 
12:47:07.316215 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sc.classid' cannot be resolved", query_id=20241217_124707_00090_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:47:07.316662 [info ] [MainThread]: 
12:47:07.317161 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:47:07.318411 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3841165, "process_in_blocks": "0", "process_kernel_time": 0.31646, "process_mem_max_rss": "109916", "process_out_blocks": "3048", "process_user_time": 2.564624}
12:47:07.319138 [debug] [MainThread]: Command `dbt run` failed at 12:47:07.319008 after 1.39 seconds
12:47:07.319731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736696b720d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366968b7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73669689b810>]}
12:47:07.320279 [debug] [MainThread]: Flushing usage events
12:47:07.396150 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:47:31.281337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716230e5b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716230cbe650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716230cbebd0>]}


============================== 12:47:31.285302 | 56244760-2159-4ed4-b6a6-991b560f9f02 ==============================
12:47:31.285302 [info ] [MainThread]: Running with dbt=1.9.1
12:47:31.286054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/jovyan/Internal/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s college_leads', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
12:47:31.480377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56244760-2159-4ed4-b6a6-991b560f9f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716230cbe8d0>]}
12:47:31.549876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56244760-2159-4ed4-b6a6-991b560f9f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716230b50f10>]}
12:47:31.551160 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:47:31.634875 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:47:31.769359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:47:31.770401 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
12:47:32.124381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56244760-2159-4ed4-b6a6-991b560f9f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7162306f4d90>]}
12:47:32.219140 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:47:32.223214 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:47:32.234331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56244760-2159-4ed4-b6a6-991b560f9f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7162308a3650>]}
12:47:32.235165 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:47:32.235747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56244760-2159-4ed4-b6a6-991b560f9f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71622ff3d490>]}
12:47:32.237728 [info ] [MainThread]: 
12:47:32.238240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:47:32.238651 [info ] [MainThread]: 
12:47:32.239375 [debug] [MainThread]: Acquiring new trino connection 'master'
12:47:32.240730 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:47:32.289504 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:47:32.290239 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:47:32.290748 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:47:32.291141 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:47:32.291776 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '56244760-2159-4ed4-b6a6-991b560f9f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7162303b84d0>]}
12:47:32.322827 [debug] [ThreadPool]: SQL status: SUCCESS in 0.032 seconds
12:47:32.324786 [debug] [ThreadPool]: On list_iceberg: Close
12:47:32.331222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
12:47:32.349108 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:47:32.349777 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:47:32.350281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:47:32.425259 [debug] [ThreadPool]: SQL status: SUCCESS in 0.075 seconds
12:47:32.427145 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:47:32.427674 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:47:32.428831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56244760-2159-4ed4-b6a6-991b560f9f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7162308d1810>]}
12:47:32.429534 [debug] [MainThread]: On master: COMMIT
12:47:32.431656 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:47:32.432358 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
12:47:32.433012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
12:47:32.433502 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:47:32.436471 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:47:32.437280 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:47:32.461118 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:47:32.472172 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:47:32.472980 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.CLASSID = s.CLASSID  -- Update column name here
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
)

SELECT 
    studentid, 
    fullname, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
    rn = 1
12:47:32.473611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:47:32.535326 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_124732_00093_d8x8s
12:47:32.536066 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 's.facultyid' cannot be resolved", query_id=20241217_124732_00093_d8x8s)
12:47:32.536833 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:47:32.537331 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:47:32.542517 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 's.facultyid' cannot be resolved", query_id=20241217_124732_00093_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:47:32.544769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56244760-2159-4ed4-b6a6-991b560f9f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71622f19b650>]}
12:47:32.545668 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.11s]
12:47:32.546422 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:47:32.547228 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 's.facultyid' cannot be resolved", query_id=20241217_124732_00093_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:47:32.549497 [debug] [MainThread]: On master: COMMIT
12:47:32.550189 [debug] [MainThread]: Connection 'master' was properly closed.
12:47:32.550589 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:47:32.551109 [info ] [MainThread]: 
12:47:32.551569 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
12:47:32.552498 [debug] [MainThread]: Command end result
12:47:32.581724 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:47:32.584357 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:47:32.591757 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:47:32.592301 [info ] [MainThread]: 
12:47:32.592919 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:47:32.593378 [info ] [MainThread]: 
12:47:32.593942 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 's.facultyid' cannot be resolved", query_id=20241217_124732_00093_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:47:32.594368 [info ] [MainThread]: 
12:47:32.594921 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:47:32.596343 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3752834, "process_in_blocks": "0", "process_kernel_time": 0.324834, "process_mem_max_rss": "109460", "process_out_blocks": "3032", "process_user_time": 2.539886}
12:47:32.597147 [debug] [MainThread]: Command `dbt run` failed at 12:47:32.597015 after 1.38 seconds
12:47:32.597747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716230ce0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716230cbebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71623071be50>]}
12:47:32.598352 [debug] [MainThread]: Flushing usage events
12:47:32.634393 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:47:53.197264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db50752f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db50752ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db50752ed50>]}


============================== 12:47:53.201347 | 8f302f41-9356-4652-8335-ae04445c6b4f ==============================
12:47:53.201347 [info ] [MainThread]: Running with dbt=1.9.1
12:47:53.202198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jovyan/Internal/logs', 'version_check': 'True', 'profiles_dir': '/home/jovyan/Internal', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s college_leads', 'send_anonymous_usage_stats': 'True'}
12:47:53.398865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f302f41-9356-4652-8335-ae04445c6b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db507394790>]}
12:47:53.470789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f302f41-9356-4652-8335-ae04445c6b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db507371c90>]}
12:47:53.471930 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:47:53.555123 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:47:53.684809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:47:53.685881 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
12:47:54.059701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f302f41-9356-4652-8335-ae04445c6b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db507135cd0>]}
12:47:54.158590 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:47:54.163813 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:47:54.176299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f302f41-9356-4652-8335-ae04445c6b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db506f762d0>]}
12:47:54.177450 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:47:54.178249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f302f41-9356-4652-8335-ae04445c6b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db5071d5310>]}
12:47:54.180897 [info ] [MainThread]: 
12:47:54.181416 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:47:54.181859 [info ] [MainThread]: 
12:47:54.182602 [debug] [MainThread]: Acquiring new trino connection 'master'
12:47:54.183994 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:47:54.233007 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:47:54.233758 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:47:54.234296 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:47:54.234765 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:47:54.235529 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '8f302f41-9356-4652-8335-ae04445c6b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db5072c0310>]}
12:47:54.278564 [debug] [ThreadPool]: SQL status: SUCCESS in 0.044 seconds
12:47:54.280583 [debug] [ThreadPool]: On list_iceberg: Close
12:47:54.287354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
12:47:54.307000 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:47:54.307713 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:47:54.308197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:47:54.380562 [debug] [ThreadPool]: SQL status: SUCCESS in 0.072 seconds
12:47:54.382513 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:47:54.383091 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:47:54.384224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f302f41-9356-4652-8335-ae04445c6b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db5072afe90>]}
12:47:54.385033 [debug] [MainThread]: On master: COMMIT
12:47:54.387417 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:47:54.388269 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
12:47:54.389041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
12:47:54.389590 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:47:54.392947 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:47:54.393873 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:47:54.418187 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:47:54.430582 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:47:54.431943 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.CLASSID = s.CLASSID  -- Update column name here
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
)

SELECT 
    studentid, 
    fullname, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
    rn = 1
12:47:54.433070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:47:54.499273 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_124754_00096_d8x8s
12:47:54.500029 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 38:9: Table 'iceberg.default.airbyte_raw_ayear' does not exist", query_id=20241217_124754_00096_d8x8s)
12:47:54.500833 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:47:54.501343 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:47:54.506604 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 38:9: Table 'iceberg.default.airbyte_raw_ayear' does not exist", query_id=20241217_124754_00096_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:47:54.509231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f302f41-9356-4652-8335-ae04445c6b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db50574d2d0>]}
12:47:54.510243 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.12s]
12:47:54.511059 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:47:54.511864 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 38:9: Table 'iceberg.default.airbyte_raw_ayear' does not exist", query_id=20241217_124754_00096_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:47:54.514490 [debug] [MainThread]: On master: COMMIT
12:47:54.515199 [debug] [MainThread]: Connection 'master' was properly closed.
12:47:54.515653 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:47:54.516117 [info ] [MainThread]: 
12:47:54.516591 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
12:47:54.517490 [debug] [MainThread]: Command end result
12:47:54.547159 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:47:54.549674 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:47:54.557309 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:47:54.557927 [info ] [MainThread]: 
12:47:54.558560 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:47:54.559100 [info ] [MainThread]: 
12:47:54.559724 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 38:9: Table 'iceberg.default.airbyte_raw_ayear' does not exist", query_id=20241217_124754_00096_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:47:54.560293 [info ] [MainThread]: 
12:47:54.560993 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:47:54.562279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4247724, "process_in_blocks": "0", "process_kernel_time": 0.309869, "process_mem_max_rss": "109624", "process_out_blocks": "3040", "process_user_time": 2.704133}
12:47:54.563060 [debug] [MainThread]: Command `dbt run` failed at 12:47:54.562921 after 1.43 seconds
12:47:54.563756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db507929850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db50752ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db50b366350>]}
12:47:54.564373 [debug] [MainThread]: Flushing usage events
12:47:54.635832 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:50:16.892061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703b9e6b9f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703b9e2bff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703b9e2c18d0>]}


============================== 12:50:16.896190 | 3c06e8df-5340-46fa-8176-115c241c1c7e ==============================
12:50:16.896190 [info ] [MainThread]: Running with dbt=1.9.1
12:50:16.897088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/jovyan/Internal', 'log_path': '/home/jovyan/Internal/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s college_leads', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
12:50:17.103706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c06e8df-5340-46fa-8176-115c241c1c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703b9e13c890>]}
12:50:17.177178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c06e8df-5340-46fa-8176-115c241c1c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703b9e800e90>]}
12:50:17.178235 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:50:17.263131 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:50:17.396864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:50:17.397961 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
12:50:17.720304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c06e8df-5340-46fa-8176-115c241c1c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703b9db59d10>]}
12:50:17.821275 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:50:17.825558 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:50:17.837593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c06e8df-5340-46fa-8176-115c241c1c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703b9dac05d0>]}
12:50:17.838466 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:50:17.839068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c06e8df-5340-46fa-8176-115c241c1c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703b9dbd60d0>]}
12:50:17.841343 [info ] [MainThread]: 
12:50:17.841972 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:50:17.842398 [info ] [MainThread]: 
12:50:17.843210 [debug] [MainThread]: Acquiring new trino connection 'master'
12:50:17.844639 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:50:17.894197 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:50:17.894877 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:50:17.895345 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:50:17.895764 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:50:17.896380 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '3c06e8df-5340-46fa-8176-115c241c1c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703b9daac250>]}
12:50:17.935850 [debug] [ThreadPool]: SQL status: SUCCESS in 0.040 seconds
12:50:17.937668 [debug] [ThreadPool]: On list_iceberg: Close
12:50:17.944245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
12:50:17.962058 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:50:17.962678 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:50:17.963134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:50:18.036577 [debug] [ThreadPool]: SQL status: SUCCESS in 0.073 seconds
12:50:18.038449 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:50:18.039005 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:50:18.040066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c06e8df-5340-46fa-8176-115c241c1c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703b9ddcbb10>]}
12:50:18.040850 [debug] [MainThread]: On master: COMMIT
12:50:18.043074 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:50:18.043799 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
12:50:18.044434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
12:50:18.045018 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:50:18.047825 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:50:18.048589 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:50:18.071957 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:50:18.084038 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:50:18.084902 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.CLASSID = s.CLASSID  -- Update column name here
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
)

SELECT 
    studentid, 
    fullname, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
    rn = 1
12:50:18.085765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:50:18.143759 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_125018_00099_d8x8s
12:50:18.144443 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sm.studentid' cannot be resolved", query_id=20241217_125018_00099_d8x8s)
12:50:18.145213 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:50:18.145731 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:50:18.150944 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sm.studentid' cannot be resolved", query_id=20241217_125018_00099_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:50:18.153226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c06e8df-5340-46fa-8176-115c241c1c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703b9db59ed0>]}
12:50:18.154141 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.11s]
12:50:18.154921 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:50:18.155727 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sm.studentid' cannot be resolved", query_id=20241217_125018_00099_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:50:18.158105 [debug] [MainThread]: On master: COMMIT
12:50:18.158772 [debug] [MainThread]: Connection 'master' was properly closed.
12:50:18.159260 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:50:18.159803 [info ] [MainThread]: 
12:50:18.160337 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
12:50:18.161239 [debug] [MainThread]: Command end result
12:50:18.191655 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:50:18.193940 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:50:18.200883 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:50:18.201369 [info ] [MainThread]: 
12:50:18.201983 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:50:18.202512 [info ] [MainThread]: 
12:50:18.203105 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sm.studentid' cannot be resolved", query_id=20241217_125018_00099_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:50:18.203596 [info ] [MainThread]: 
12:50:18.204132 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:50:18.205357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3757911, "process_in_blocks": "8", "process_kernel_time": 0.298298, "process_mem_max_rss": "109612", "process_out_blocks": "3040", "process_user_time": 2.614851}
12:50:18.206118 [debug] [MainThread]: Command `dbt run` failed at 12:50:18.205988 after 1.38 seconds
12:50:18.206709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703b9e14a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703ba21c98d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703ba206aa10>]}
12:50:18.207298 [debug] [MainThread]: Flushing usage events
12:50:18.296878 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:57:48.695061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73067638fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730676392d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730676392f90>]}


============================== 12:57:48.699087 | a7ec2062-d592-4153-8d31-086667c63159 ==============================
12:57:48.699087 [info ] [MainThread]: Running with dbt=1.9.1
12:57:48.699858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jovyan/Internal/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s college_leads', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
12:57:48.896254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7ec2062-d592-4153-8d31-086667c63159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7306761f47d0>]}
12:57:48.966299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7ec2062-d592-4153-8d31-086667c63159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730676085fd0>]}
12:57:48.967421 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:57:49.049269 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:57:49.190778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:57:49.191907 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
12:57:49.511148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7ec2062-d592-4153-8d31-086667c63159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73067605cb50>]}
12:57:49.617235 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:57:49.621570 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:57:49.632996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7ec2062-d592-4153-8d31-086667c63159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730675b66cd0>]}
12:57:49.633826 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:57:49.634363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7ec2062-d592-4153-8d31-086667c63159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730675c533d0>]}
12:57:49.636354 [info ] [MainThread]: 
12:57:49.636910 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:57:49.637331 [info ] [MainThread]: 
12:57:49.638076 [debug] [MainThread]: Acquiring new trino connection 'master'
12:57:49.639445 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:57:49.687785 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:57:49.688445 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:57:49.688956 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:57:49.689348 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:57:49.690015 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'a7ec2062-d592-4153-8d31-086667c63159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730675b58e50>]}
12:57:49.747512 [debug] [ThreadPool]: SQL status: SUCCESS in 0.058 seconds
12:57:49.749658 [debug] [ThreadPool]: On list_iceberg: Close
12:57:49.756369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
12:57:49.774443 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:57:49.775093 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:57:49.775545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:57:49.852245 [debug] [ThreadPool]: SQL status: SUCCESS in 0.077 seconds
12:57:49.854575 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:57:49.855231 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:57:49.856396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7ec2062-d592-4153-8d31-086667c63159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730675cee050>]}
12:57:49.857310 [debug] [MainThread]: On master: COMMIT
12:57:49.859805 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:57:49.860582 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
12:57:49.861265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
12:57:49.861784 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:57:49.864940 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:57:49.865798 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:57:49.889702 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:57:49.892953 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:57:49.893732 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid,
        -- CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        -- COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        -- COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        -- COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        -- COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        -- COALESCE(sm.SSEX, 'N/A') AS SSEX,
        -- sm.DOB,
        -- sm.ADMDATE,
        -- sm.HOBY,
        -- sm.STATUS,
        -- COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        -- COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        -- COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        -- COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        -- COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        -- COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        -- COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        -- COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        -- COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        -- CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        -- COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        -- COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        -- COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        -- COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        -- ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
--     LEFT JOIN 
--         default.airbyte_raw_studentmain sm 
--         ON sm.STUDENTID = s.STUDENTID 
--     LEFT JOIN 
--         default.airbyte_raw_ayear a 
--         ON a.AYEARID = s.AYEARID 
--     LEFT JOIN 
--         default.airbyte_raw_faculty f 
--         ON s.FACULTYID = f.FACULTYID 
--     LEFT JOIN 
--         default.airbyte_raw_studentclass sc 
--         ON sc.CLASSID = s.CLASSID  -- Update column name here
--     LEFT JOIN 
--         default.airbyte_raw_department d 
--         ON s.DEPARTMENTID = d.DEPARTMENTID 
--     LEFT JOIN 
--         default.airbyte_raw_ayear a 
--         ON a.AYEARID = s.AYEARID 
--     LEFT JOIN 
--         default.airbyte_raw_batch b 
--         ON b.BatchID = sm.BatchID 
--     LEFT JOIN 
--         default.airbyte_raw_ngroup n 
--         ON n.GROUPID = s.GROUPID 
--     LEFT JOIN 
--         default.airbyte_raw_generalstudent g 
--         ON g.STUDENTID = s.STUDENTID 
--     LEFT JOIN 
--         default.airbyte_raw_zone z 
--         ON z.ZONEID = g.ZONEID 
--     LEFT JOIN 
--         default.airbyte_raw_district DIS 
--         ON DIS.DISTRICTID = g.DISTRICTID 
--     LEFT JOIN 
--         default.airbyte_raw_parent PAR 
--         ON PAR.STUDENTID = s.STUDENTID
-- )

-- SELECT 
--     studentid, 
--     fullname, 
--     CLASSNAME, 
--     FACULTYNAME, 
--     DEPARTMENTNAME, 
--     AYEAR,
--     SSEX, 
--     DOB, 
--     ADMDATE, 
--     HOBY, 
--     STATUS, 
--     SCHOOLFROM, 
--     GROUPNAME, 
--     CONTACTADDRESS, 
--     CONTACTPHONE, 
--     PARMANENTADDRESS, 
--     PARMANENTPHONE, 
--     FATHERNAME, 
--     DISTRICTNAME, 
--     ZONENAME,
--     PARENTFULLNAME,
--     PARENTMOBILENO,
--     PARENTEMAIL,
--     PARENTOFFICEPHONENO,
--     PARENTMOBILENO1,
--     'UNIGLOBE COLLEGE' AS organization
-- FROM 
--     RankedStudents
-- WHERE 
--     rn = 1;
  
12:57:49.894397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:57:49.904295 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_125749_00105_d8x8s
12:57:49.904974 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 35:5: mismatched input 'FROM'. Expecting: '*', <expression>", query_id=20241217_125749_00105_d8x8s)
12:57:49.905722 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:57:49.906212 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:57:49.911437 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 35:5: mismatched input 'FROM'. Expecting: '*', <expression>", query_id=20241217_125749_00105_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:57:49.914004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ec2062-d592-4153-8d31-086667c63159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730674fa0250>]}
12:57:49.915073 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.05s]
12:57:49.915987 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:57:49.916868 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 35:5: mismatched input 'FROM'. Expecting: '*', <expression>", query_id=20241217_125749_00105_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:57:49.919458 [debug] [MainThread]: On master: COMMIT
12:57:49.920280 [debug] [MainThread]: Connection 'master' was properly closed.
12:57:49.920910 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:57:49.921556 [info ] [MainThread]: 
12:57:49.922308 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
12:57:49.923590 [debug] [MainThread]: Command end result
12:57:49.970426 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:57:49.973953 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:57:49.983724 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:57:49.984268 [info ] [MainThread]: 
12:57:49.984842 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:57:49.985303 [info ] [MainThread]: 
12:57:49.985873 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 35:5: mismatched input 'FROM'. Expecting: '*', <expression>", query_id=20241217_125749_00105_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:57:49.986324 [info ] [MainThread]: 
12:57:49.986792 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:57:49.987975 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3531263, "process_in_blocks": "8", "process_kernel_time": 0.315345, "process_mem_max_rss": "109044", "process_out_blocks": "3048", "process_user_time": 2.57266}
12:57:49.988695 [debug] [MainThread]: Command `dbt run` failed at 12:57:49.988550 after 1.35 seconds
12:57:49.989258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73067638f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73067638ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73067a1b18d0>]}
12:57:49.989806 [debug] [MainThread]: Flushing usage events
12:57:50.130941 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:58:21.708763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1febf2f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1febf32f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1febf6c050>]}


============================== 12:58:21.712895 | cfd4799c-6ee9-4a8e-a000-5fcd23be4ffb ==============================
12:58:21.712895 [info ] [MainThread]: Running with dbt=1.9.1
12:58:21.713690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jovyan/Internal/logs', 'version_check': 'True', 'profiles_dir': '/home/jovyan/Internal', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s college_leads', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
12:58:21.908567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfd4799c-6ee9-4a8e-a000-5fcd23be4ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1febdad790>]}
12:58:21.978264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfd4799c-6ee9-4a8e-a000-5fcd23be4ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fee3f1210>]}
12:58:21.979359 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:58:22.065043 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:58:22.199346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:58:22.200396 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
12:58:22.527867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfd4799c-6ee9-4a8e-a000-5fcd23be4ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fec6177d0>]}
12:58:22.624002 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:58:22.628012 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:58:22.638877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfd4799c-6ee9-4a8e-a000-5fcd23be4ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1feb72c110>]}
12:58:22.639693 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:58:22.640227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfd4799c-6ee9-4a8e-a000-5fcd23be4ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1feb6f5bd0>]}
12:58:22.642297 [info ] [MainThread]: 
12:58:22.642855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:58:22.643272 [info ] [MainThread]: 
12:58:22.643988 [debug] [MainThread]: Acquiring new trino connection 'master'
12:58:22.645349 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:58:22.695994 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:58:22.696724 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:58:22.697234 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:58:22.697663 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:58:22.698427 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'cfd4799c-6ee9-4a8e-a000-5fcd23be4ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1feb846f10>]}
12:58:22.737381 [debug] [ThreadPool]: SQL status: SUCCESS in 0.040 seconds
12:58:22.739428 [debug] [ThreadPool]: On list_iceberg: Close
12:58:22.746456 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
12:58:22.765351 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:58:22.766109 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:58:22.766646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:58:22.842403 [debug] [ThreadPool]: SQL status: SUCCESS in 0.076 seconds
12:58:22.844384 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:58:22.844960 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:58:22.846121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfd4799c-6ee9-4a8e-a000-5fcd23be4ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1febb448d0>]}
12:58:22.847166 [debug] [MainThread]: On master: COMMIT
12:58:22.850001 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:58:22.850781 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
12:58:22.851464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
12:58:22.852007 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:58:22.855151 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:58:22.855966 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:58:22.882058 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:58:22.885577 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:58:22.886454 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid
        -- CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        -- COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        -- COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        -- COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        -- COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        -- COALESCE(sm.SSEX, 'N/A') AS SSEX,
        -- sm.DOB,
        -- sm.ADMDATE,
        -- sm.HOBY,
        -- sm.STATUS,
        -- COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        -- COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        -- COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        -- COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        -- COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        -- COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        -- COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        -- COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        -- COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        -- CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        -- COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        -- COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        -- COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        -- COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        -- ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
--     LEFT JOIN 
--         default.airbyte_raw_studentmain sm 
--         ON sm.STUDENTID = s.STUDENTID 
--     LEFT JOIN 
--         default.airbyte_raw_ayear a 
--         ON a.AYEARID = s.AYEARID 
--     LEFT JOIN 
--         default.airbyte_raw_faculty f 
--         ON s.FACULTYID = f.FACULTYID 
--     LEFT JOIN 
--         default.airbyte_raw_studentclass sc 
--         ON sc.CLASSID = s.CLASSID  -- Update column name here
--     LEFT JOIN 
--         default.airbyte_raw_department d 
--         ON s.DEPARTMENTID = d.DEPARTMENTID 
--     LEFT JOIN 
--         default.airbyte_raw_ayear a 
--         ON a.AYEARID = s.AYEARID 
--     LEFT JOIN 
--         default.airbyte_raw_batch b 
--         ON b.BatchID = sm.BatchID 
--     LEFT JOIN 
--         default.airbyte_raw_ngroup n 
--         ON n.GROUPID = s.GROUPID 
--     LEFT JOIN 
--         default.airbyte_raw_generalstudent g 
--         ON g.STUDENTID = s.STUDENTID 
--     LEFT JOIN 
--         default.airbyte_raw_zone z 
--         ON z.ZONEID = g.ZONEID 
--     LEFT JOIN 
--         default.airbyte_raw_district DIS 
--         ON DIS.DISTRICTID = g.DISTRICTID 
--     LEFT JOIN 
--         default.airbyte_raw_parent PAR 
--         ON PAR.STUDENTID = s.STUDENTID
-- )

-- SELECT 
--     studentid, 
--     fullname, 
--     CLASSNAME, 
--     FACULTYNAME, 
--     DEPARTMENTNAME, 
--     AYEAR,
--     SSEX, 
--     DOB, 
--     ADMDATE, 
--     HOBY, 
--     STATUS, 
--     SCHOOLFROM, 
--     GROUPNAME, 
--     CONTACTADDRESS, 
--     CONTACTPHONE, 
--     PARMANENTADDRESS, 
--     PARMANENTPHONE, 
--     FATHERNAME, 
--     DISTRICTNAME, 
--     ZONENAME,
--     PARENTFULLNAME,
--     PARENTMOBILENO,
--     PARENTEMAIL,
--     PARENTOFFICEPHONENO,
--     PARENTMOBILENO1,
--     'UNIGLOBE COLLEGE' AS organization
-- FROM 
--     RankedStudents
-- WHERE 
--     rn = 1;
  
12:58:22.887218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:58:22.897218 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_125822_00108_d8x8s
12:58:22.898041 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 106:3: mismatched input '<EOF>'. Expecting: '(', ')', ',', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW'", query_id=20241217_125822_00108_d8x8s)
12:58:22.898882 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:58:22.899385 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:58:22.904889 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 106:3: mismatched input '<EOF>'. Expecting: '(', ')', ',', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW'", query_id=20241217_125822_00108_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:58:22.907600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfd4799c-6ee9-4a8e-a000-5fcd23be4ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fea575e50>]}
12:58:22.908708 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.05s]
12:58:22.909488 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:58:22.910411 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 106:3: mismatched input '<EOF>'. Expecting: '(', ')', ',', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW'", query_id=20241217_125822_00108_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:58:22.913134 [debug] [MainThread]: On master: COMMIT
12:58:22.914097 [debug] [MainThread]: Connection 'master' was properly closed.
12:58:22.914768 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:58:22.915472 [info ] [MainThread]: 
12:58:22.916234 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
12:58:22.917577 [debug] [MainThread]: Command end result
12:58:22.964403 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:58:22.966841 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:58:22.974133 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:58:22.974714 [info ] [MainThread]: 
12:58:22.975305 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:58:22.975813 [info ] [MainThread]: 
12:58:22.976377 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 106:3: mismatched input '<EOF>'. Expecting: '(', ')', ',', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW'", query_id=20241217_125822_00108_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:58:22.976888 [info ] [MainThread]: 
12:58:22.977363 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:58:22.978684 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3299088, "process_in_blocks": "0", "process_kernel_time": 0.320636, "process_mem_max_rss": "109216", "process_out_blocks": "3048", "process_user_time": 2.562098}
12:58:22.979391 [debug] [MainThread]: Command `dbt run` failed at 12:58:22.979261 after 1.33 seconds
12:58:22.980041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1febdb6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1febdb64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fefd71950>]}
12:58:22.980580 [debug] [MainThread]: Flushing usage events
12:58:23.045773 [debug] [MainThread]: An error was encountered while trying to flush usage events
12:59:31.095387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714e4585f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714e45c59b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714e45d70110>]}


============================== 12:59:31.099676 | 2c7ce28f-eb16-45a9-8150-ba77bb93799a ==============================
12:59:31.099676 [info ] [MainThread]: Running with dbt=1.9.1
12:59:31.100555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/jovyan/Internal/logs', 'fail_fast': 'False', 'profiles_dir': '/home/jovyan/Internal', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s college_leads', 'send_anonymous_usage_stats': 'True'}
12:59:31.294809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c7ce28f-eb16-45a9-8150-ba77bb93799a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714e455e3b90>]}
12:59:31.363118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c7ce28f-eb16-45a9-8150-ba77bb93799a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714e47c88dd0>]}
12:59:31.364292 [info ] [MainThread]: Registered adapter: trino=1.8.5
12:59:31.445077 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
12:59:31.573029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:59:31.574069 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
12:59:31.887511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c7ce28f-eb16-45a9-8150-ba77bb93799a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714e45519110>]}
12:59:31.986793 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:59:31.990568 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:59:32.002586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c7ce28f-eb16-45a9-8150-ba77bb93799a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714e450e68d0>]}
12:59:32.003725 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
12:59:32.004387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c7ce28f-eb16-45a9-8150-ba77bb93799a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714e45153290>]}
12:59:32.007248 [info ] [MainThread]: 
12:59:32.007887 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:59:32.008425 [info ] [MainThread]: 
12:59:32.009252 [debug] [MainThread]: Acquiring new trino connection 'master'
12:59:32.010776 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
12:59:32.063810 [debug] [ThreadPool]: Using trino connection "list_iceberg"
12:59:32.064513 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
12:59:32.065074 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:59:32.065508 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
12:59:32.066267 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '2c7ce28f-eb16-45a9-8150-ba77bb93799a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714e44d69590>]}
12:59:32.122514 [debug] [ThreadPool]: SQL status: SUCCESS in 0.057 seconds
12:59:32.124469 [debug] [ThreadPool]: On list_iceberg: Close
12:59:32.131332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
12:59:32.149844 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
12:59:32.150467 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
12:59:32.150948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:59:32.256138 [debug] [ThreadPool]: SQL status: SUCCESS in 0.105 seconds
12:59:32.259037 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
12:59:32.259894 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
12:59:32.261440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c7ce28f-eb16-45a9-8150-ba77bb93799a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714e45153290>]}
12:59:32.262458 [debug] [MainThread]: On master: COMMIT
12:59:32.265169 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
12:59:32.266048 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
12:59:32.266857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
12:59:32.267519 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
12:59:32.271562 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
12:59:32.272486 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
12:59:32.301769 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
12:59:32.306029 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
12:59:32.306916 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid
        -- CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        -- COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        -- COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        -- COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        -- COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        -- COALESCE(sm.SSEX, 'N/A') AS SSEX,
        -- sm.DOB,
        -- sm.ADMDATE,
        -- sm.HOBY,
        -- sm.STATUS,
        -- COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        -- COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        -- COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        -- COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        -- COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        -- COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        -- COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        -- COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        -- COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        -- CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        -- COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        -- COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        -- COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        -- COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        -- ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
--     LEFT JOIN 
--         default.airbyte_raw_studentmain sm 
--         ON sm.STUDENTID = s.STUDENTID 
--     LEFT JOIN 
--         default.airbyte_raw_ayear a 
--         ON a.AYEARID = s.AYEARID 
--     LEFT JOIN 
--         default.airbyte_raw_faculty f 
--         ON s.FACULTYID = f.FACULTYID 
--     LEFT JOIN 
--         default.airbyte_raw_studentclass sc 
--         ON sc.CLASSID = s.CLASSID  -- Update column name here
--     LEFT JOIN 
--         default.airbyte_raw_department d 
--         ON s.DEPARTMENTID = d.DEPARTMENTID 
--     LEFT JOIN 
--         default.airbyte_raw_ayear a 
--         ON a.AYEARID = s.AYEARID 
--     LEFT JOIN 
--         default.airbyte_raw_batch b 
--         ON b.BatchID = sm.BatchID 
--     LEFT JOIN 
--         default.airbyte_raw_ngroup n 
--         ON n.GROUPID = s.GROUPID 
--     LEFT JOIN 
--         default.airbyte_raw_generalstudent g 
--         ON g.STUDENTID = s.STUDENTID 
--     LEFT JOIN 
--         default.airbyte_raw_zone z 
--         ON z.ZONEID = g.ZONEID 
--     LEFT JOIN 
--         default.airbyte_raw_district DIS 
--         ON DIS.DISTRICTID = g.DISTRICTID 
--     LEFT JOIN 
--         default.airbyte_raw_parent PAR 
--         ON PAR.STUDENTID = s.STUDENTID
-- )

-- SELECT 
--     studentid, 
--     fullname, 
--     CLASSNAME, 
--     FACULTYNAME, 
--     DEPARTMENTNAME, 
--     AYEAR,
--     SSEX, 
--     DOB, 
--     ADMDATE, 
--     HOBY, 
--     STATUS, 
--     SCHOOLFROM, 
--     GROUPNAME, 
--     CONTACTADDRESS, 
--     CONTACTPHONE, 
--     PARMANENTADDRESS, 
--     PARMANENTPHONE, 
--     FATHERNAME, 
--     DISTRICTNAME, 
--     ZONENAME,
--     PARENTFULLNAME,
--     PARENTMOBILENO,
--     PARENTEMAIL,
--     PARENTOFFICEPHONENO,
--     PARENTMOBILENO1,
--     'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
   rn = 1;
  
12:59:32.307806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
12:59:32.317545 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_125932_00111_d8x8s
12:59:32.318454 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 102:1: mismatched input 'FROM'. Expecting: '(', ')', ',', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW'", query_id=20241217_125932_00111_d8x8s)
12:59:32.319336 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
12:59:32.319964 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
12:59:32.325387 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 102:1: mismatched input 'FROM'. Expecting: '(', ')', ',', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW'", query_id=20241217_125932_00111_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:59:32.328011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c7ce28f-eb16-45a9-8150-ba77bb93799a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714e44d87d10>]}
12:59:32.329050 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.06s]
12:59:32.330140 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
12:59:32.331015 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 102:1: mismatched input 'FROM'. Expecting: '(', ')', ',', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW'", query_id=20241217_125932_00111_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
12:59:32.333865 [debug] [MainThread]: On master: COMMIT
12:59:32.334544 [debug] [MainThread]: Connection 'master' was properly closed.
12:59:32.335036 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
12:59:32.335529 [info ] [MainThread]: 
12:59:32.336079 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
12:59:32.337023 [debug] [MainThread]: Command end result
12:59:32.366133 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
12:59:32.368460 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
12:59:32.375675 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
12:59:32.376209 [info ] [MainThread]: 
12:59:32.376831 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
12:59:32.377315 [info ] [MainThread]: 
12:59:32.377988 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 102:1: mismatched input 'FROM'. Expecting: '(', ')', ',', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW'", query_id=20241217_125932_00111_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
12:59:32.378445 [info ] [MainThread]: 
12:59:32.378960 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:59:32.380155 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3504875, "process_in_blocks": "0", "process_kernel_time": 0.309725, "process_mem_max_rss": "110008", "process_out_blocks": "3048", "process_user_time": 2.55873}
12:59:32.380915 [debug] [MainThread]: Command `dbt run` failed at 12:59:32.380780 after 1.35 seconds
12:59:32.381480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714e456c6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714e456c5890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714e49609850>]}
12:59:32.382041 [debug] [MainThread]: Flushing usage events
12:59:32.474058 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:00:27.013452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796ad1ce2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796ad1d2bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796ad1ce5ed0>]}


============================== 13:00:27.017784 | 8dfddf59-ab8e-4ece-97b2-d6ea3b507ce2 ==============================
13:00:27.017784 [info ] [MainThread]: Running with dbt=1.9.1
13:00:27.018670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jovyan/Internal/logs', 'profiles_dir': '/home/jovyan/Internal', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s college_leads', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
13:00:27.218840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dfddf59-ab8e-4ece-97b2-d6ea3b507ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796ad199e990>]}
13:00:27.296407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dfddf59-ab8e-4ece-97b2-d6ea3b507ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796ad4108390>]}
13:00:27.297827 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:00:27.384701 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:00:27.515861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:00:27.516948 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
13:00:27.830364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dfddf59-ab8e-4ece-97b2-d6ea3b507ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796ad22251d0>]}
13:00:27.923440 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:00:27.927448 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:00:27.938046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dfddf59-ab8e-4ece-97b2-d6ea3b507ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796ad1929b10>]}
13:00:27.938826 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:00:27.939346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dfddf59-ab8e-4ece-97b2-d6ea3b507ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796ad15da190>]}
13:00:27.941262 [info ] [MainThread]: 
13:00:27.941766 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:00:27.942169 [info ] [MainThread]: 
13:00:27.942847 [debug] [MainThread]: Acquiring new trino connection 'master'
13:00:27.944090 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:00:27.991186 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:00:27.991859 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:00:27.992314 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:00:27.992725 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:00:27.993357 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '8dfddf59-ab8e-4ece-97b2-d6ea3b507ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796ad157edd0>]}
13:00:28.342733 [debug] [ThreadPool]: SQL status: SUCCESS in 0.350 seconds
13:00:28.344668 [debug] [ThreadPool]: On list_iceberg: Close
13:00:28.351330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:00:28.370348 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:00:28.371117 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:00:28.371586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:00:28.556128 [debug] [ThreadPool]: SQL status: SUCCESS in 0.184 seconds
13:00:28.558250 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:00:28.558802 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:00:28.559909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dfddf59-ab8e-4ece-97b2-d6ea3b507ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796ad0323d50>]}
13:00:28.560828 [debug] [MainThread]: On master: COMMIT
13:00:28.563187 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:00:28.563964 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:00:28.564689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:00:28.565234 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:00:28.568238 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:00:28.569051 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:00:28.593258 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:00:28.596851 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:00:28.597595 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.studentid
        -- CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        -- COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        -- COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        -- COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        -- COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        -- COALESCE(sm.SSEX, 'N/A') AS SSEX,
        -- sm.DOB,
        -- sm.ADMDATE,
        -- sm.HOBY,
        -- sm.STATUS,
        -- COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        -- COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        -- COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        -- COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        -- COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        -- COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        -- COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        -- COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        -- COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        -- CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        -- COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        -- COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        -- COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        -- COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        -- ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
--     LEFT JOIN 
--         default.airbyte_raw_studentmain sm 
--         ON sm.STUDENTID = s.STUDENTID 
--     LEFT JOIN 
--         default.airbyte_raw_ayear a 
--         ON a.AYEARID = s.AYEARID 
--     LEFT JOIN 
--         default.airbyte_raw_faculty f 
--         ON s.FACULTYID = f.FACULTYID 
--     LEFT JOIN 
--         default.airbyte_raw_studentclass sc 
--         ON sc.CLASSID = s.CLASSID  -- Update column name here
--     LEFT JOIN 
--         default.airbyte_raw_department d 
--         ON s.DEPARTMENTID = d.DEPARTMENTID 
--     LEFT JOIN 
--         default.airbyte_raw_ayear a 
--         ON a.AYEARID = s.AYEARID 
--     LEFT JOIN 
--         default.airbyte_raw_batch b 
--         ON b.BatchID = sm.BatchID 
--     LEFT JOIN 
--         default.airbyte_raw_ngroup n 
--         ON n.GROUPID = s.GROUPID 
--     LEFT JOIN 
--         default.airbyte_raw_generalstudent g 
--         ON g.STUDENTID = s.STUDENTID 
--     LEFT JOIN 
--         default.airbyte_raw_zone z 
--         ON z.ZONEID = g.ZONEID 
--     LEFT JOIN 
--         default.airbyte_raw_district DIS 
--         ON DIS.DISTRICTID = g.DISTRICTID 
--     LEFT JOIN 
--         default.airbyte_raw_parent PAR 
--         ON PAR.STUDENTID = s.STUDENTID
 )

SELECT 
     studentid
--     fullname, 
--     CLASSNAME, 
--     FACULTYNAME, 
--     DEPARTMENTNAME, 
--     AYEAR,
--     SSEX, 
--     DOB, 
--     ADMDATE, 
--     HOBY, 
--     STATUS, 
--     SCHOOLFROM, 
--     GROUPNAME, 
--     CONTACTADDRESS, 
--     CONTACTPHONE, 
--     PARMANENTADDRESS, 
--     PARMANENTPHONE, 
--     FATHERNAME, 
--     DISTRICTNAME, 
--     ZONENAME,
--     PARENTFULLNAME,
--     PARENTMOBILENO,
--     PARENTEMAIL,
--     PARENTOFFICEPHONENO,
--     PARENTMOBILENO1,
--     'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
   rn = 1
13:00:28.598299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:00:28.768156 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_130028_00114_d8x8s
13:00:28.768936 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 9:9: Column 's.studentid' cannot be resolved", query_id=20241217_130028_00114_d8x8s)
13:00:28.769769 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:00:28.770301 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:00:28.775430 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 9:9: Column 's.studentid' cannot be resolved", query_id=20241217_130028_00114_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:00:28.777819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dfddf59-ab8e-4ece-97b2-d6ea3b507ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796ad18e8190>]}
13:00:28.778717 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.21s]
13:00:28.779514 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:00:28.780346 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 9:9: Column 's.studentid' cannot be resolved", query_id=20241217_130028_00114_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:00:28.782982 [debug] [MainThread]: On master: COMMIT
13:00:28.783686 [debug] [MainThread]: Connection 'master' was properly closed.
13:00:28.784180 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:00:28.784784 [info ] [MainThread]: 
13:00:28.785295 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.84 seconds (0.84s).
13:00:28.786251 [debug] [MainThread]: Command end result
13:00:28.818221 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:00:28.820649 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:00:28.827820 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:00:28.828333 [info ] [MainThread]: 
13:00:28.829006 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:00:28.829573 [info ] [MainThread]: 
13:00:28.830294 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 9:9: Column 's.studentid' cannot be resolved", query_id=20241217_130028_00114_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:00:28.830856 [info ] [MainThread]: 
13:00:28.831430 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:00:28.832797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8834583, "process_in_blocks": "0", "process_kernel_time": 0.332515, "process_mem_max_rss": "109732", "process_out_blocks": "3048", "process_user_time": 2.715044}
13:00:28.833557 [debug] [MainThread]: Command `dbt run` failed at 13:00:28.833425 after 1.88 seconds
13:00:28.834307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796ad1b45590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796ad5a8e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796ad5a8e790>]}
13:00:28.834918 [debug] [MainThread]: Flushing usage events
13:00:28.914327 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:01:02.551460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e8aec3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e8aec3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e8aec2b10>]}


============================== 13:01:02.555558 | d1191a40-5953-4fe0-a694-697166c35bcd ==============================
13:01:02.555558 [info ] [MainThread]: Running with dbt=1.9.1
13:01:02.556336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/jovyan/Internal/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s college_leads', 'send_anonymous_usage_stats': 'True'}
13:01:02.752773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1191a40-5953-4fe0-a694-697166c35bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e8ad23a90>]}
13:01:02.824696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1191a40-5953-4fe0-a694-697166c35bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e8abcdc50>]}
13:01:02.825932 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:01:02.911405 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:01:03.046337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:01:03.047449 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
13:01:03.374542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1191a40-5953-4fe0-a694-697166c35bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e8a7e45d0>]}
13:01:03.476471 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:01:03.480663 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:01:03.491967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1191a40-5953-4fe0-a694-697166c35bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e8aa1f310>]}
13:01:03.492820 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:01:03.493409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1191a40-5953-4fe0-a694-697166c35bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e8a7e4f90>]}
13:01:03.495630 [info ] [MainThread]: 
13:01:03.496177 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:01:03.496598 [info ] [MainThread]: 
13:01:03.497365 [debug] [MainThread]: Acquiring new trino connection 'master'
13:01:03.498793 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:01:03.549838 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:01:03.550556 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:01:03.551052 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:01:03.551453 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:01:03.552146 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'd1191a40-5953-4fe0-a694-697166c35bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e8a67e550>]}
13:01:03.589293 [debug] [ThreadPool]: SQL status: SUCCESS in 0.038 seconds
13:01:03.591412 [debug] [ThreadPool]: On list_iceberg: Close
13:01:03.597999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:01:03.616497 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:01:03.617238 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:01:03.617748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:01:03.695843 [debug] [ThreadPool]: SQL status: SUCCESS in 0.078 seconds
13:01:03.697886 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:01:03.698471 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:01:03.699742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1191a40-5953-4fe0-a694-697166c35bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e8a66ae90>]}
13:01:03.700874 [debug] [MainThread]: On master: COMMIT
13:01:03.704530 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:01:03.705437 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:01:03.706175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:01:03.706721 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:01:03.710037 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:01:03.710941 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:01:03.736135 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:01:03.739700 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:01:03.740501 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.STUDENTID
        -- CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        -- COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        -- COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        -- COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        -- COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        -- COALESCE(sm.SSEX, 'N/A') AS SSEX,
        -- sm.DOB,
        -- sm.ADMDATE,
        -- sm.HOBY,
        -- sm.STATUS,
        -- COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        -- COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        -- COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        -- COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        -- COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        -- COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        -- COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        -- COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        -- COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        -- CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        -- COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        -- COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        -- COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        -- COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        -- ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
--     LEFT JOIN 
--         default.airbyte_raw_studentmain sm 
--         ON sm.STUDENTID = s.STUDENTID 
--     LEFT JOIN 
--         default.airbyte_raw_ayear a 
--         ON a.AYEARID = s.AYEARID 
--     LEFT JOIN 
--         default.airbyte_raw_faculty f 
--         ON s.FACULTYID = f.FACULTYID 
--     LEFT JOIN 
--         default.airbyte_raw_studentclass sc 
--         ON sc.CLASSID = s.CLASSID  -- Update column name here
--     LEFT JOIN 
--         default.airbyte_raw_department d 
--         ON s.DEPARTMENTID = d.DEPARTMENTID 
--     LEFT JOIN 
--         default.airbyte_raw_ayear a 
--         ON a.AYEARID = s.AYEARID 
--     LEFT JOIN 
--         default.airbyte_raw_batch b 
--         ON b.BatchID = sm.BatchID 
--     LEFT JOIN 
--         default.airbyte_raw_ngroup n 
--         ON n.GROUPID = s.GROUPID 
--     LEFT JOIN 
--         default.airbyte_raw_generalstudent g 
--         ON g.STUDENTID = s.STUDENTID 
--     LEFT JOIN 
--         default.airbyte_raw_zone z 
--         ON z.ZONEID = g.ZONEID 
--     LEFT JOIN 
--         default.airbyte_raw_district DIS 
--         ON DIS.DISTRICTID = g.DISTRICTID 
--     LEFT JOIN 
--         default.airbyte_raw_parent PAR 
--         ON PAR.STUDENTID = s.STUDENTID
 )

SELECT 
     studentid
--     fullname, 
--     CLASSNAME, 
--     FACULTYNAME, 
--     DEPARTMENTNAME, 
--     AYEAR,
--     SSEX, 
--     DOB, 
--     ADMDATE, 
--     HOBY, 
--     STATUS, 
--     SCHOOLFROM, 
--     GROUPNAME, 
--     CONTACTADDRESS, 
--     CONTACTPHONE, 
--     PARMANENTADDRESS, 
--     PARMANENTPHONE, 
--     FATHERNAME, 
--     DISTRICTNAME, 
--     ZONENAME,
--     PARENTFULLNAME,
--     PARENTMOBILENO,
--     PARENTEMAIL,
--     PARENTOFFICEPHONENO,
--     PARENTMOBILENO1,
--     'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
   rn = 1
13:01:03.741169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:01:03.787448 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_130103_00117_d8x8s
13:01:03.788235 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 9:9: Column 's.studentid' cannot be resolved", query_id=20241217_130103_00117_d8x8s)
13:01:03.789034 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:01:03.789534 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:01:03.794942 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 9:9: Column 's.studentid' cannot be resolved", query_id=20241217_130103_00117_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:01:03.797440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1191a40-5953-4fe0-a694-697166c35bcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e895cfc50>]}
13:01:03.798576 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.09s]
13:01:03.799391 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:01:03.800161 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 9:9: Column 's.studentid' cannot be resolved", query_id=20241217_130103_00117_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:01:03.802802 [debug] [MainThread]: On master: COMMIT
13:01:03.803712 [debug] [MainThread]: Connection 'master' was properly closed.
13:01:03.804309 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:01:03.804969 [info ] [MainThread]: 
13:01:03.805946 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
13:01:03.807425 [debug] [MainThread]: Command end result
13:01:03.863308 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:01:03.866820 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:01:03.877750 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:01:03.878795 [info ] [MainThread]: 
13:01:03.879862 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:01:03.880733 [info ] [MainThread]: 
13:01:03.881669 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 9:9: Column 's.studentid' cannot be resolved", query_id=20241217_130103_00117_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:01:03.882473 [info ] [MainThread]: 
13:01:03.883324 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:01:03.885215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3939409, "process_in_blocks": "0", "process_kernel_time": 0.267158, "process_mem_max_rss": "109724", "process_out_blocks": "3048", "process_user_time": 2.632558}
13:01:03.886373 [debug] [MainThread]: Command `dbt run` failed at 13:01:03.886193 after 1.40 seconds
13:01:03.887392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e8ed32410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e8ed32510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e8ed323d0>]}
13:01:03.888351 [debug] [MainThread]: Flushing usage events
13:01:03.982983 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:05:03.818846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5de1732d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5de172ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5de172d10>]}


============================== 13:05:03.823082 | 8c6af586-7c15-45c4-a3fb-5bd9e6b67c50 ==============================
13:05:03.823082 [info ] [MainThread]: Running with dbt=1.9.1
13:05:03.823907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/jovyan/Internal', 'log_path': '/home/jovyan/Internal/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s college_leads', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
13:05:04.028026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c6af586-7c15-45c4-a3fb-5bd9e6b67c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5ddde3a50>]}
13:05:04.131506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c6af586-7c15-45c4-a3fb-5bd9e6b67c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5e062ca50>]}
13:05:04.132994 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:05:04.261480 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:05:04.401417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:05:04.402591 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
13:05:04.716565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c6af586-7c15-45c4-a3fb-5bd9e6b67c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5dda0ced0>]}
13:05:04.814341 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:05:04.818477 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:05:04.830371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c6af586-7c15-45c4-a3fb-5bd9e6b67c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5dde1d1d0>]}
13:05:04.831259 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:05:04.831839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c6af586-7c15-45c4-a3fb-5bd9e6b67c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5dda0ed10>]}
13:05:04.833855 [info ] [MainThread]: 
13:05:04.834376 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:05:04.834832 [info ] [MainThread]: 
13:05:04.835539 [debug] [MainThread]: Acquiring new trino connection 'master'
13:05:04.836896 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:05:04.887929 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:05:04.888601 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:05:04.889146 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:05:04.889548 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:05:04.890210 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '8c6af586-7c15-45c4-a3fb-5bd9e6b67c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5dd96df50>]}
13:05:04.931020 [debug] [ThreadPool]: SQL status: SUCCESS in 0.042 seconds
13:05:04.933838 [debug] [ThreadPool]: On list_iceberg: Close
13:05:04.941284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:05:04.960900 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:05:04.961665 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:05:04.962186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:05:05.050867 [debug] [ThreadPool]: SQL status: SUCCESS in 0.089 seconds
13:05:05.052875 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:05:05.053480 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:05:05.054975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c6af586-7c15-45c4-a3fb-5bd9e6b67c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5ddd79e50>]}
13:05:05.055840 [debug] [MainThread]: On master: COMMIT
13:05:05.058208 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:05:05.059017 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:05:05.059748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:05:05.060299 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:05:05.063311 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:05:05.064147 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:05:05.088722 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:05:05.091292 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:05:05.092013 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.STUDENTID,
        ROW_NUMBER() OVER (PARTITION BY s.STUDENTID ORDER BY s.STUDENTID) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
)

SELECT 
    STUDENTID
FROM 
    RankedStudents
WHERE 
    rn = 1
13:05:05.092518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:05:05.127330 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_130505_00120_d8x8s
13:05:05.128407 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 9:9: Column 's.studentid' cannot be resolved", query_id=20241217_130505_00120_d8x8s)
13:05:05.129547 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:05:05.130360 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:05:05.138475 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 9:9: Column 's.studentid' cannot be resolved", query_id=20241217_130505_00120_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:05:05.142065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c6af586-7c15-45c4-a3fb-5bd9e6b67c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5dd93c850>]}
13:05:05.143578 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.08s]
13:05:05.144912 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:05:05.146102 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 9:9: Column 's.studentid' cannot be resolved", query_id=20241217_130505_00120_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:05:05.148882 [debug] [MainThread]: On master: COMMIT
13:05:05.149592 [debug] [MainThread]: Connection 'master' was properly closed.
13:05:05.150136 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:05:05.150641 [info ] [MainThread]: 
13:05:05.151350 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
13:05:05.152706 [debug] [MainThread]: Command end result
13:05:05.182293 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:05:05.184846 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:05:05.192541 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:05:05.193326 [info ] [MainThread]: 
13:05:05.194112 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:05:05.194601 [info ] [MainThread]: 
13:05:05.195183 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 9:9: Column 's.studentid' cannot be resolved", query_id=20241217_130505_00120_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:05:05.195731 [info ] [MainThread]: 
13:05:05.196202 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:05:05.197542 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4404812, "process_in_blocks": "0", "process_kernel_time": 0.349582, "process_mem_max_rss": "109536", "process_out_blocks": "3024", "process_user_time": 2.75271}
13:05:05.198385 [debug] [MainThread]: Command `dbt run` failed at 13:05:05.198242 after 1.44 seconds
13:05:05.199007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5ddfd7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5e1faa550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de5e1faa4d0>]}
13:05:05.199592 [debug] [MainThread]: Flushing usage events
13:05:05.254207 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:05:26.039177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7603457a3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760345ac0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7603457a3b50>]}


============================== 13:05:26.044777 | 569a91eb-2ef9-4baf-8c54-04e3b3fc4524 ==============================
13:05:26.044777 [info ] [MainThread]: Running with dbt=1.9.1
13:05:26.045696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jovyan/Internal/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s college_leads', 'send_anonymous_usage_stats': 'True'}
13:05:26.247087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '569a91eb-2ef9-4baf-8c54-04e3b3fc4524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760345ba6090>]}
13:05:26.327920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '569a91eb-2ef9-4baf-8c54-04e3b3fc4524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760347c48dd0>]}
13:05:26.329046 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:05:26.420646 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:05:26.595342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:05:26.596904 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
13:05:26.932357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '569a91eb-2ef9-4baf-8c54-04e3b3fc4524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76034500f990>]}
13:05:27.033655 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:05:27.038016 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:05:27.049183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '569a91eb-2ef9-4baf-8c54-04e3b3fc4524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76034543f650>]}
13:05:27.050052 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:05:27.050656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '569a91eb-2ef9-4baf-8c54-04e3b3fc4524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76034509bdd0>]}
13:05:27.052684 [info ] [MainThread]: 
13:05:27.053209 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:05:27.053663 [info ] [MainThread]: 
13:05:27.054402 [debug] [MainThread]: Acquiring new trino connection 'master'
13:05:27.055820 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:05:27.105186 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:05:27.105913 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:05:27.106411 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:05:27.106866 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:05:27.107539 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '569a91eb-2ef9-4baf-8c54-04e3b3fc4524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760344f70b90>]}
13:05:27.136543 [debug] [ThreadPool]: SQL status: SUCCESS in 0.030 seconds
13:05:27.138501 [debug] [ThreadPool]: On list_iceberg: Close
13:05:27.145037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:05:27.162727 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:05:27.163351 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:05:27.163832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:05:27.253863 [debug] [ThreadPool]: SQL status: SUCCESS in 0.090 seconds
13:05:27.255739 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:05:27.256283 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:05:27.257367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '569a91eb-2ef9-4baf-8c54-04e3b3fc4524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76034509ac10>]}
13:05:27.258123 [debug] [MainThread]: On master: COMMIT
13:05:27.260198 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:05:27.260982 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:05:27.261708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:05:27.262218 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:05:27.265331 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:05:27.266144 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:05:27.289638 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:05:27.292627 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:05:27.293568 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.STUDENTID::integer,
        ROW_NUMBER() OVER (PARTITION BY s.STUDENTID ORDER BY s.STUDENTID) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
)

SELECT 
    STUDENTID
FROM 
    RankedStudents
WHERE 
    rn = 1
13:05:27.294336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:05:27.307045 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_130527_00123_d8x8s
13:05:27.307734 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 9:20: mismatched input ':'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AS', 'AT', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WHERE', 'WINDOW', '[', '||', <identifier>, <predicate>", query_id=20241217_130527_00123_d8x8s)
13:05:27.308652 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:05:27.309351 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:05:27.315368 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 9:20: mismatched input ':'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AS', 'AT', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WHERE', 'WINDOW', '[', '||', <identifier>, <predicate>", query_id=20241217_130527_00123_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:05:27.317692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '569a91eb-2ef9-4baf-8c54-04e3b3fc4524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7603443ddb50>]}
13:05:27.318581 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.05s]
13:05:27.319376 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:05:27.320385 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 9:20: mismatched input ':'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AS', 'AT', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WHERE', 'WINDOW', '[', '||', <identifier>, <predicate>", query_id=20241217_130527_00123_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:05:27.323147 [debug] [MainThread]: On master: COMMIT
13:05:27.323824 [debug] [MainThread]: Connection 'master' was properly closed.
13:05:27.324240 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:05:27.324706 [info ] [MainThread]: 
13:05:27.325200 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
13:05:27.326107 [debug] [MainThread]: Command end result
13:05:27.370011 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:05:27.372230 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:05:27.378889 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:05:27.379338 [info ] [MainThread]: 
13:05:27.379930 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:05:27.380394 [info ] [MainThread]: 
13:05:27.380945 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 9:20: mismatched input ':'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AS', 'AT', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WHERE', 'WINDOW', '[', '||', <identifier>, <predicate>", query_id=20241217_130527_00123_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:05:27.381378 [info ] [MainThread]: 
13:05:27.381876 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:05:27.383093 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4258147, "process_in_blocks": "0", "process_kernel_time": 0.324005, "process_mem_max_rss": "109084", "process_out_blocks": "3016", "process_user_time": 2.713672}
13:05:27.383897 [debug] [MainThread]: Command `dbt run` failed at 13:05:27.383767 after 1.43 seconds
13:05:27.384590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7603456217d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760345622910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7603495d2350>]}
13:05:27.385157 [debug] [MainThread]: Flushing usage events
13:05:27.422020 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:06:29.423564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bab28eb290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bab2ce95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bab28eb250>]}


============================== 13:06:29.427658 | 87a2613d-a8b7-49c2-bdf2-d4230ef31b30 ==============================
13:06:29.427658 [info ] [MainThread]: Running with dbt=1.9.1
13:06:29.428472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/jovyan/Internal/logs', 'profiles_dir': '/home/jovyan/Internal', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s college_leads', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
13:06:29.627651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87a2613d-a8b7-49c2-bdf2-d4230ef31b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bab26b2910>]}
13:06:29.697498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87a2613d-a8b7-49c2-bdf2-d4230ef31b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bab4dc9310>]}
13:06:29.698637 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:06:29.780964 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:06:29.912876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:06:29.913960 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
13:06:30.232562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87a2613d-a8b7-49c2-bdf2-d4230ef31b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bab24f7150>]}
13:06:30.330073 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:06:30.334206 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:06:30.345325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87a2613d-a8b7-49c2-bdf2-d4230ef31b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bab20b6e50>]}
13:06:30.346183 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:06:30.346761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87a2613d-a8b7-49c2-bdf2-d4230ef31b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bab2500a10>]}
13:06:30.348777 [info ] [MainThread]: 
13:06:30.349291 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:06:30.349766 [info ] [MainThread]: 
13:06:30.350469 [debug] [MainThread]: Acquiring new trino connection 'master'
13:06:30.351844 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:06:30.401755 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:06:30.402503 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:06:30.403019 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:06:30.403424 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:06:30.404220 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '87a2613d-a8b7-49c2-bdf2-d4230ef31b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bab23f6a90>]}
13:06:30.447007 [debug] [ThreadPool]: SQL status: SUCCESS in 0.044 seconds
13:06:30.449036 [debug] [ThreadPool]: On list_iceberg: Close
13:06:30.455567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:06:30.473745 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:06:30.474560 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:06:30.475279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:06:30.558791 [debug] [ThreadPool]: SQL status: SUCCESS in 0.083 seconds
13:06:30.560807 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:06:30.561387 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:06:30.562706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87a2613d-a8b7-49c2-bdf2-d4230ef31b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bab15101d0>]}
13:06:30.563468 [debug] [MainThread]: On master: COMMIT
13:06:30.565799 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:06:30.566555 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:06:30.567328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:06:30.567881 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:06:30.571065 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:06:30.571940 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:06:30.598146 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:06:30.610970 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:06:30.611973 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.STUDENTID::integer,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.CLASSID = s.CLASSID  -- Update column name here
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
 )

SELECT 
     studentid
    fullname, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
   rn = 1
13:06:30.612803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:06:30.624205 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_130630_00126_d8x8s
13:06:30.625081 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 9:20: mismatched input ':'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AS', 'AT', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WHERE', 'WINDOW', '[', '||', <identifier>, <predicate>", query_id=20241217_130630_00126_d8x8s)
13:06:30.625969 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:06:30.626493 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:06:30.632199 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 9:20: mismatched input ':'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AS', 'AT', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WHERE', 'WINDOW', '[', '||', <identifier>, <predicate>", query_id=20241217_130630_00126_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:06:30.634963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a2613d-a8b7-49c2-bdf2-d4230ef31b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bab15ced10>]}
13:06:30.636057 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.07s]
13:06:30.637001 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:06:30.637892 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 9:20: mismatched input ':'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AS', 'AT', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WHERE', 'WINDOW', '[', '||', <identifier>, <predicate>", query_id=20241217_130630_00126_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:06:30.640437 [debug] [MainThread]: On master: COMMIT
13:06:30.641151 [debug] [MainThread]: Connection 'master' was properly closed.
13:06:30.641564 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:06:30.642164 [info ] [MainThread]: 
13:06:30.642739 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
13:06:30.643886 [debug] [MainThread]: Command end result
13:06:30.671958 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:06:30.674396 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:06:30.681361 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:06:30.681963 [info ] [MainThread]: 
13:06:30.682543 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:06:30.683037 [info ] [MainThread]: 
13:06:30.683571 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 9:20: mismatched input ':'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AS', 'AT', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WHERE', 'WINDOW', '[', '||', <identifier>, <predicate>", query_id=20241217_130630_00126_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:06:30.684080 [info ] [MainThread]: 
13:06:30.684540 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:06:30.685818 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3230413, "process_in_blocks": "0", "process_kernel_time": 0.314377, "process_mem_max_rss": "110004", "process_out_blocks": "3040", "process_user_time": 2.540971}
13:06:30.686567 [debug] [MainThread]: Command `dbt run` failed at 13:06:30.686420 after 1.32 seconds
13:06:30.687167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bab2775950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bab2777e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73bab675a3d0>]}
13:06:30.687927 [debug] [MainThread]: Flushing usage events
13:06:30.764733 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:06:48.448791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74447373ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74447373ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74447373ab90>]}


============================== 13:06:48.452712 | 2d64e5aa-01a6-441e-ba28-5616d36d0d03 ==============================
13:06:48.452712 [info ] [MainThread]: Running with dbt=1.9.1
13:06:48.453526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/jovyan/Internal/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s college_leads', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
13:06:48.644913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d64e5aa-01a6-441e-ba28-5616d36d0d03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744473c54290>]}
13:06:48.712433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d64e5aa-01a6-441e-ba28-5616d36d0d03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744475b85690>]}
13:06:48.713635 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:06:48.794244 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:06:48.937918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:06:48.938983 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
13:06:49.272501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d64e5aa-01a6-441e-ba28-5616d36d0d03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744473313290>]}
13:06:49.371136 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:06:49.375233 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:06:49.386698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d64e5aa-01a6-441e-ba28-5616d36d0d03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7444731be710>]}
13:06:49.387510 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:06:49.388093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d64e5aa-01a6-441e-ba28-5616d36d0d03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744473395410>]}
13:06:49.390201 [info ] [MainThread]: 
13:06:49.390725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:06:49.391130 [info ] [MainThread]: 
13:06:49.391819 [debug] [MainThread]: Acquiring new trino connection 'master'
13:06:49.393121 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:06:49.440921 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:06:49.441562 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:06:49.442053 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:06:49.442435 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:06:49.443130 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '2d64e5aa-01a6-441e-ba28-5616d36d0d03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7444731a2b50>]}
13:06:49.472428 [debug] [ThreadPool]: SQL status: SUCCESS in 0.030 seconds
13:06:49.474326 [debug] [ThreadPool]: On list_iceberg: Close
13:06:49.480823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:06:49.498688 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:06:49.499352 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:06:49.499825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:06:49.568402 [debug] [ThreadPool]: SQL status: SUCCESS in 0.068 seconds
13:06:49.570518 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:06:49.571067 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:06:49.572224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d64e5aa-01a6-441e-ba28-5616d36d0d03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74447309eb90>]}
13:06:49.573039 [debug] [MainThread]: On master: COMMIT
13:06:49.575345 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:06:49.576161 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:06:49.576923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:06:49.577585 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:06:49.581002 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:06:49.581819 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:06:49.611914 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:06:49.624136 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:06:49.625059 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.STUDENTID::integer,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.CLASSID = s.CLASSID  -- Update column name here
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
 )

SELECT 
     studentid
    fullname, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
   rn = 1
  
13:06:49.625863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:06:49.635202 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_130649_00129_d8x8s
13:06:49.635864 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 9:20: mismatched input ':'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AS', 'AT', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WHERE', 'WINDOW', '[', '||', <identifier>, <predicate>", query_id=20241217_130649_00129_d8x8s)
13:06:49.636689 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:06:49.637198 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:06:49.642396 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 9:20: mismatched input ':'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AS', 'AT', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WHERE', 'WINDOW', '[', '||', <identifier>, <predicate>", query_id=20241217_130649_00129_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:06:49.644765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d64e5aa-01a6-441e-ba28-5616d36d0d03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7444743ae610>]}
13:06:49.645679 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.07s]
13:06:49.646479 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:06:49.647298 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 9:20: mismatched input ':'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AS', 'AT', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WHERE', 'WINDOW', '[', '||', <identifier>, <predicate>", query_id=20241217_130649_00129_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:06:49.649945 [debug] [MainThread]: On master: COMMIT
13:06:49.650576 [debug] [MainThread]: Connection 'master' was properly closed.
13:06:49.651033 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:06:49.651469 [info ] [MainThread]: 
13:06:49.651969 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
13:06:49.652844 [debug] [MainThread]: Command end result
13:06:49.680265 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:06:49.682516 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:06:49.689359 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:06:49.689893 [info ] [MainThread]: 
13:06:49.690466 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:06:49.690955 [info ] [MainThread]: 
13:06:49.691462 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 9:20: mismatched input ':'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AS', 'AT', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WHERE', 'WINDOW', '[', '||', <identifier>, <predicate>", query_id=20241217_130649_00129_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:06:49.691922 [info ] [MainThread]: 
13:06:49.692364 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:06:49.693611 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.305215, "process_in_blocks": "0", "process_kernel_time": 0.3287, "process_mem_max_rss": "109812", "process_out_blocks": "3032", "process_user_time": 2.558668}
13:06:49.694329 [debug] [MainThread]: Command `dbt run` failed at 13:06:49.694202 after 1.31 seconds
13:06:49.694903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74447376e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744477506510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744477506890>]}
13:06:49.695434 [debug] [MainThread]: Flushing usage events
13:06:49.742685 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:06:59.518810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71053c824ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71053c826f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71053c827f50>]}


============================== 13:06:59.523064 | fc7c19b1-f397-40f0-a44c-988dcb27a561 ==============================
13:06:59.523064 [info ] [MainThread]: Running with dbt=1.9.1
13:06:59.523901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/jovyan/Internal/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
13:06:59.658088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc7c19b1-f397-40f0-a44c-988dcb27a561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71053c7657d0>]}
13:06:59.672222 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21568097, "process_in_blocks": "0", "process_kernel_time": 0.237537, "process_mem_max_rss": "91464", "process_out_blocks": "0", "process_user_time": 1.639805}
13:06:59.673126 [debug] [MainThread]: Command `dbt clean` succeeded at 13:06:59.672968 after 0.22 seconds
13:06:59.673717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71053c826090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71053cc25e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71053c7582d0>]}
13:06:59.674371 [debug] [MainThread]: Flushing usage events
13:06:59.707894 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:07:06.581443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77baf3bcec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77baf3bcfd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77baf3bce910>]}


============================== 13:07:06.587066 | b1d78948-e816-47e9-86b0-723f2367bae4 ==============================
13:07:06.587066 [info ] [MainThread]: Running with dbt=1.9.1
13:07:06.588218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/jovyan/Internal/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s college_leads', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
13:07:06.805744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1d78948-e816-47e9-86b0-723f2367bae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77baf383e5d0>]}
13:07:06.883932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1d78948-e816-47e9-86b0-723f2367bae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77baf6088ed0>]}
13:07:06.885392 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:07:06.993576 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:07:06.994586 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
13:07:06.995216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b1d78948-e816-47e9-86b0-723f2367bae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77baf3cc7290>]}
13:07:08.638535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1d78948-e816-47e9-86b0-723f2367bae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77baf344a6d0>]}
13:07:08.746592 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:07:08.750873 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:07:08.762226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1d78948-e816-47e9-86b0-723f2367bae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77baf34aa750>]}
13:07:08.763025 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:07:08.763587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1d78948-e816-47e9-86b0-723f2367bae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77baf35b2f90>]}
13:07:08.765607 [info ] [MainThread]: 
13:07:08.766124 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:07:08.766525 [info ] [MainThread]: 
13:07:08.767297 [debug] [MainThread]: Acquiring new trino connection 'master'
13:07:08.768610 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:07:08.824037 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:07:08.824848 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:07:08.825327 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:07:08.825782 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:07:08.826552 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'b1d78948-e816-47e9-86b0-723f2367bae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77baf29ca350>]}
13:07:08.871940 [debug] [ThreadPool]: SQL status: SUCCESS in 0.046 seconds
13:07:08.874833 [debug] [ThreadPool]: On list_iceberg: Close
13:07:08.881759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:07:08.901311 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:07:08.902059 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:07:08.902573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:07:08.971344 [debug] [ThreadPool]: SQL status: SUCCESS in 0.069 seconds
13:07:08.973289 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:07:08.973836 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:07:08.974973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1d78948-e816-47e9-86b0-723f2367bae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77baf35cab90>]}
13:07:08.975751 [debug] [MainThread]: On master: COMMIT
13:07:08.978093 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:07:08.978961 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:07:08.979665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:07:08.980184 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:07:08.983389 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:07:08.984280 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:07:09.015072 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:07:09.028176 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:07:09.029152 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.STUDENTID::integer,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.CLASSID = s.CLASSID  -- Update column name here
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
 )

SELECT 
     studentid
    fullname, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
   rn = 1
  
13:07:09.029864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:07:09.038722 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_130709_00132_d8x8s
13:07:09.039314 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 9:20: mismatched input ':'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AS', 'AT', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WHERE', 'WINDOW', '[', '||', <identifier>, <predicate>", query_id=20241217_130709_00132_d8x8s)
13:07:09.040112 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:07:09.040598 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:07:09.045908 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 9:20: mismatched input ':'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AS', 'AT', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WHERE', 'WINDOW', '[', '||', <identifier>, <predicate>", query_id=20241217_130709_00132_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:07:09.048288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1d78948-e816-47e9-86b0-723f2367bae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77baf345ce50>]}
13:07:09.049200 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.07s]
13:07:09.050017 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:07:09.050902 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 9:20: mismatched input ':'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AS', 'AT', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WHERE', 'WINDOW', '[', '||', <identifier>, <predicate>", query_id=20241217_130709_00132_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:07:09.053393 [debug] [MainThread]: On master: COMMIT
13:07:09.054056 [debug] [MainThread]: Connection 'master' was properly closed.
13:07:09.054491 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:07:09.054991 [info ] [MainThread]: 
13:07:09.055473 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
13:07:09.056451 [debug] [MainThread]: Command end result
13:07:09.087383 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:07:09.092388 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:07:09.099214 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:07:09.099760 [info ] [MainThread]: 
13:07:09.100350 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:07:09.100842 [info ] [MainThread]: 
13:07:09.101470 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 9:20: mismatched input ':'. Expecting: '%', ')', '*', '+', ',', '-', '.', '/', 'AND', 'AS', 'AT', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', 'WHERE', 'WINDOW', '[', '||', <identifier>, <predicate>", query_id=20241217_130709_00132_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:07:09.102066 [info ] [MainThread]: 
13:07:09.102600 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:07:09.103820 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5949988, "process_in_blocks": "0", "process_kernel_time": 0.277638, "process_mem_max_rss": "110664", "process_out_blocks": "3032", "process_user_time": 3.869962}
13:07:09.104754 [debug] [MainThread]: Command `dbt run` failed at 13:07:09.104569 after 2.60 seconds
13:07:09.105325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77baf48af3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77baf7a0e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77baf3bd2b90>]}
13:07:09.105881 [debug] [MainThread]: Flushing usage events
13:07:09.249101 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:08:07.411055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7861770a9110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786176f9afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786176f9b1d0>]}


============================== 13:08:07.416004 | 974bcfc7-bcb1-4972-905c-df17db5409df ==============================
13:08:07.416004 [info ] [MainThread]: Running with dbt=1.9.1
13:08:07.416894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jovyan/Internal/logs', 'profiles_dir': '/home/jovyan/Internal', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s college_leads', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
13:08:07.619600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '974bcfc7-bcb1-4972-905c-df17db5409df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786176e23fd0>]}
13:08:07.688589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '974bcfc7-bcb1-4972-905c-df17db5409df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7861793c8f10>]}
13:08:07.689762 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:08:07.774510 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:08:07.923079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:08:07.924199 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
13:08:08.236317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '974bcfc7-bcb1-4972-905c-df17db5409df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7861768bd1d0>]}
13:08:08.330802 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:08:08.334870 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:08:08.345890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '974bcfc7-bcb1-4972-905c-df17db5409df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78617676a6d0>]}
13:08:08.346738 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:08:08.347331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '974bcfc7-bcb1-4972-905c-df17db5409df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7861767740d0>]}
13:08:08.349389 [info ] [MainThread]: 
13:08:08.349963 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:08:08.350374 [info ] [MainThread]: 
13:08:08.351123 [debug] [MainThread]: Acquiring new trino connection 'master'
13:08:08.352486 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:08:08.404816 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:08:08.405558 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:08:08.406096 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:08:08.406538 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:08:08.407214 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '974bcfc7-bcb1-4972-905c-df17db5409df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786176773990>]}
13:08:08.445231 [debug] [ThreadPool]: SQL status: SUCCESS in 0.039 seconds
13:08:08.447288 [debug] [ThreadPool]: On list_iceberg: Close
13:08:08.454891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:08:08.475883 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:08:08.476579 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:08:08.477098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:08:08.548829 [debug] [ThreadPool]: SQL status: SUCCESS in 0.072 seconds
13:08:08.550827 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:08:08.551422 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:08:08.552674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '974bcfc7-bcb1-4972-905c-df17db5409df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78617673f250>]}
13:08:08.553454 [debug] [MainThread]: On master: COMMIT
13:08:08.555809 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:08:08.556548 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:08:08.557225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:08:08.557760 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:08:08.561071 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:08:08.561887 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:08:08.585796 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:08:08.597665 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:08:08.598515 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.STUDENTID,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.CLASSID = s.CLASSID  
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
 )

SELECT 
     studentid
    fullname, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
   rn = 1
  
13:08:08.599180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:08:08.657068 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_130808_00135_d8x8s
13:08:08.657939 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sm.studentid' cannot be resolved", query_id=20241217_130808_00135_d8x8s)
13:08:08.658759 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:08:08.659252 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:08:08.664527 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sm.studentid' cannot be resolved", query_id=20241217_130808_00135_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:08:08.667023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '974bcfc7-bcb1-4972-905c-df17db5409df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78617514bed0>]}
13:08:08.667999 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.11s]
13:08:08.668796 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:08:08.669609 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sm.studentid' cannot be resolved", query_id=20241217_130808_00135_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:08:08.672118 [debug] [MainThread]: On master: COMMIT
13:08:08.672806 [debug] [MainThread]: Connection 'master' was properly closed.
13:08:08.673238 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:08:08.673722 [info ] [MainThread]: 
13:08:08.674296 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
13:08:08.675191 [debug] [MainThread]: Command end result
13:08:08.702149 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:08:08.704317 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:08:08.710944 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:08:08.711408 [info ] [MainThread]: 
13:08:08.711967 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:08:08.712415 [info ] [MainThread]: 
13:08:08.712947 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sm.studentid' cannot be resolved", query_id=20241217_130808_00135_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:08:08.713368 [info ] [MainThread]: 
13:08:08.713829 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:08:08.714988 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3644487, "process_in_blocks": "0", "process_kernel_time": 0.332771, "process_mem_max_rss": "109228", "process_out_blocks": "3048", "process_user_time": 2.632282}
13:08:08.715706 [debug] [MainThread]: Command `dbt run` failed at 13:08:08.715552 after 1.37 seconds
13:08:08.716261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786176e20190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786176e22490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78617ad46a10>]}
13:08:08.716800 [debug] [MainThread]: Flushing usage events
13:08:08.791680 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:10:31.505843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee335eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee31b3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee3362d10>]}


============================== 13:10:31.510557 | a72c0489-0db3-4d0b-af32-194d6cbd9589 ==============================
13:10:31.510557 [info ] [MainThread]: Running with dbt=1.9.1
13:10:31.511449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/jovyan/Internal/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s college_leads', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
13:10:31.709374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a72c0489-0db3-4d0b-af32-194d6cbd9589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee389f190>]}
13:10:31.782142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a72c0489-0db3-4d0b-af32-194d6cbd9589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee5814810>]}
13:10:31.783276 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:10:31.863338 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:10:31.989000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:10:31.990069 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
13:10:32.314163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a72c0489-0db3-4d0b-af32-194d6cbd9589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee3042b90>]}
13:10:32.413211 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:10:32.417384 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:10:32.428842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a72c0489-0db3-4d0b-af32-194d6cbd9589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee302d890>]}
13:10:32.430000 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:10:32.430856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a72c0489-0db3-4d0b-af32-194d6cbd9589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee2b61850>]}
13:10:32.433221 [info ] [MainThread]: 
13:10:32.433789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:10:32.434250 [info ] [MainThread]: 
13:10:32.434981 [debug] [MainThread]: Acquiring new trino connection 'master'
13:10:32.436312 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:10:32.485638 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:10:32.486324 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:10:32.486838 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:10:32.487251 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:10:32.487890 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'a72c0489-0db3-4d0b-af32-194d6cbd9589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee2743b10>]}
13:10:32.529683 [debug] [ThreadPool]: SQL status: SUCCESS in 0.043 seconds
13:10:32.531646 [debug] [ThreadPool]: On list_iceberg: Close
13:10:32.538859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:10:32.557597 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:10:32.558270 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:10:32.558823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:10:32.624107 [debug] [ThreadPool]: SQL status: SUCCESS in 0.065 seconds
13:10:32.626012 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:10:32.626545 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:10:32.627767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a72c0489-0db3-4d0b-af32-194d6cbd9589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee2c1cb50>]}
13:10:32.628513 [debug] [MainThread]: On master: COMMIT
13:10:32.630862 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:10:32.631710 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:10:32.632414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:10:32.633012 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:10:32.636038 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:10:32.636882 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:10:32.662276 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:10:32.674392 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:10:32.675352 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.STUDENTID,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    LEFT JOIN 
        default.airbyte_raw_studentmain sm 
        ON sm.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.CLASSID = s.CLASSID  
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
 )

SELECT 
    studentid,
    fullname, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
   rn = 1
  
13:10:32.676031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:10:32.727877 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_131032_00138_d8x8s
13:10:32.728674 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sm.studentid' cannot be resolved", query_id=20241217_131032_00138_d8x8s)
13:10:32.729479 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:10:32.730097 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:10:32.735271 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sm.studentid' cannot be resolved", query_id=20241217_131032_00138_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:10:32.737715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a72c0489-0db3-4d0b-af32-194d6cbd9589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee1571e10>]}
13:10:32.738608 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.10s]
13:10:32.739435 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:10:32.740252 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sm.studentid' cannot be resolved", query_id=20241217_131032_00138_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:10:32.742708 [debug] [MainThread]: On master: COMMIT
13:10:32.743314 [debug] [MainThread]: Connection 'master' was properly closed.
13:10:32.743743 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:10:32.744172 [info ] [MainThread]: 
13:10:32.744774 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
13:10:32.745881 [debug] [MainThread]: Command end result
13:10:32.773943 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:10:32.776171 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:10:32.782954 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:10:32.783447 [info ] [MainThread]: 
13:10:32.784014 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:10:32.784499 [info ] [MainThread]: 
13:10:32.785029 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sm.studentid' cannot be resolved", query_id=20241217_131032_00138_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:10:32.785448 [info ] [MainThread]: 
13:10:32.786029 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:10:32.787251 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3435245, "process_in_blocks": "0", "process_kernel_time": 0.296498, "process_mem_max_rss": "109644", "process_out_blocks": "3048", "process_user_time": 2.521738}
13:10:32.787971 [debug] [MainThread]: Command `dbt run` failed at 13:10:32.787829 after 1.34 seconds
13:10:32.788516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee72fd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee719e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727ee3043b90>]}
13:10:32.789086 [debug] [MainThread]: Flushing usage events
13:10:32.841430 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:11:32.632331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e6b90fddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e6b90ff010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e6b90feed0>]}


============================== 13:11:32.636575 | f60ba984-b267-424d-a830-7c6e46294ab4 ==============================
13:11:32.636575 [info ] [MainThread]: Running with dbt=1.9.1
13:11:32.637429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/jovyan/Internal/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
13:11:32.759127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f60ba984-b267-424d-a830-7c6e46294ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e6b90fd750>]}
13:11:32.772374 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19976082, "process_in_blocks": "0", "process_kernel_time": 0.229504, "process_mem_max_rss": "92000", "process_out_blocks": "8", "process_user_time": 1.60254}
13:11:32.773156 [debug] [MainThread]: Command `dbt clean` succeeded at 13:11:32.773020 after 0.20 seconds
13:11:32.773753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e6b8f73fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e6bcd97d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e6bcf39750>]}
13:11:32.774354 [debug] [MainThread]: Flushing usage events
13:11:32.828314 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:11:42.044349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ca725b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ca725ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ca725b3d0>]}


============================== 13:11:42.048527 | 47e769ab-c44a-44d8-8650-b0e8ed5fba98 ==============================
13:11:42.048527 [info ] [MainThread]: Running with dbt=1.9.1
13:11:42.049465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/jovyan/Internal/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s college_leads', 'send_anonymous_usage_stats': 'True'}
13:11:42.249794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47e769ab-c44a-44d8-8650-b0e8ed5fba98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ca725ad50>]}
13:11:42.323182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47e769ab-c44a-44d8-8650-b0e8ed5fba98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ca9684ed0>]}
13:11:42.324531 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:11:42.406203 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:11:42.407154 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
13:11:42.407730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '47e769ab-c44a-44d8-8650-b0e8ed5fba98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ca6e605d0>]}
13:11:43.941038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47e769ab-c44a-44d8-8650-b0e8ed5fba98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ca6ad29d0>]}
13:11:44.051221 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:11:44.055432 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:11:44.067550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47e769ab-c44a-44d8-8650-b0e8ed5fba98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ca8771490>]}
13:11:44.068391 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:11:44.068986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47e769ab-c44a-44d8-8650-b0e8ed5fba98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ca871ce50>]}
13:11:44.071060 [info ] [MainThread]: 
13:11:44.071564 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:11:44.071996 [info ] [MainThread]: 
13:11:44.072683 [debug] [MainThread]: Acquiring new trino connection 'master'
13:11:44.073984 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:11:44.124607 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:11:44.125279 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:11:44.125749 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:11:44.126138 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:11:44.126828 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '47e769ab-c44a-44d8-8650-b0e8ed5fba98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ca7099050>]}
13:11:44.168556 [debug] [ThreadPool]: SQL status: SUCCESS in 0.043 seconds
13:11:44.170709 [debug] [ThreadPool]: On list_iceberg: Close
13:11:44.177849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:11:44.195453 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:11:44.196165 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:11:44.196647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:11:44.267093 [debug] [ThreadPool]: SQL status: SUCCESS in 0.070 seconds
13:11:44.269006 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:11:44.269532 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:11:44.270689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47e769ab-c44a-44d8-8650-b0e8ed5fba98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ca6bb33d0>]}
13:11:44.271501 [debug] [MainThread]: On master: COMMIT
13:11:44.274177 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:11:44.275033 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:11:44.275798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:11:44.276337 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:11:44.279535 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:11:44.280422 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:11:44.306014 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:11:44.317647 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:11:44.318501 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    WITH RankedStudents AS (
    SELECT DISTINCT
        s.STUDENTID,
        CONCAT(COALESCE(sm.FIRSTNAME, ''), ' ', COALESCE(sm.LASTNAME, '')) AS fullname,
        COALESCE(sc.CLASSNAME, 'N/A') AS CLASSNAME,
        COALESCE(f.FACULTYNAME, 'N/A') AS FACULTYNAME,
        COALESCE(d.DEPARTMENTNAME, 'N/A') AS DEPARTMENTNAME,
        COALESCE(a.AYEAR, 'N/A') AS AYEAR,
        COALESCE(sm.SSEX, 'N/A') AS SSEX,
        sm.DOB,
        sm.ADMDATE,
        sm.HOBY,
        sm.STATUS,
        COALESCE(g.SCHOOLFROM, 'N/A') AS SCHOOLFROM,
        COALESCE(n.GROUPNAME, 'N/A') AS GROUPNAME,
        COALESCE(g.CONTACTADDRESS, 'N/A') AS CONTACTADDRESS,
        COALESCE(g.CONTACTPHONE, 'N/A') AS CONTACTPHONE,
        COALESCE(g.PARMANENTADDRESS, 'N/A') AS PARMANENTADDRESS,
        COALESCE(g.PARMANENTPHONE, 'N/A') AS PARMANENTPHONE,
        COALESCE(g.FATHERNAME, 'N/A') AS FATHERNAME,
        COALESCE(DIS.DISTRICTNAME, 'N/A') AS DISTRICTNAME,
        COALESCE(z.ZONENAME, 'N/A') AS ZONENAME,
        CONCAT(COALESCE(PAR.PFIRSTNAME, ''), ' ', COALESCE(PAR.PLASTNAME, '')) AS PARENTFULLNAME,
        COALESCE(PAR.mobileno, 'N/A') AS PARENTMOBILENO,
        COALESCE(PAR.EMAIL, 'N/A') AS PARENTEMAIL,
        COALESCE(PAR.PHONEO, 'N/A') AS PARENTOFFICEPHONENO,
        COALESCE(PAR.MOBILE, 'N/A') AS PARENTMOBILENO1,
        ROW_NUMBER() OVER (PARTITION BY s.studentid ORDER BY a.AYEARID DESC) AS rn
    FROM 
        default.airbyte_raw_studentdetail s
    LEFT JOIN 
        default.airbyte_raw_studentmain SM
        ON SM.STUDENTID = S.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_faculty f 
        ON s.FACULTYID = f.FACULTYID 
    LEFT JOIN 
        default.airbyte_raw_studentclass sc 
        ON sc.CLASSID = s.CLASSID  
    LEFT JOIN 
        default.airbyte_raw_department d 
        ON s.DEPARTMENTID = d.DEPARTMENTID 
    LEFT JOIN 
        default.airbyte_raw_ayear a 
        ON a.AYEARID = s.AYEARID 
    LEFT JOIN 
        default.airbyte_raw_batch b 
        ON b.BatchID = sm.BatchID 
    LEFT JOIN 
        default.airbyte_raw_ngroup n 
        ON n.GROUPID = s.GROUPID 
    LEFT JOIN 
        default.airbyte_raw_generalstudent g 
        ON g.STUDENTID = s.STUDENTID 
    LEFT JOIN 
        default.airbyte_raw_zone z 
        ON z.ZONEID = g.ZONEID 
    LEFT JOIN 
        default.airbyte_raw_district DIS 
        ON DIS.DISTRICTID = g.DISTRICTID 
    LEFT JOIN 
        default.airbyte_raw_parent PAR 
        ON PAR.STUDENTID = s.STUDENTID
 )

SELECT 
    studentid,
    fullname, 
    CLASSNAME, 
    FACULTYNAME, 
    DEPARTMENTNAME, 
    AYEAR,
    SSEX, 
    DOB, 
    ADMDATE, 
    HOBY, 
    STATUS, 
    SCHOOLFROM, 
    GROUPNAME, 
    CONTACTADDRESS, 
    CONTACTPHONE, 
    PARMANENTADDRESS, 
    PARMANENTPHONE, 
    FATHERNAME, 
    DISTRICTNAME, 
    ZONENAME,
    PARENTFULLNAME,
    PARENTMOBILENO,
    PARENTEMAIL,
    PARENTOFFICEPHONENO,
    PARENTMOBILENO1,
    'UNIGLOBE COLLEGE' AS organization
FROM 
    RankedStudents
WHERE 
   rn = 1
  
13:11:44.319200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:11:44.386132 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_131144_00141_d8x8s
13:11:44.386909 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sm.studentid' cannot be resolved", query_id=20241217_131144_00141_d8x8s)
13:11:44.387719 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:11:44.388225 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:11:44.395955 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sm.studentid' cannot be resolved", query_id=20241217_131144_00141_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:11:44.398903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e769ab-c44a-44d8-8650-b0e8ed5fba98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ca6733b10>]}
13:11:44.400009 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.12s]
13:11:44.400888 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:11:44.401795 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sm.studentid' cannot be resolved", query_id=20241217_131144_00141_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:11:44.404363 [debug] [MainThread]: On master: COMMIT
13:11:44.405063 [debug] [MainThread]: Connection 'master' was properly closed.
13:11:44.405500 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:11:44.406064 [info ] [MainThread]: 
13:11:44.406589 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
13:11:44.407556 [debug] [MainThread]: Command end result
13:11:44.440239 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:11:44.444712 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:11:44.451455 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:11:44.451990 [info ] [MainThread]: 
13:11:44.452628 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:11:44.453142 [info ] [MainThread]: 
13:11:44.453699 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 39:12: Column 'sm.studentid' cannot be resolved", query_id=20241217_131144_00141_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:11:44.454157 [info ] [MainThread]: 
13:11:44.454657 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:11:44.455907 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4799366, "process_in_blocks": "0", "process_kernel_time": 0.315835, "process_mem_max_rss": "110460", "process_out_blocks": "3024", "process_user_time": 3.633106}
13:11:44.456654 [debug] [MainThread]: Command `dbt run` failed at 13:11:44.456504 after 2.48 seconds
13:11:44.457243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ca70bd0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8cab006510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8cab006890>]}
13:11:44.457787 [debug] [MainThread]: Flushing usage events
13:11:44.494074 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:17:05.047379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8c162df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8c1b478d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8c162ffd0>]}


============================== 13:17:05.052315 | 6bb5bff8-1344-4cce-b1ab-b0718a85bb0b ==============================
13:17:05.052315 [info ] [MainThread]: Running with dbt=1.9.1
13:17:05.053130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/jovyan/Internal', 'log_path': '/home/jovyan/Internal/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
13:17:05.187068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bb5bff8-1344-4cce-b1ab-b0718a85bb0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8c1536190>]}
13:17:05.201032 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21586727, "process_in_blocks": "0", "process_kernel_time": 0.204536, "process_mem_max_rss": "91912", "process_out_blocks": "16", "process_user_time": 1.682185}
13:17:05.201810 [debug] [MainThread]: Command `dbt clean` succeeded at 13:17:05.201666 after 0.22 seconds
13:17:05.202347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8c165e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8c165f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e8c5323e10>]}
13:17:05.202936 [debug] [MainThread]: Flushing usage events
13:17:05.274595 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:17:09.714580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03ce4aa790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03cf1aef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03ce4abf10>]}


============================== 13:17:09.718509 | 6026df35-5750-4c1c-991a-1ba14bfebd49 ==============================
13:17:09.718509 [info ] [MainThread]: Running with dbt=1.9.1
13:17:09.719325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/jovyan/Internal/logs', 'profiles_dir': '/home/jovyan/Internal', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s college_leads', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
13:17:09.918374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6026df35-5750-4c1c-991a-1ba14bfebd49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03ce30a450>]}
13:17:09.987344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6026df35-5750-4c1c-991a-1ba14bfebd49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03d09896d0>]}
13:17:09.988581 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:17:10.072828 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:17:10.073865 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
13:17:10.074490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6026df35-5750-4c1c-991a-1ba14bfebd49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03ce14c4d0>]}
13:17:11.623960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6026df35-5750-4c1c-991a-1ba14bfebd49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03cded2850>]}
13:17:11.724612 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:17:11.729087 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:17:11.742320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6026df35-5750-4c1c-991a-1ba14bfebd49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03cdd46e90>]}
13:17:11.743355 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:17:11.743936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6026df35-5750-4c1c-991a-1ba14bfebd49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03cdcbaa90>]}
13:17:11.746219 [info ] [MainThread]: 
13:17:11.746898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:17:11.747400 [info ] [MainThread]: 
13:17:11.748148 [debug] [MainThread]: Acquiring new trino connection 'master'
13:17:11.749488 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:17:11.801635 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:17:11.802439 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:17:11.803130 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:17:11.803779 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:17:11.804720 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '6026df35-5750-4c1c-991a-1ba14bfebd49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03cd92c910>]}
13:17:11.867445 [debug] [ThreadPool]: SQL status: SUCCESS in 0.064 seconds
13:17:11.869459 [debug] [ThreadPool]: On list_iceberg: Close
13:17:11.876033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:17:11.893320 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:17:11.894167 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:17:11.894728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:17:11.966632 [debug] [ThreadPool]: SQL status: SUCCESS in 0.072 seconds
13:17:11.968529 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:17:11.969095 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:17:11.970274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6026df35-5750-4c1c-991a-1ba14bfebd49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03cdca64d0>]}
13:17:11.971010 [debug] [MainThread]: On master: COMMIT
13:17:11.973235 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:17:11.974049 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:17:11.974733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:17:11.975255 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:17:11.978208 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:17:11.979083 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:17:12.006138 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:17:12.008752 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:17:12.009493 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    SELECT 
    s.STUDENTID, 
    sm.FIRSTNAME, 
    sm.LASTNAME
FROM 
    default.airbyte_raw_studentdetail s
LEFT JOIN 
    default.airbyte_raw_studentmain sm 
    ON sm.STUDENTID = s.STUDENTID 
LIMIT 5
  
13:17:12.010137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:17:12.071564 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_131712_00144_d8x8s
13:17:12.072723 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'sm.studentid' cannot be resolved", query_id=20241217_131712_00144_d8x8s)
13:17:12.074071 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:17:12.074878 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:17:12.083871 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'sm.studentid' cannot be resolved", query_id=20241217_131712_00144_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:17:12.087752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6026df35-5750-4c1c-991a-1ba14bfebd49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03cd5d1bd0>]}
13:17:12.089387 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.11s]
13:17:12.090776 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:17:12.091866 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'sm.studentid' cannot be resolved", query_id=20241217_131712_00144_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:17:12.094550 [debug] [MainThread]: On master: COMMIT
13:17:12.095216 [debug] [MainThread]: Connection 'master' was properly closed.
13:17:12.095681 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:17:12.096168 [info ] [MainThread]: 
13:17:12.096731 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
13:17:12.097788 [debug] [MainThread]: Command end result
13:17:12.130648 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:17:12.135395 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:17:12.142364 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:17:12.142976 [info ] [MainThread]: 
13:17:12.143583 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:17:12.144248 [info ] [MainThread]: 
13:17:12.144877 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'sm.studentid' cannot be resolved", query_id=20241217_131712_00144_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:17:12.145350 [info ] [MainThread]: 
13:17:12.145890 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:17:12.147221 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4916506, "process_in_blocks": "0", "process_kernel_time": 0.289534, "process_mem_max_rss": "110604", "process_out_blocks": "3008", "process_user_time": 3.665112}
13:17:12.147974 [debug] [MainThread]: Command `dbt run` failed at 13:17:12.147842 after 2.49 seconds
13:17:12.148590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03d231a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03d231a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03ce4ad9d0>]}
13:17:12.149180 [debug] [MainThread]: Flushing usage events
13:17:12.181692 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:17:55.189033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccea4322bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccea4362690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccea4323f90>]}


============================== 13:17:55.193066 | b4a5ef62-603f-4198-977b-415dcdb08adb ==============================
13:17:55.193066 [info ] [MainThread]: Running with dbt=1.9.1
13:17:55.193863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/jovyan/Internal/logs', 'fail_fast': 'False', 'profiles_dir': '/home/jovyan/Internal', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s college_leads', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
13:17:55.392226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4a5ef62-603f-4198-977b-415dcdb08adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccea4118b50>]}
13:17:55.472078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4a5ef62-603f-4198-977b-415dcdb08adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccea50e4f50>]}
13:17:55.473238 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:17:55.554276 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:17:55.687844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:17:55.688936 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
13:17:56.009053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4a5ef62-603f-4198-977b-415dcdb08adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccea3f37910>]}
13:17:56.107492 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:17:56.111609 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:17:56.122951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4a5ef62-603f-4198-977b-415dcdb08adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccea3ba1950>]}
13:17:56.123802 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:17:56.124357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4a5ef62-603f-4198-977b-415dcdb08adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccea415f310>]}
13:17:56.126458 [info ] [MainThread]: 
13:17:56.126990 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:17:56.127406 [info ] [MainThread]: 
13:17:56.128138 [debug] [MainThread]: Acquiring new trino connection 'master'
13:17:56.129484 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:17:56.178351 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:17:56.179031 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:17:56.179501 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:17:56.179990 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:17:56.180905 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'b4a5ef62-603f-4198-977b-415dcdb08adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccea3bb2190>]}
13:17:56.221507 [debug] [ThreadPool]: SQL status: SUCCESS in 0.042 seconds
13:17:56.223552 [debug] [ThreadPool]: On list_iceberg: Close
13:17:56.230306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:17:56.249604 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:17:56.250269 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:17:56.250837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:17:56.321094 [debug] [ThreadPool]: SQL status: SUCCESS in 0.070 seconds
13:17:56.323465 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:17:56.324065 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:17:56.325240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4a5ef62-603f-4198-977b-415dcdb08adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccea3c0ae50>]}
13:17:56.326229 [debug] [MainThread]: On master: COMMIT
13:17:56.328760 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:17:56.329562 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:17:56.330342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:17:56.330930 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:17:56.334089 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:17:56.334959 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:17:56.359682 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:17:56.361918 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:17:56.362533 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    SELECT 
    s.STUDENTID, 
    sm.FIRSTNAME, 
    sm.LASTNAME
FROM 
    iceberg.default.airbyte_raw_studentdetail s
LEFT JOIN 
    iceberg.default.airbyte_raw_studentmain sm 
    ON sm.STUDENTID = s.STUDENTID 
LIMIT 5
  
13:17:56.363050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:17:56.411850 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_131756_00147_d8x8s
13:17:56.412587 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'sm.studentid' cannot be resolved", query_id=20241217_131756_00147_d8x8s)
13:17:56.413442 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:17:56.413961 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:17:56.419146 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'sm.studentid' cannot be resolved", query_id=20241217_131756_00147_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:17:56.421527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4a5ef62-603f-4198-977b-415dcdb08adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccea281a010>]}
13:17:56.422491 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.09s]
13:17:56.423279 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:17:56.424090 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'sm.studentid' cannot be resolved", query_id=20241217_131756_00147_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:17:56.426529 [debug] [MainThread]: On master: COMMIT
13:17:56.427196 [debug] [MainThread]: Connection 'master' was properly closed.
13:17:56.427647 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:17:56.428131 [info ] [MainThread]: 
13:17:56.428652 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
13:17:56.429629 [debug] [MainThread]: Command end result
13:17:56.457657 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:17:56.460012 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:17:56.467059 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:17:56.467577 [info ] [MainThread]: 
13:17:56.468166 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:17:56.468696 [info ] [MainThread]: 
13:17:56.469225 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'sm.studentid' cannot be resolved", query_id=20241217_131756_00147_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:17:56.469741 [info ] [MainThread]: 
13:17:56.470200 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:17:56.471410 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3429974, "process_in_blocks": "0", "process_kernel_time": 0.323097, "process_mem_max_rss": "109788", "process_out_blocks": "3024", "process_user_time": 2.593758}
13:17:56.472146 [debug] [MainThread]: Command `dbt run` failed at 13:17:56.472014 after 1.34 seconds
13:17:56.472722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccea41affd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccea41add10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccea8166350>]}
13:17:56.473282 [debug] [MainThread]: Flushing usage events
13:17:56.562023 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:22:51.947266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75457553f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754575393710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754575393d50>]}


============================== 13:22:51.951134 | 31361283-f5b7-4ce4-942d-d619d18381ca ==============================
13:22:51.951134 [info ] [MainThread]: Running with dbt=1.9.1
13:22:51.951888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/jovyan/Internal/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
13:22:52.084921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31361283-f5b7-4ce4-942d-d619d18381ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7545753938d0>]}
13:22:52.098081 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20959638, "process_in_blocks": "0", "process_kernel_time": 0.2435, "process_mem_max_rss": "91908", "process_out_blocks": "16", "process_user_time": 1.561795}
13:22:52.098884 [debug] [MainThread]: Command `dbt clean` succeeded at 13:22:52.098739 after 0.21 seconds
13:22:52.099426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754575372910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754575420910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7545791d3d90>]}
13:22:52.100078 [debug] [MainThread]: Flushing usage events
13:22:52.168643 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:22:57.458004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8648e7bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff864897950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8648972d0>]}


============================== 13:22:57.462349 | bdfb0212-b357-42ad-b063-ca3ab64d2589 ==============================
13:22:57.462349 [info ] [MainThread]: Running with dbt=1.9.1
13:22:57.463150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/jovyan/Internal/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s college_leads', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
13:22:57.670345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdfb0212-b357-42ad-b063-ca3ab64d2589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86466d6d0>]}
13:22:57.745163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdfb0212-b357-42ad-b063-ca3ab64d2589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff866d5ce10>]}
13:22:57.746444 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:22:57.834548 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:22:57.835583 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
13:22:57.836236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bdfb0212-b357-42ad-b063-ca3ab64d2589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8646fecd0>]}
13:22:59.451593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdfb0212-b357-42ad-b063-ca3ab64d2589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff863d47390>]}
13:22:59.561059 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:22:59.565498 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:22:59.578093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdfb0212-b357-42ad-b063-ca3ab64d2589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff863dbf0d0>]}
13:22:59.579097 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:22:59.579690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdfb0212-b357-42ad-b063-ca3ab64d2589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff868839910>]}
13:22:59.582044 [info ] [MainThread]: 
13:22:59.582582 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:22:59.583034 [info ] [MainThread]: 
13:22:59.583761 [debug] [MainThread]: Acquiring new trino connection 'master'
13:22:59.585113 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:22:59.663256 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:22:59.663990 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:22:59.664467 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:22:59.664950 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:22:59.665632 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'bdfb0212-b357-42ad-b063-ca3ab64d2589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff864507a90>]}
13:22:59.709373 [debug] [ThreadPool]: SQL status: SUCCESS in 0.045 seconds
13:22:59.712264 [debug] [ThreadPool]: On list_iceberg: Close
13:22:59.719654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:22:59.737990 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:22:59.738676 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:22:59.739211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:22:59.820421 [debug] [ThreadPool]: SQL status: SUCCESS in 0.081 seconds
13:22:59.822444 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:22:59.823062 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:22:59.824233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdfb0212-b357-42ad-b063-ca3ab64d2589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86413f150>]}
13:22:59.825043 [debug] [MainThread]: On master: COMMIT
13:22:59.827256 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:22:59.828063 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:22:59.828848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:22:59.829379 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:22:59.832441 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:22:59.833450 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:22:59.860496 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:22:59.862654 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:22:59.863294 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    SELECT 
    airbyte_raw_studentdetail.STUDENTID, 
    airbyte_raw_studentmain.FIRSTNAME, 
    airbyte_raw_studentmain.LASTNAME
FROM 
    default.airbyte_raw_studentdetail 
LEFT JOIN 
    default.airbyte_raw_studentmain 
    ON airbyte_raw_studentdetail.STUDENTID = airbyte_raw_studentmain.STUDENTID 
LIMIT 5
  
13:22:59.863806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:22:59.922222 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_132259_00150_d8x8s
13:22:59.923387 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_132259_00150_d8x8s)
13:22:59.924711 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:22:59.925546 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:22:59.934599 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_132259_00150_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:22:59.938287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdfb0212-b357-42ad-b063-ca3ab64d2589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8635d9710>]}
13:22:59.939662 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.11s]
13:22:59.940671 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:22:59.941546 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_132259_00150_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:22:59.944276 [debug] [MainThread]: On master: COMMIT
13:22:59.945044 [debug] [MainThread]: Connection 'master' was properly closed.
13:22:59.945459 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:22:59.945940 [info ] [MainThread]: 
13:22:59.946417 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
13:22:59.947326 [debug] [MainThread]: Command end result
13:22:59.976905 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:22:59.981581 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:22:59.988198 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:22:59.988726 [info ] [MainThread]: 
13:22:59.989300 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:22:59.989813 [info ] [MainThread]: 
13:22:59.990355 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_132259_00150_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:22:59.990808 [info ] [MainThread]: 
13:22:59.991260 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:22:59.992495 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5991118, "process_in_blocks": "0", "process_kernel_time": 0.305531, "process_mem_max_rss": "110488", "process_out_blocks": "3000", "process_user_time": 3.832128}
13:22:59.993245 [debug] [MainThread]: Command `dbt run` failed at 13:22:59.993115 after 2.60 seconds
13:22:59.993833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8686da490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8686da450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86290e690>]}
13:22:59.994382 [debug] [MainThread]: Flushing usage events
13:23:00.030230 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:25:50.096223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c325b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c3774110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c325ab50>]}


============================== 13:25:50.100263 | 91cc6570-6a77-4fb5-aa81-ef68b12300c9 ==============================
13:25:50.100263 [info ] [MainThread]: Running with dbt=1.9.1
13:25:50.101025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jovyan/Internal/logs', 'profiles_dir': '/home/jovyan/Internal', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s college_leads', 'send_anonymous_usage_stats': 'True'}
13:25:50.294883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91cc6570-6a77-4fb5-aa81-ef68b12300c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c325eed0>]}
13:25:50.362653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91cc6570-6a77-4fb5-aa81-ef68b12300c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c573d190>]}
13:25:50.363789 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:25:50.443400 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:25:50.573192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:25:50.574459 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
13:25:50.902156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91cc6570-6a77-4fb5-aa81-ef68b12300c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c2d59e10>]}
13:25:51.012112 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:25:51.016110 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:25:51.026796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91cc6570-6a77-4fb5-aa81-ef68b12300c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c2d988d0>]}
13:25:51.027575 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:25:51.028150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91cc6570-6a77-4fb5-aa81-ef68b12300c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c3659590>]}
13:25:51.030178 [info ] [MainThread]: 
13:25:51.030701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:25:51.031154 [info ] [MainThread]: 
13:25:51.031908 [debug] [MainThread]: Acquiring new trino connection 'master'
13:25:51.033242 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:25:51.081269 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:25:51.081992 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:25:51.082643 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:25:51.083165 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:25:51.083886 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '91cc6570-6a77-4fb5-aa81-ef68b12300c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c14392d0>]}
13:25:51.124420 [debug] [ThreadPool]: SQL status: SUCCESS in 0.042 seconds
13:25:51.126392 [debug] [ThreadPool]: On list_iceberg: Close
13:25:51.133746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:25:51.152668 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:25:51.153406 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:25:51.153936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:25:51.237724 [debug] [ThreadPool]: SQL status: SUCCESS in 0.084 seconds
13:25:51.239803 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:25:51.240342 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:25:51.241568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91cc6570-6a77-4fb5-aa81-ef68b12300c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c30224d0>]}
13:25:51.242445 [debug] [MainThread]: On master: COMMIT
13:25:51.244808 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:25:51.245591 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:25:51.246341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:25:51.246923 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:25:51.250042 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:25:51.250893 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:25:51.276895 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:25:51.279215 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:25:51.279895 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    SELECT 
    "airbyte_raw_studentdetail"."STUDENTID", 
    "airbyte_raw_studentmain"."FIRSTNAME", 
    "airbyte_raw_studentmain"."LASTNAME"
FROM 
    default."airbyte_raw_studentdetail"
LEFT JOIN 
    default."airbyte_raw_studentmain" 
    ON "airbyte_raw_studentdetail"."STUDENTID" = "airbyte_raw_studentmain"."STUDENTID"
LIMIT 5
13:25:51.280482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:25:51.331487 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_132551_00153_d8x8s
13:25:51.332277 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_132551_00153_d8x8s)
13:25:51.333091 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:25:51.333645 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:25:51.338939 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_132551_00153_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:25:51.341363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91cc6570-6a77-4fb5-aa81-ef68b12300c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c2ff7cd0>]}
13:25:51.342378 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.09s]
13:25:51.343183 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:25:51.344016 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_132551_00153_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:25:51.346527 [debug] [MainThread]: On master: COMMIT
13:25:51.347202 [debug] [MainThread]: Connection 'master' was properly closed.
13:25:51.347655 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:25:51.348177 [info ] [MainThread]: 
13:25:51.348752 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
13:25:51.349595 [debug] [MainThread]: Command end result
13:25:51.379647 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:25:51.381936 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:25:51.388820 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:25:51.389370 [info ] [MainThread]: 
13:25:51.389966 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:25:51.390435 [info ] [MainThread]: 
13:25:51.391003 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_132551_00153_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:25:51.391427 [info ] [MainThread]: 
13:25:51.391918 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:25:51.393139 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3574314, "process_in_blocks": "0", "process_kernel_time": 0.2854, "process_mem_max_rss": "109500", "process_out_blocks": "3024", "process_user_time": 2.615508}
13:25:51.393862 [debug] [MainThread]: Command `dbt run` failed at 13:25:51.393732 after 1.36 seconds
13:25:51.394428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c30e7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c3f5f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c328e350>]}
13:25:51.394965 [debug] [MainThread]: Flushing usage events
13:25:51.492942 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:30:08.859088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0e974cecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0e974cff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0e974cea50>]}


============================== 13:30:08.863154 | f332c61f-e1cc-4e38-94c5-d7071797c041 ==============================
13:30:08.863154 [info ] [MainThread]: Running with dbt=1.9.1
13:30:08.863936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jovyan/Internal/logs', 'version_check': 'True', 'profiles_dir': '/home/jovyan/Internal', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s college_leads', 'send_anonymous_usage_stats': 'True'}
13:30:09.057675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f332c61f-e1cc-4e38-94c5-d7071797c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0e97296050>]}
13:30:09.127778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f332c61f-e1cc-4e38-94c5-d7071797c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0e998f5390>]}
13:30:09.128915 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:30:09.225455 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:30:09.357525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:30:09.358561 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
13:30:09.678568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f332c61f-e1cc-4e38-94c5-d7071797c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0e97169290>]}
13:30:09.773463 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:30:09.777555 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:30:09.788661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f332c61f-e1cc-4e38-94c5-d7071797c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0e97111c50>]}
13:30:09.789471 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:30:09.790009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f332c61f-e1cc-4e38-94c5-d7071797c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0e99059a90>]}
13:30:09.791952 [info ] [MainThread]: 
13:30:09.792464 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:30:09.792891 [info ] [MainThread]: 
13:30:09.793552 [debug] [MainThread]: Acquiring new trino connection 'master'
13:30:09.794913 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:30:09.844980 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:30:09.845893 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:30:09.846361 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:30:09.846808 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:30:09.847472 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'f332c61f-e1cc-4e38-94c5-d7071797c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0e96c94b90>]}
13:30:09.897957 [debug] [ThreadPool]: SQL status: SUCCESS in 0.051 seconds
13:30:09.900211 [debug] [ThreadPool]: On list_iceberg: Close
13:30:09.907770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:30:09.927020 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:30:09.927736 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:30:09.928268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:30:10.045484 [debug] [ThreadPool]: SQL status: SUCCESS in 0.117 seconds
13:30:10.047514 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:30:10.048109 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:30:10.049311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f332c61f-e1cc-4e38-94c5-d7071797c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0e97183890>]}
13:30:10.050321 [debug] [MainThread]: On master: COMMIT
13:30:10.052682 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:30:10.053500 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:30:10.054237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:30:10.054809 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:30:10.057837 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:30:10.058689 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:30:10.083463 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:30:10.086447 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:30:10.087161 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    SELECT 
    "airbyte_raw_studentdetail"."STUDENTID", 
    "airbyte_raw_studentmain"."FIRSTNAME", 
    "airbyte_raw_studentmain"."LASTNAME"
FROM 
    default."airbyte_raw_studentdetail"
LEFT JOIN 
    default."airbyte_raw_studentmain" 
    ON "airbyte_raw_studentdetail"."STUDENTID" = "airbyte_raw_studentmain"."STUDENTID"
LIMIT 5
  
13:30:10.087690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:30:10.185954 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_133010_00156_d8x8s
13:30:10.186706 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_133010_00156_d8x8s)
13:30:10.187483 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:30:10.188006 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:30:10.193176 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_133010_00156_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:30:10.195653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f332c61f-e1cc-4e38-94c5-d7071797c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0e96cbe010>]}
13:30:10.196786 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.14s]
13:30:10.197559 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:30:10.198415 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_133010_00156_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:30:10.201091 [debug] [MainThread]: On master: COMMIT
13:30:10.201774 [debug] [MainThread]: Connection 'master' was properly closed.
13:30:10.202208 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:30:10.202692 [info ] [MainThread]: 
13:30:10.203172 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
13:30:10.204085 [debug] [MainThread]: Command end result
13:30:10.232756 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:30:10.235116 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:30:10.242381 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:30:10.242997 [info ] [MainThread]: 
13:30:10.243769 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:30:10.244550 [info ] [MainThread]: 
13:30:10.245376 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_133010_00156_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:30:10.245851 [info ] [MainThread]: 
13:30:10.246323 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:30:10.247772 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4492626, "process_in_blocks": "0", "process_kernel_time": 0.348272, "process_mem_max_rss": "109220", "process_out_blocks": "3024", "process_user_time": 2.533704}
13:30:10.248590 [debug] [MainThread]: Command `dbt run` failed at 13:30:10.248457 after 1.45 seconds
13:30:10.249247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0e97502d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0e978cd950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0e9b27a5d0>]}
13:30:10.249822 [debug] [MainThread]: Flushing usage events
13:30:10.318124 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:50:12.373999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c87a6536d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c87aa51b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c87a656f50>]}


============================== 13:50:12.378230 | 89084936-ebf5-4587-94ee-6aafcd08438d ==============================
13:50:12.378230 [info ] [MainThread]: Running with dbt=1.9.1
13:50:12.379044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/jovyan/Internal/logs', 'debug': 'False', 'profiles_dir': '/home/jovyan/Internal', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s college_leads', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
13:50:12.582492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89084936-ebf5-4587-94ee-6aafcd08438d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c87a30f350>]}
13:50:12.655302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89084936-ebf5-4587-94ee-6aafcd08438d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c87cb090d0>]}
13:50:12.656481 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:50:12.743112 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:50:12.879104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:50:12.880170 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
13:50:13.206815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89084936-ebf5-4587-94ee-6aafcd08438d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c87a2b5910>]}
13:50:13.309985 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:50:13.314195 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:50:13.325825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89084936-ebf5-4587-94ee-6aafcd08438d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c87a0a0390>]}
13:50:13.326793 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:50:13.327469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89084936-ebf5-4587-94ee-6aafcd08438d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c87a0878d0>]}
13:50:13.329745 [info ] [MainThread]: 
13:50:13.330285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:50:13.330759 [info ] [MainThread]: 
13:50:13.331523 [debug] [MainThread]: Acquiring new trino connection 'master'
13:50:13.332953 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:50:13.383997 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:50:13.384682 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:50:13.385154 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:50:13.385595 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:50:13.386281 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '89084936-ebf5-4587-94ee-6aafcd08438d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c879ecf3d0>]}
13:50:13.433882 [debug] [ThreadPool]: SQL status: SUCCESS in 0.049 seconds
13:50:13.435853 [debug] [ThreadPool]: On list_iceberg: Close
13:50:13.442342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:50:13.461610 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:50:13.462351 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:50:13.462910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:50:13.535748 [debug] [ThreadPool]: SQL status: SUCCESS in 0.073 seconds
13:50:13.537704 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:50:13.538353 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:50:13.539581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89084936-ebf5-4587-94ee-6aafcd08438d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c87a35d8d0>]}
13:50:13.540405 [debug] [MainThread]: On master: COMMIT
13:50:13.543184 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:50:13.543981 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:50:13.544676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:50:13.545196 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:50:13.548269 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:50:13.549097 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:50:13.572914 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:50:13.575225 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:50:13.575891 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    SELECT 
    "airbyte_raw_studentdetail"."STUDENTID", 
    "airbyte_raw_studentmain"."FIRSTNAME", 
    "airbyte_raw_studentmain"."LASTNAME"
FROM 
    iceberg.default."airbyte_raw_studentdetail"
LEFT JOIN 
    iceberg.default."airbyte_raw_studentmain" 
    ON "airbyte_raw_studentdetail"."STUDENTID" = "airbyte_raw_studentmain"."STUDENTID"
LIMIT 5
  
13:50:13.576454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:50:13.627072 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_135013_00159_d8x8s
13:50:13.628209 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_135013_00159_d8x8s)
13:50:13.629112 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:50:13.629655 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:50:13.635515 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_135013_00159_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:50:13.637909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89084936-ebf5-4587-94ee-6aafcd08438d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c878b36210>]}
13:50:13.638820 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.09s]
13:50:13.639570 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:50:13.640370 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_135013_00159_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:50:13.642786 [debug] [MainThread]: On master: COMMIT
13:50:13.643432 [debug] [MainThread]: Connection 'master' was properly closed.
13:50:13.644017 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:50:13.644506 [info ] [MainThread]: 
13:50:13.645122 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
13:50:13.646042 [debug] [MainThread]: Command end result
13:50:13.677175 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:50:13.679586 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:50:13.686902 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:50:13.687466 [info ] [MainThread]: 
13:50:13.688227 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:50:13.688758 [info ] [MainThread]: 
13:50:13.689331 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_135013_00159_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:50:13.689877 [info ] [MainThread]: 
13:50:13.690390 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:50:13.691656 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3825059, "process_in_blocks": "360", "process_kernel_time": 0.287745, "process_mem_max_rss": "109428", "process_out_blocks": "3024", "process_user_time": 2.674637}
13:50:13.692493 [debug] [MainThread]: Command `dbt run` failed at 13:50:13.692341 after 1.38 seconds
13:50:13.693117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c87a4a7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c87a761790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c87e5f1910>]}
13:50:13.693699 [debug] [MainThread]: Flushing usage events
13:50:13.749163 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:51:28.963146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75792698f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75792698ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75792698eb10>]}


============================== 13:51:28.967370 | 2b82d8f2-b1c9-4615-9a35-0ed6c266bc72 ==============================
13:51:28.967370 [info ] [MainThread]: Running with dbt=1.9.1
13:51:28.968205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/jovyan/Internal/logs', 'profiles_dir': '/home/jovyan/Internal', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
13:51:29.095286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b82d8f2-b1c9-4615-9a35-0ed6c266bc72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7579267e9010>]}
13:51:29.107875 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20827815, "process_in_blocks": "0", "process_kernel_time": 0.235472, "process_mem_max_rss": "91620", "process_out_blocks": "16", "process_user_time": 1.653295}
13:51:29.108591 [debug] [MainThread]: Command `dbt clean` succeeded at 13:51:29.108462 after 0.21 seconds
13:51:29.109151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7579267ea2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7579267ebf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75792a627e90>]}
13:51:29.109739 [debug] [MainThread]: Flushing usage events
13:51:29.240185 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:51:34.257256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c360c7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c364c5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c360c79d0>]}


============================== 13:51:34.261251 | d215c1c6-2803-4503-a1b2-673972453e0e ==============================
13:51:34.261251 [info ] [MainThread]: Running with dbt=1.9.1
13:51:34.262020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/jovyan/Internal/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s college_leads', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
13:51:34.452493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd215c1c6-2803-4503-a1b2-673972453e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c35f32690>]}
13:51:34.523476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd215c1c6-2803-4503-a1b2-673972453e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c3850ce90>]}
13:51:34.524944 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:51:34.622111 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:51:34.623037 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
13:51:34.623642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd215c1c6-2803-4503-a1b2-673972453e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c361262d0>]}
13:51:36.134992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd215c1c6-2803-4503-a1b2-673972453e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c3578fa10>]}
13:51:36.235384 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:51:36.239266 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:51:36.250393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd215c1c6-2803-4503-a1b2-673972453e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c35774bd0>]}
13:51:36.251151 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:51:36.251687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd215c1c6-2803-4503-a1b2-673972453e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c353801d0>]}
13:51:36.253639 [info ] [MainThread]: 
13:51:36.254137 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:51:36.254554 [info ] [MainThread]: 
13:51:36.255230 [debug] [MainThread]: Acquiring new trino connection 'master'
13:51:36.256454 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:51:36.310066 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:51:36.310754 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:51:36.311239 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:51:36.311657 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:51:36.312304 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'd215c1c6-2803-4503-a1b2-673972453e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c35f1ecd0>]}
13:51:36.350824 [debug] [ThreadPool]: SQL status: SUCCESS in 0.039 seconds
13:51:36.352734 [debug] [ThreadPool]: On list_iceberg: Close
13:51:36.359331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:51:36.377322 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:51:36.378003 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:51:36.378474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:51:36.447454 [debug] [ThreadPool]: SQL status: SUCCESS in 0.069 seconds
13:51:36.450523 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:51:36.451410 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:51:36.453015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd215c1c6-2803-4503-a1b2-673972453e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c35356e90>]}
13:51:36.454023 [debug] [MainThread]: On master: COMMIT
13:51:36.456726 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:51:36.457496 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:51:36.458240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:51:36.458780 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:51:36.461845 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:51:36.462846 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:51:36.488084 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:51:36.490148 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:51:36.490747 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    SELECT 
    "airbyte_raw_studentdetail"."STUDENTID", 
    "airbyte_raw_studentmain"."FIRSTNAME", 
    "airbyte_raw_studentmain"."LASTNAME"
FROM 
    default."airbyte_raw_studentdetail"
LEFT JOIN 
    default."airbyte_raw_studentmain" 
    ON "airbyte_raw_studentdetail"."STUDENTID" = "airbyte_raw_studentmain"."STUDENTID"
LIMIT 5
  
13:51:36.491243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:51:36.542417 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_135136_00162_d8x8s
13:51:36.543184 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_135136_00162_d8x8s)
13:51:36.543998 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:51:36.544506 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:51:36.550041 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_135136_00162_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:51:36.552437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd215c1c6-2803-4503-a1b2-673972453e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c357115d0>]}
13:51:36.553476 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.09s]
13:51:36.554406 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:51:36.555260 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_135136_00162_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:51:36.557824 [debug] [MainThread]: On master: COMMIT
13:51:36.558462 [debug] [MainThread]: Connection 'master' was properly closed.
13:51:36.558929 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:51:36.559403 [info ] [MainThread]: 
13:51:36.559925 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
13:51:36.560847 [debug] [MainThread]: Command end result
13:51:36.592227 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:51:36.597218 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:51:36.604233 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:51:36.604835 [info ] [MainThread]: 
13:51:36.605426 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:51:36.605931 [info ] [MainThread]: 
13:51:36.606462 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'airbyte_raw_studentdetail.studentid' cannot be resolved", query_id=20241217_135136_00162_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:51:36.606945 [info ] [MainThread]: 
13:51:36.607420 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:51:36.608642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4112515, "process_in_blocks": "0", "process_kernel_time": 0.306697, "process_mem_max_rss": "110040", "process_out_blocks": "3000", "process_user_time": 3.589456}
13:51:36.609398 [debug] [MainThread]: Command `dbt run` failed at 13:51:36.609269 after 2.41 seconds
13:51:36.610016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c36126dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c357ba550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c39e4a510>]}
13:51:36.610547 [debug] [MainThread]: Flushing usage events
13:51:36.651013 [debug] [MainThread]: An error was encountered while trying to flush usage events
13:52:58.763501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc283af510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc283af250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc283af090>]}


============================== 13:52:58.767536 | a2b66ed5-a66d-40e7-b4ce-4d9631beffdc ==============================
13:52:58.767536 [info ] [MainThread]: Running with dbt=1.9.1
13:52:58.768305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/jovyan/Internal', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/jovyan/Internal/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s college_leads', 'send_anonymous_usage_stats': 'True'}
13:52:58.957556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2b66ed5-a66d-40e7-b4ce-4d9631beffdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc28013050>]}
13:52:59.024943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2b66ed5-a66d-40e7-b4ce-4d9631beffdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc2a844f50>]}
13:52:59.026044 [info ] [MainThread]: Registered adapter: trino=1.8.5
13:52:59.108921 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
13:52:59.254004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:52:59.255081 [debug] [MainThread]: Partial parsing: updated file: Internal://models/example/college_leads.sql
13:52:59.576844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2b66ed5-a66d-40e7-b4ce-4d9631beffdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc27ff13d0>]}
13:52:59.675737 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:52:59.680164 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:52:59.691825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2b66ed5-a66d-40e7-b4ce-4d9631beffdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc27fcc6d0>]}
13:52:59.692958 [info ] [MainThread]: Found 3 models, 4 data tests, 32 sources, 449 macros
13:52:59.693748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2b66ed5-a66d-40e7-b4ce-4d9631beffdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc283bb710>]}
13:52:59.695818 [info ] [MainThread]: 
13:52:59.696314 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:52:59.696759 [info ] [MainThread]: 
13:52:59.697445 [debug] [MainThread]: Acquiring new trino connection 'master'
13:52:59.698765 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
13:52:59.746417 [debug] [ThreadPool]: Using trino connection "list_iceberg"
13:52:59.747155 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
13:52:59.747665 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:52:59.748063 [warn ] [ThreadPool]: [WARNING]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
13:52:59.748712 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'a2b66ed5-a66d-40e7-b4ce-4d9631beffdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc2686dc10>]}
13:52:59.786362 [debug] [ThreadPool]: SQL status: SUCCESS in 0.039 seconds
13:52:59.788340 [debug] [ThreadPool]: On list_iceberg: Close
13:52:59.794790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default_silver)
13:52:59.812269 [debug] [ThreadPool]: Using trino connection "list_iceberg_default_silver"
13:52:59.812870 [debug] [ThreadPool]: On list_iceberg_default_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "connection_name": "list_iceberg_default_silver"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default_silver') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default_silver'
13:52:59.813326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:52:59.885651 [debug] [ThreadPool]: SQL status: SUCCESS in 0.072 seconds
13:52:59.887728 [debug] [ThreadPool]: On list_iceberg_default_silver: ROLLBACK
13:52:59.888337 [debug] [ThreadPool]: On list_iceberg_default_silver: Close
13:52:59.889599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2b66ed5-a66d-40e7-b4ce-4d9631beffdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc28069cd0>]}
13:52:59.890479 [debug] [MainThread]: On master: COMMIT
13:52:59.893215 [debug] [Thread-1 (]: Began running node model.Internal.college_leads
13:52:59.894061 [info ] [Thread-1 (]: 1 of 1 START sql view model default_silver.college_leads ....................... [RUN]
13:52:59.894905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_default_silver, now model.Internal.college_leads)
13:52:59.895563 [debug] [Thread-1 (]: Began compiling node model.Internal.college_leads
13:52:59.898840 [debug] [Thread-1 (]: Writing injected SQL for node "model.Internal.college_leads"
13:52:59.899746 [debug] [Thread-1 (]: Began executing node model.Internal.college_leads
13:52:59.924850 [debug] [Thread-1 (]: Writing runtime sql for node "model.Internal.college_leads"
13:52:59.927211 [debug] [Thread-1 (]: Using trino connection "model.Internal.college_leads"
13:52:59.927911 [debug] [Thread-1 (]: On model.Internal.college_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "Internal", "target_name": "dev", "node_id": "model.Internal.college_leads"} */

  create or replace view
    "iceberg"."default_silver"."college_leads"
  security definer
  as
    SELECT 
    s.STUDENTID, 
    sm.FIRSTNAME, 
    sm.LASTNAME
FROM 
    default.airbyte_raw_studentdetail 
LEFT JOIN 
    default.airbyte_raw_studentmain 
    ON STUDENTID = STUDENTID 
LIMIT 5
  
13:52:59.928467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
13:52:59.976243 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20241217_135259_00165_d8x8s
13:52:59.977034 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'studentid' cannot be resolved", query_id=20241217_135259_00165_d8x8s)
13:52:59.977811 [debug] [Thread-1 (]: On model.Internal.college_leads: ROLLBACK
13:52:59.978297 [debug] [Thread-1 (]: On model.Internal.college_leads: Close
13:52:59.983360 [debug] [Thread-1 (]: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'studentid' cannot be resolved", query_id=20241217_135259_00165_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:52:59.985682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b66ed5-a66d-40e7-b4ce-4d9631beffdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc26900610>]}
13:52:59.986583 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model default_silver.college_leads .............. [ERROR in 0.09s]
13:52:59.987372 [debug] [Thread-1 (]: Finished running node model.Internal.college_leads
13:52:59.988176 [debug] [Thread-4 (]: Marking all children of 'model.Internal.college_leads' to be skipped because of status 'error'.  Reason: Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'studentid' cannot be resolved", query_id=20241217_135259_00165_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql.
13:52:59.990508 [debug] [MainThread]: On master: COMMIT
13:52:59.991176 [debug] [MainThread]: Connection 'master' was properly closed.
13:52:59.991591 [debug] [MainThread]: Connection 'model.Internal.college_leads' was properly closed.
13:52:59.992074 [info ] [MainThread]: 
13:52:59.992792 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
13:52:59.993794 [debug] [MainThread]: Command end result
13:53:00.021410 [debug] [MainThread]: Wrote artifact WritableManifest to /home/jovyan/Internal/target/manifest.json
13:53:00.023912 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/jovyan/Internal/target/semantic_manifest.json
13:53:00.030787 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/jovyan/Internal/target/run_results.json
13:53:00.031300 [info ] [MainThread]: 
13:53:00.031962 [info ] [MainThread]: Completed with 1 error, 0 partial successes, and 0 warnings:
13:53:00.032501 [info ] [MainThread]: 
13:53:00.033130 [error] [MainThread]:   Database Error in model college_leads (models/example/college_leads.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 15:8: Column 'studentid' cannot be resolved", query_id=20241217_135259_00165_d8x8s)
  compiled code at target/run/Internal/models/example/college_leads.sql
13:53:00.033646 [info ] [MainThread]: 
13:53:00.034185 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:53:00.035407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3311267, "process_in_blocks": "0", "process_kernel_time": 0.288601, "process_mem_max_rss": "109568", "process_out_blocks": "3024", "process_user_time": 2.484567}
13:53:00.036150 [debug] [MainThread]: Command `dbt run` failed at 13:53:00.036018 after 1.33 seconds
13:53:00.036724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc2823bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc2908f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc2c32d8d0>]}
13:53:00.037251 [debug] [MainThread]: Flushing usage events
13:53:00.129364 [debug] [MainThread]: An error was encountered while trying to flush usage events

